import"./assets/bootstrap-7pRM7VCB.js";import"./assets/theme-switcher-DdK6h2Sc.js";document.addEventListener("DOMContentLoaded",async()=>{(()=>{const e=document.getElementById("phpmyfaq-update-next-step-button"),t=document.getElementById("phpmyfaq-update-next-step");e&&t&&e.addEventListener("click",e=>{e.preventDefault(),window.location.replace(`?step=${t.value}`)})})(),await(async()=>{if(window.location.href.endsWith("/update/")||window.location.href.endsWith("/update/index.php")){const t=document.getElementById("phpmyfaq-update-installed-version");if(!t)return;try{const e=await fetch("../api/setup/check",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:t.value});if(!e.ok){const t=await e.json();throw new Error(t.message)}const n=document.getElementById("phpmyfaq-update-next-step-button"),a=document.getElementById("phpmyfaq-update-check-success");a&&n&&(a.classList.remove("d-none"),n.classList.remove("disabled"),n.disabled=!1)}catch(e){let t;t=e instanceof SyntaxError?"The requested resource was not found on the server. Please check your server configuration, if you use Apache, the RewriteBase in your .htaccess configuration. If you use nginx, please check your nginx rewrite configuration.":e.message;const n=document.getElementById("phpmyfaq-update-check-alert"),a=document.getElementById("phpmyfaq-update-check-result");n&&a&&(n.classList.remove("d-none"),a.innerText=t)}}})(),await(async()=>{if(window.location.href.endsWith("/update/?step=2")||window.location.href.endsWith("/update/index.php?step=2")){const t=document.getElementById("phpmyfaq-update-installed-version");if(!t)return;try{const e=await fetch("../api/setup/backup",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:t.value});if(!e.ok)throw new Error("Network response was not ok");const n=await e.json(),a=document.getElementById("phpmyfaq-update-backup-download-link");a&&(a.href=n.backupFile)}catch(e){const t=e.cause&&e.cause.response?await e.cause.response.json():{error:"Unknown error"};console.error(t.error)}}})(),await(async()=>{if(window.location.href.endsWith("/update/?step=3")||window.location.href.endsWith("/update/index.php?step=3")){const t=document.getElementById("phpmyfaq-update-installed-version");if(!t)return;try{const e=await fetch("../api/setup/update-database",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:t.value}),n=await e.json(),a=document.getElementById("result-update");if(e.ok){a&&(a.style.width="100%",a.innerText="100%",a.classList.remove("progress-bar-animated"));const e=document.getElementById("phpmyfaq-update-database-success");e&&(e.classList.remove("d-none"),e.innerText=n.success)}else{a&&(a.style.width="100%",a.innerText="100%",a.classList.remove("progress-bar-animated"));const e=document.getElementById("phpmyfaq-update-database-error"),t=document.getElementById("error-messages");e&&t&&(e.classList.remove("d-none"),t.innerHTML=n.error)}}catch(e){console.error("Error details:",e);const t=document.getElementById("phpmyfaq-update-database-error");t&&(t.classList.remove("d-none"),t.innerText=`Error: ${e.message}`)}}})()});
//# sourceMappingURL=update.js.map
