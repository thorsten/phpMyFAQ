import{M as e,T as t,p as n,a as o,H as a,b as i}from"./assets/autocomplete.es-BppD_uOu.js";import{C as r,r as s}from"./assets/chart-uGFcfnRt.js";import{a as l,s as c,c as d,h as u,b as h}from"./assets/password-DLlehxvG.js";import{T as p,M as m,a as g}from"./assets/bootstrap-7pRM7VCB.js";import"./assets/theme-switcher-DdK6h2Sc.js";import{m as f,C as y,D as v,p as b,I as w,P as E,i as S,t as _,a as k,b as I,c as j,s as C,d as L,e as T,w as x,h as B,L as A,f as M,g as O,j as q,T as D,k as N,l as P,n as z,o as R,q as F,r as H,M as W,u as V,v as $,x as Y,S as U,$ as G,y as J,z as X,U as Z,A as K,B as Q,E as ee,F as te,G as ne,H as oe,J as ae,K as ie,N as re,O as se,Q as le,R as ce,V as de,W as ue,X as he,Y as pe,Z as me,_ as ge,a0 as fe,a1 as ye,a2 as ve,a3 as be,a4 as we,a5 as Ee,a6 as Se,a7 as _e,a8 as ke,a9 as Ie,aa as je,ab as Ce,ac as Le,ad as Te,ae as xe,af as Be,ag as Ae,ah as Me,ai as Oe,aj as qe,ak as De,al as Ne,am as Pe,an as ze,ao as Re,ap as Fe,aq as He,ar as We,as as Ve,at as $e,au as Ye,av as Ue,aw as Ge,ax as Je,ay as Xe,az as Ze,aA as Ke,aB as Qe,aC as et,aD as tt,aE as nt,aF as ot}from"./assets/jodit-DGZoSfR1.js";const at=async(e,t)=>{try{const n=await fetch("./api/content/attachments",{method:"DELETE",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({attId:e,csrf:t})});return await n.json()}catch(n){throw n}},it=async(e,t,n)=>{try{const o=await fetch("./api/category/update-order",{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({categoryTree:e,categoryId:t,csrfToken:n}),redirect:"follow",referrerPolicy:"no-referrer"});return await o.json()}catch(o){throw o}},rt=async e=>{try{const t=await fetch(`./api/configuration/seo-metatags/${e}`);return t.ok?await t.text():""}catch(t){throw t}},st=async(e,t)=>{try{const n=await fetch("./api/faq/search",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({search:e,csrf:t})});if(200===n.status)return await n.json();throw new Error("Network response was not ok.")}catch(n){throw n}},lt=async(e="",t={})=>{try{const n=await fetch(e,{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(t)});return await n.json()}catch(n){throw n}},ct=async(e,t)=>{try{const n=await fetch("./api/user/delete",{method:"DELETE",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({csrfToken:t,userId:e})});return await n.json()}catch(n){throw n}},dt={dev:0,alpha:1,a:1,beta:2,b:2,rc:3,"#":4,pl:5,p:5},ut=e=>{const t={parts:[],special:null,specialNumber:0};let n=(e=e.trim().toLowerCase()).match(/(dev|alpha|a|beta|b|rc|pl|p)(\d*)/);n&&(t.special=n[1],t.specialNumber=n[2]?parseInt(n[2],10):0,e=e.substring(0,n.index));const o=(e=e.replace(/[^0-9.]/g,".")).split(".");for(const a of o){if(""===a)continue;const e=parseInt(a,10);isNaN(e)||t.parts.push(e)}return t};function ht(e,t,n){const o=((e,t)=>{const n=Math.max(e.parts.length,t.parts.length);for(let i=0;i<n;i++){const n=e.parts[i]||0,o=t.parts[i]||0;if(n<o)return-1;if(n>o)return 1}const o=e.special?dt[e.special]:4,a=t.special?dt[t.special]:4;return o<a?-1:o>a?1:e.specialNumber<t.specialNumber?-1:e.specialNumber>t.specialNumber?1:0})(ut(e),ut(t));switch(n){case"<":case"lt":return o<0;case"<=":case"le":return o<=0;case">":case"gt":return o>0;case">=":case"ge":return o>=0;case"==":case"=":case"eq":return 0===o;case"!=":case"<>":case"ne":return 0!==o;default:throw new Error(`Invalid operator: ${n}`)}}const pt=()=>{const e=getComputedStyle(document.documentElement),t=(e.getPropertyValue("--bs-primary")||"#0d6efd").trim(),n=(e.getPropertyValue("--bs-body-color")||"#212529").trim(),o=(e.getPropertyValue("--bs-body-color-rgb")||"33, 37, 41").trim(),a=e.getPropertyValue("--bs-border-color").trim();return{primary:t,bodyColor:n,gridColor:""!==a?a:`rgba(${o}, 0.4)`,tooltipBg:(e.getPropertyValue("--bs-tertiary-bg")||`rgba(${o}, 0.85)`).trim()}},mt=async()=>{const e=document.getElementById("verificationModal"),n=new t;e&&e.addEventListener("show.bs.modal",async()=>{const t=document.getElementById("pmf-verification-spinner"),o=e.getAttribute("data-pmf-current-version"),a=document.getElementById("pmf-verification-updates"),i=document.documentElement.lang;if(await n.loadTranslations(i),t&&a&&o){t.classList.remove("d-none"),a.innerText=n.translate("msgFetchingHashes");const e=await(async e=>{try{const t=await fetch(`https://api.phpmyfaq.de/verify/${e}`,{method:"GET",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}});return await t.json()}catch(t){throw t}})(o);a.innerText=n.translate("msgCheckHashes");const i=await(async e=>{try{const t=await fetch("./api/dashboard/verify",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify(e)});return await t.json()}catch(t){throw t}})(e);"object"!=typeof i&&console.error("Invalid JSON data provided.");const r=document.createElement("ul");for(const[t,o]of Object.entries(i)){const e=document.createElement("li");e.textContent=`${n.translate("msgAttachmentsFilename")}: ${t}, Hash: ${o}`,r.appendChild(e)}a.appendChild(r),t.classList.add("d-none")}})};window.onload=()=>{const t=document.querySelector(".masonry-grid");t&&new e(t,{percentPosition:!0})};const gt=()=>{const e=document.getElementById("pmf-delete-admin-log");e&&e.addEventListener("click",async e=>{e.preventDefault();const t=e.target.getAttribute("data-pmf-csrf"),a=await(async e=>{try{const t=await fetch("./api/statistics/admin-log",{method:"DELETE",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({csrfToken:e}),redirect:"follow",referrerPolicy:"no-referrer"});return await t.json()}catch(t){throw t}})(t);a.success?n(a.success):o(a.error)})},ft=()=>{const e=document.getElementById("pmf-admin-clear-ratings");e&&e.addEventListener("click",async e=>{e.preventDefault();const t=e.target.getAttribute("data-pmf-csrf"),a=await(async e=>{try{const t=await fetch("./api/statistics/ratings/clear",{method:"DELETE",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({csrfToken:e}),redirect:"follow",referrerPolicy:"no-referrer"});return await t.json()}catch(t){throw t}})(t);a.success?n(a.success):o(a.error)})},yt=()=>{const e=document.getElementById("pmf-admin-create-report");e&&e.addEventListener("click",async e=>{e.preventDefault();const t=document.getElementById("pmf-admin-report-form"),n=new FormData(t),a=c(n),i=await(async(e,t)=>{try{const n=await fetch("./api/export/report",{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:e,csrfToken:t}),redirect:"follow",referrerPolicy:"no-referrer"});return n.ok?await n.blob():await n.json()}catch(n){console.error(n)}})(a);if("error"in i)o(i.error);else{const e=window.URL.createObjectURL(i),t=document.createElement("a");t.href=e,t.download="phpmyfaq-report-"+(new Date).toISOString().substring(0,10)+".csv",document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(e)}})},vt=()=>{const e=document.getElementById("pmf-button-truncate-search-terms");e&&e.addEventListener("click",async e=>{e.preventDefault();const t=e.target.getAttribute("data-pmf-csrf-token");if(confirm("Are you sure?")){const e=await(async e=>{try{const t=await fetch("./api/statistics/search-terms",{method:"DELETE",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({csrfToken:e}),redirect:"follow",referrerPolicy:"no-referrer"});return await t.json()}catch(t){throw t}})(t);if(e.success){document.getElementById("pmf-table-search-terms").remove(),n(e.success)}else o(e.error)}})},bt=()=>{const e=document.getElementById("pmf-admin-clear-visits");e&&e.addEventListener("click",async e=>{e.preventDefault();const t=e.target.getAttribute("data-pmf-csrf"),a=await(async e=>{try{const t=await fetch("./api/statistics/visits/clear",{method:"DELETE",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({csrfToken:e}),redirect:"follow",referrerPolicy:"no-referrer"});return await t.json()}catch(t){throw t}})(t);a.success?n(a.success):o(a.error)})},wt=()=>{const e=document.getElementById("pmf-admin-delete-sessions");e&&e.addEventListener("click",async e=>{e.preventDefault();const t=document.getElementById("pmf-csrf-token").value,a=document.getElementById("month").value,i=await(async(e,t)=>{try{const n=await fetch("./api/statistics/sessions",{method:"DELETE",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({csrfToken:e,month:t}),redirect:"follow",referrerPolicy:"no-referrer"});return await n.json()}catch(n){throw n}})(t,a);i.success?n(i.success):o(i.error)})},Et=async()=>{const e=document.getElementById("save-configuration");e&&e.addEventListener("click",async e=>{e.preventDefault();const t=document.getElementById("configuration-list"),a=new FormData(t),i=[];t.querySelectorAll("input, select, textarea").forEach(e=>{const t=e.name;if(t&&t.startsWith("edit[")){const e=t.match(/edit\[([^\]]+)\]/);e&&i.push(e[1])}}),a.append("availableFields",JSON.stringify(i));const r=await(async e=>{try{const t=await fetch("api/configuration",{method:"POST",body:e});return await t.json()}catch(t){throw t}})(a);"string"==typeof r.success?n(r.success):o(r.error)})},St=async()=>{const e=document.getElementsByName("edit[mail.remoteSMTPPassword]"),t=document.createElement("div");t.classList.add("input-group"),t.innerHTML='\n        <input class="form-control" type="password" autocomplete="off" name="edit[mail.remoteSMTPPassword]" value="" data-pmf-toggle="SMTPtogglePassword">\n        <span class="input-group-text" id="SMTPtogglePassword"><i class="bi bi-eye-slash" id="SMTPtogglePassword_icon"></i></span>\n    ',e[0].insertAdjacentElement("afterend",t),e[0].remove();document.getElementById("SMTPtogglePassword").addEventListener("click",()=>{const t="password"===e[0].getAttribute("type")?"text":"password";e[0].setAttribute("type",t);const n=document.getElementById("SMTPtogglePassword_icon");n.classList.toggle("bi-eye"),n.classList.toggle("bi-eye-slash")})},_t=async()=>{const e=document.getElementsByName("edit[main.language]");if(null!==e){const t=await(async()=>{try{const e=await fetch("./api/configuration/translations");return e.ok?await e.text():""}catch(e){throw e}})();e[0]&&e[0].insertAdjacentHTML("beforeend",t)}},kt=async()=>{const e=document.getElementsByName("edit[layout.templateSet]");if(null!==e){const t=await(async()=>{try{const e=await fetch("./api/configuration/templates");return e.ok?await e.text():""}catch(e){throw e}})();e[0].insertAdjacentHTML("beforeend",t)}},It=async()=>{const e=document.getElementsByName("edit[records.orderby]");if(null!==e){const t=e[0].dataset.pmfConfigurationCurrentValue,n=await(async e=>{try{const t=await fetch(`./api/configuration/faqs-sorting-key/${e}`);return t.ok?await t.text():""}catch(t){throw t}})(t);e[0]&&e[0].insertAdjacentHTML("beforeend",n)}},jt=async()=>{const e=document.getElementsByName("edit[records.sortby]");if(null!==e){const t=e[0].dataset.pmfConfigurationCurrentValue,n=await(async e=>{try{const t=await fetch(`./api/configuration/faqs-sorting-order/${e}`);return t.ok?await t.text():""}catch(t){throw t}})(t);e[0].insertAdjacentHTML("beforeend",n)}},Ct=async()=>{const e=document.getElementsByName("edit[records.orderingPopularFaqs]");if(null!==e){const t=e[0].dataset.pmfConfigurationCurrentValue,n=await(async e=>{try{const t=await fetch(`./api/configuration/faqs-sorting-popular/${e}`);return t.ok?await t.text():""}catch(t){throw t}})(t);e[0].insertAdjacentHTML("beforeend",n)}},Lt=async()=>{const e=document.getElementsByName("edit[security.permLevel]");if(null!==e){const t=e[0].dataset.pmfConfigurationCurrentValue,n=await(async e=>{try{const t=await fetch(`./api/configuration/perm-level/${e}`);return t.ok?await t.text():""}catch(t){throw t}})(t);e[0].insertAdjacentHTML("beforeend",n)}},Tt=async()=>{const e=document.getElementsByName("edit[upgrade.releaseEnvironment]");if(null!==e){const t=e[0].dataset.pmfConfigurationCurrentValue,n=await(async e=>{try{const t=await fetch(`./api/configuration/release-environment/${e}`);return t.ok?await t.text():""}catch(t){throw t}})(t);e[0].insertAdjacentHTML("beforeend",n)}},xt=async()=>{const e=document.getElementsByName("edit[search.relevance]");if(null!==e){const t=e[0].dataset.pmfConfigurationCurrentValue,n=await(async e=>{try{const t=await fetch(`./api/configuration/search-relevance/${e}`);return t.ok?await t.text():""}catch(t){throw t}})(t);e[0].insertAdjacentHTML("beforeend",n)}},Bt=async()=>{const e=document.querySelectorAll('select[name^="edit[seo.metaTags"]');if(e)for(const t of e){const e=t.dataset.pmfConfigurationCurrentValue,n=await rt(e);t.insertAdjacentHTML("beforeend",n)}},At=async e=>{const t=document.getElementById("pmf-language");if(!t)throw new Error("Language element not found");const n=t.value,o=await(async(e,t)=>{try{const n=await fetch(`./api/configuration/list/${e.substring(1)}`,{headers:{"Accept-Language":t}});if(!n.ok)throw new Error("Network response was not ok.");return await n.text()}catch(n){throw n}})(e,n),a=document.querySelector(e);if(!a)throw new Error(`Tab content for target ${e} not found`);for(;a.firstChild;)a.removeChild(a.firstChild);a.innerHTML=o.toString();const i=a.querySelector('input[name="edit[upgrade.dateLastChecked]"]');if(i){const e=new Date(i.value).toLocaleString();i.value="Invalid Date"!==e?e:"n/a"}},Mt=e=>{for(const t of e)if("attributes"===t.type&&"data-value"===t.attributeName){const e=t.target.getAttribute("data-value");Ot(e)}},Ot=e=>{const t=new m(top?.document.getElementById("sessionWarningModal"));"show"===e?t.show():t.hide()},qt=()=>{const e=document.getElementById("pmf-button-reload-page");e&&e.addEventListener("click",()=>{location.reload()})},Dt=e=>{const t=document.querySelector(`#${e}`);if(t)for(const n of t.options)n.selected=!0},Nt=e=>{const t=document.querySelector(`#${e}`);if(t)for(const n of t.options)n.selected=!1},Pt=(e,t=2)=>{if(0===e)return"0 Bytes";const n=t<0?0:t,o=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,o)).toFixed(n))} ${["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"][o]}`},zt=e=>e?e.replace(/_/g,"-").replace(/-([a-z]{2})$/i,(e,t)=>"-"+t.toUpperCase()):e,Rt=async()=>{const e=document.querySelectorAll("button.pmf-elasticsearch");e&&e.forEach(e=>{e.addEventListener("click",async e=>{e.preventDefault();const a=e.target.getAttribute("data-action");try{const e=await(async e=>{try{const t=await fetch(`./api/elasticsearch/${e}`,{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});return await t.json()}catch(t){throw t}})(a);void 0!==e.success?(n(e.success),setInterval(t,5e3)):o(e.error)}catch(i){o(i)}});const t=async()=>{const e=document.getElementById("pmf-elasticsearch-stats");if(e){e.innerHTML="";try{const t=await(async()=>{try{const e=await fetch("./api/elasticsearch/statistics",{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});return await e.json()}catch(e){throw e}})();if(t.index){const n=t.index,o=t.stats,a=o.indices[n].total.docs.count??0,i=o.indices[n].total.store.size_in_bytes??0;let r='<dl class="row">';r+=`<dt class="col-sm-3">Documents</dt><dd class="col-sm-9">${a??0}</dd>`,r+=`<dt class="col-sm-3">Storage size</dt><dd class="col-sm-9">${Pt(i??0)}</dd>`,r+="</dl>",e.innerHTML=r}}catch(t){o(t)}}};t()})},Ft=()=>{if(document.getElementById("forms")){document.querySelectorAll("#active").forEach(e=>{e.addEventListener("change",async()=>{const t=e.checked,o=e.getAttribute("data-pmf-csrf-token"),a=e.getAttribute("data-pmf-inputid"),i=e.getAttribute("data-pmf-formid"),r=await(async(e,t,n,o)=>{try{const a=await fetch("api/forms/activate",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:e,formid:t,inputid:n,checked:o})});if(200===a.status)return await a.json();throw new Error("Network response was not ok.")}catch(a){throw a}})(o,i,a,t);"string"==typeof r.success?n(r.success):console.error(r.error)})}),document.querySelectorAll("#required").forEach(e=>{e.addEventListener("change",async()=>{const t=e.checked,o=e.getAttribute("data-pmf-csrf-token"),a=e.getAttribute("data-pmf-inputid"),i=e.getAttribute("data-pmf-formid"),r=await(async(e,t,n,o)=>{try{const a=await fetch("api/forms/required",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:e,formid:t,inputid:n,checked:o})});if(200===a.status)return await a.json();throw new Error("Network response was not ok.")}catch(a){throw a}})(o,i,a,t);"string"==typeof r.success?n(r.success):console.error(r.error)})});const e=document.getElementById("ask-question-tab"),t=document.getElementById("add-content-tab"),o=document.getElementById("ask-question"),a=document.getElementById("add-content");e&&e.addEventListener("click",n=>{n.preventDefault(),e.classList.add("active"),t.classList.remove("active"),o.classList.add("active"),a.classList.remove("active")}),t&&t.addEventListener("click",n=>{n.preventDefault(),t.classList.add("active"),e.classList.remove("active"),a.classList.add("active"),o.classList.remove("active")})}},Ht=()=>{if(document.getElementById("formTranslations")){document.querySelectorAll("#editTranslation").forEach(e=>{e.addEventListener("click",async()=>{const t=e.getAttribute("data-pmf-lang"),o=document.getElementById("labelInput_"+t);if(o.disabled)o.disabled=!1,e.classList.remove("bg-primary"),e.classList.add("bg-success"),e.children[0]&&(e.children[0].classList.remove("bi-check"),e.children[0].classList.add("bi-pencil"));else{o.disabled=!0,e.classList.add("bg-primary"),e.classList.remove("bg-success"),e.children[0]&&(e.children[0].classList.add("bi-pencil"),e.children[0].classList.remove("bi-check"));const a=e.getAttribute("data-pmf-csrf"),i=e.getAttribute("data-pmf-formId"),r=e.getAttribute("data-pmf-inputId"),s=await(async(e,t,n,o,a)=>{try{const i=await fetch("api/forms/translation-edit",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:e,formId:t,inputId:n,lang:a,label:o})});if(200===i.status)return await i.json();throw new Error("Network response was not ok.")}catch(i){throw i}})(a,i,r,t,o.value);"string"==typeof s.success?n(s.success):console.error(s.error)}})});document.querySelectorAll("#deleteTranslation").forEach(e=>{e.addEventListener("click",async()=>{const t=e.getAttribute("data-pmf-csrf"),o=e.getAttribute("data-pmf-inputId"),a=e.getAttribute("data-pmf-formId"),i=e.getAttribute("data-pmf-lang"),r=await(async(e,t,n,o)=>{try{const a=await fetch("api/forms/translation-delete",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:e,formId:t,inputId:n,lang:o})});if(200===a.status)return await a.json();throw new Error("Network response was not ok.")}catch(a){throw a}})(t,a,o,i);if("string"==typeof r.success){n(r.success),document.getElementById("item_"+i)?.remove();const t=document.createElement("option");t.innerText=e.getAttribute("data-pmf-langname"),document.getElementById("languageSelect")?.appendChild(t)}else console.error(r.error)})});const e=document.getElementById("addTranslation"),t=document.getElementById("languageSelect"),o=document.getElementById("translationText");e&&e.addEventListener("click",async a=>{a.preventDefault();const i=e.getAttribute("data-pmf-csrf"),r=e.getAttribute("data-pmf-inputId"),s=e.getAttribute("data-pmf-formId"),l=await(async(e,t,n,o,a)=>{try{const i=await fetch("api/forms/translation-add",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:e,formId:t,inputId:n,lang:o,translation:a})});if(200===i.status)return await i.json();throw new Error("Network response was not ok.")}catch(i){throw i}})(i,s,r,t.value,o.value);"string"==typeof l.success?(n(l.success),setTimeout(()=>{window.location.reload()},3e3)):console.error(l.error)})}},Wt=()=>{const e=document.querySelector(".pmf-instance-add"),t=document.querySelectorAll(".pmf-instance-delete"),n=document.getElementById("pmf-modal-add-instance");if(e){const t=new m(n);e.addEventListener("click",async e=>{e.preventDefault();const n=document.querySelector("#pmf-csrf-token").value,o=document.querySelector("#url").value,a=document.querySelector("#instance").value,i=document.querySelector("#comment").value,r=document.querySelector("#email").value,s=document.querySelector("#admin").value,c=document.querySelector("#password").value;try{const e=await(async(e,t,n,o,a,i,r)=>{try{const s=await fetch("./api/faq/search",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:e,url:t,instance:n,comment:o,email:a,admin:i,password:r})});return await s.json()}catch(s){throw s}})(n,o,a,i,r,s,c);if(!e.added)throw new Error("Network response was not ok");{const n=document.querySelector(".table tbody"),o=l("tr",{id:`row-instance-${e.added}`},[l("td",{innerText:e.added}),l("td",{},[l("a",{href:e.url,target:"_blank",innerText:e.url})]),l("td",{innerText:a}),l("td",{innerText:i}),l("td",{},[l("a",{href:`./instance/edit/${e.added}`,classList:"btn btn-info"},[l("i",{classList:"bi bi-pencil",ariaHidden:!0})])]),l("td",{},[l("button",{classList:"btn btn-danger","data-delete-instance-id":`${e.added}`,type:"button"},[l("i",{ariaHidden:!0,classList:"bi bi-trash","data-delete-instance-id":`${e.added}`})])])]);n.appendChild(o),t.hide()}}catch(d){document.querySelector(".table").insertAdjacentElement("afterend",l("div",{classList:"alert alert-danger",innerText:d}))}})}t&&t.forEach(e=>{e.addEventListener("click",async e=>{e.preventDefault();const t=e.target.getAttribute("data-delete-instance-id"),n=e.target.getAttribute("data-csrf-token");if(confirm("Are you sure?"))try{const e=await(async(e,t)=>{try{const n=await fetch("./api/instance/delete",{method:"DELETE",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:e,instanceId:t})});return await n.json()}catch(n){throw n}})(n,t);if(!e.deleted)throw new Error("Network response was not ok");{const t=document.getElementById(`row-instance-${e.deleted}`);t.addEventListener("click",()=>t.style.opacity="0"),t.addEventListener("transitionend",()=>t.remove())}}catch(o){const e=document.querySelector(".table"),t=await o.cause.response.json();e.insertAdjacentElement("afterend",l("div",{classList:"alert alert-danger",innerText:t.error}))}})})},Vt=async()=>{const e=document.querySelectorAll("button.pmf-opensearch");e&&e.forEach(e=>{e.addEventListener("click",async e=>{e.preventDefault();const a=e.target.getAttribute("data-action");try{const e=await(async e=>{try{const t=await fetch(`./api/opensearch/${e}`,{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});return await t.json()}catch(t){throw t}})(a);void 0!==e.success?(n(e.success),setInterval(t,5e3)):o(e.error)}catch(i){o(i)}});const t=async()=>{const e=document.getElementById("pmf-opensearch-stats");if(e){e.innerHTML="";try{const t=await(async()=>{try{const e=await fetch("./api/opensearch/statistics",{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});return await e.json()}catch(e){throw e}})();if(t.index){const n=t.index,o=t.stats,a=o.indices[n].total.docs.count??0,i=o.indices[n].total.store.size_in_bytes??0;let r='<dl class="row">';r+=`<dt class="col-sm-3">Documents</dt><dd class="col-sm-9">${a??0}</dd>`,r+=`<dt class="col-sm-3">Storage size</dt><dd class="col-sm-9">${Pt(i??0)}</dd>`,r+="</dl>",e.innerHTML=r}}catch(t){o(t)}}};t()})},$t=async e=>{try{const t=await(async e=>{try{const t=await fetch(`./api/stopwords?language=${e}`,{method:"GET",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}});return await t.json()}catch(t){throw t}})(e);Yt(t)}catch(t){const e=await t.cause.response.json();console.error(e)}},Yt=e=>{const t=Jt(e);document.getElementById("pmf-stopwords-content").innerHTML=t;const n=document.querySelectorAll(".pmf-stop-word-input");n&&n.forEach(e=>{e.addEventListener("keydown",async t=>{await Qt(e.id,t)}),e.addEventListener("blur",async()=>{await en(e.id)}),e.addEventListener("focus",()=>{tn(e.id)})})},Ut=()=>{const e=document.getElementById("pmf-stop-words-loading-indicator"),t=l("i",{classList:"bi bi-cog bi-spin bi-fw"},[l("span",{classList:"sr-only",innerText:"Loading..."})]);e.appendChild(t)},Gt=()=>{document.getElementById("pmf-stop-words-loading-indicator").innerHTML=""},Jt=e=>{if("object"!=typeof e)return"";const t=l("table",{classList:"table table-hover align-middle"});let n=null;for(let o=0;o<e.length;o++){o%4==0&&(n=l("tr",{id:`stopwords_group_${o}`}),t.appendChild(n));const a=Zt(e[o].id,e[o].lang),i=l("td",{classList:"align-middle"});i.appendChild(Xt(a,e[o].stopword)),n&&n.appendChild(i)}return t.outerHTML},Xt=(e,t)=>{const n=l("input",{id:e||Zt(),classList:"form-control form-control-sm pmf-stop-word-input",type:"text"});return n.setAttribute("value",t||""),n},Zt=(e,t)=>`stopword_${e=e||-1}_${t=t||document.getElementById("pmf-stop-words-language-selector").value}`,Kt=e=>{const t=e.split("_");return{id:parseInt(t[1]),lang:t[2]}},Qt=async(e,t)=>{const n=document.getElementById(e);13===(t.charCode||t.keyCode||0)&&(""===n.value?await nn(e):n.blur())},en=async e=>{const t=Kt(e),n=document.getElementById(e),o=document.getElementById("pmf-csrf-token").value;if(n.getAttribute("data-old-value")!==n.value)try{await(async(e,t,n,o)=>{try{const a=await fetch("./api/stopword/save",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:e,stopWord:t,stopWordId:n,stopWordsLang:o})});return await a.json()}catch(a){throw a}})(o,n.value,t.id,t.lang),n.style.borderColor="#198754",n.style.backgroundImage="url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 8 8'%3e%3cpath fill='%23198754' d='M2.3 6.73L.6 4.53c-.4-1.04.46-1.4 1.1-.8l1.1 1.4 3.4-3.8c.6-.63 1.6-.27 1.2.7l-4 4.6c-.43.5-.8.4-1.1.1z'/%3e%3c/svg%3e\")",n.style.backgroundRepeat="no-repeat",n.style.backgroundPosition="right calc(0.375em + 0.1875rem) center",n.style.backgroundSize="calc(0.75em + 0.375rem) calc(0.75em + 0.375rem)"}catch(a){const e=await a.cause.response.json();document.querySelector(".table").insertAdjacentElement("beforebegin",l("div",{classList:"alert alert-danger",innerText:e}))}else t.id<0&&""===n.value&&n.remove()},tn=e=>{const t=document.getElementById(e);t.setAttribute("data-old-value",t.value)},nn=async e=>{const t=Kt(e),n=document.getElementById(e),o=document.getElementById("pmf-csrf-token").value;try{await(async(e,t,n)=>{try{const o=await fetch("./api/stopword/delete",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:e,stopWordId:t,stopWordsLang:n})});return await o.json()}catch(o){throw o}})(o,t.id,t.lang),n.addEventListener("click",()=>n.style.opacity="0"),n.addEventListener("transitionend",()=>n.remove())}catch(a){const e=await a.cause.response.json();document.querySelector(".table").insertAdjacentElement("beforebegin",l("div",{classList:"alert alert-danger",innerText:e}))}},on=async(e,t)=>{const n=document.getElementById(t);if(!n)return void console.error(`Progress bar element with id "${t}" not found`);if(!e.body)return void console.error("Response body is null, cannot stream progress");const o=e.body.getReader(),a=n;await async function e(){const{done:t,value:n}=await o.read();if(t)return a.style.width="100%",a.innerText="100%",a.classList.remove("progress-bar-animated","bg-primary"),void a.classList.add("bg-success");const i=(new TextDecoder).decode(n);try{const e=JSON.parse(i);e.progress&&(a.style.width=e.progress,a.innerText=e.progress)}catch(r){console.debug("JSON parse error (likely incomplete chunk):",r)}return e()}()},an=()=>{const e=document.getElementById("pmf-button-check-health"),t=document.getElementById("pmf-button-check-updates"),n=document.getElementById("pmf-button-download-now"),o=document.getElementById("pmf-button-extract-package"),a=document.getElementById("pmf-button-install-package"),i=document.getElementById("pmf-button-activate-maintenance-mode");e&&e.addEventListener("click",async e=>{e.preventDefault();try{const e=await(async()=>{try{const e=await fetch("./api/health-check",{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});return await e.json()}catch(e){throw e}})(),t=document.getElementById("result-check-health"),n=document.getElementById("pmf-update-step-health-check");e.success&&(n.classList.add("text-bg-success"),t.replaceWith(l("p",{id:"result-check-health",innerText:e.success}))),e.warning&&(n.classList.add("text-bg-warning"),t.replaceWith(l("p",{id:"result-check-health",innerText:e.warning})),i.classList.remove("d-none")),e.error&&(n.classList.add("text-bg-danger"),t.replaceWith(l("p",{id:"result-check-health",innerText:e.error})))}catch(t){console.error(t)}}),i&&i.addEventListener("click",async e=>{e.preventDefault();try{const e=i.getAttribute("data-pmf-csrf"),t=await(async e=>{try{const t=await fetch("./api/configuration/activate-maintenance-mode",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:e})});return await t.json()}catch(t){throw t}})(e),n=document.getElementById("result-check-health"),o=document.getElementById("pmf-update-step-health-check");t.success&&(o.classList.remove("text-bg-warning"),o.classList.add("text-bg-success"),n.replaceWith(l("p",{innerText:t.success})),i.classList.add("d-none"))}catch(t){console.error(t)}}),t&&t.addEventListener("click",async e=>{e.preventDefault();const o=document.getElementById("spinner-check-versions");o.classList.remove("d-none");try{const e=await(async()=>{try{const e=await fetch("./api/update-check",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}});return await e.json()}catch(e){throw e}})(),a=document.getElementById("dateLastChecked"),i=document.getElementById("versionCurrent"),r=document.getElementById("versionLastChecked"),s=document.getElementById("pmf-update-step-check-versions");if(a&&e.dateLastChecked){const t=new Date(e.dateLastChecked);a.innerText=`${t.toLocaleString()}`}if(i&&r&&e.version){const a=i.innerText.trim(),c=e.version.trim();r.innerText=c;const d=document.getElementById("result-check-versions");if(d){s.classList.remove("text-bg-success","text-bg-warning","text-bg-danger");ht(c,a,">=")?s.classList.add("text-bg-success"):(s.classList.add("text-bg-danger"),n.disabled=!0),d.replaceWith(l("p",{innerText:e.message})),o.classList.add("d-none"),t.disabled=!0}}else{const t=document.getElementById("result-check-versions");t&&e.message&&(s.classList.add("text-bg-danger"),t.replaceWith(l("p",{innerText:e.message}))),o.classList.add("d-none")}}catch(a){console.error(a),o.classList.add("d-none")}}),n&&n.addEventListener("click",async e=>{let t;e.preventDefault();const o=document.getElementById("versionLastChecked"),a=document.getElementById("releaseEnvironment"),i=document.getElementById("spinner-download-new-version");i.classList.remove("d-none"),t="nightly"===a.innerText.toLowerCase()?"nightly":o.innerText;try{const e=await(async e=>{try{const t=await fetch(`./api/download-package/${e}`,{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}});return await t.json()}catch(t){throw t}})(t),o=document.getElementById("result-download-new-version"),a=document.getElementById("pmf-update-step-extract-package"),r=document.getElementById("pmf-update-step-download");e.success&&(r.classList.add("text-bg-success"),a.classList.remove("d-none"),o.replaceWith(l("p",{innerText:e.success})),i.classList.add("d-none"),n.disabled=!0),e.error&&(r.classList.add("text-bg-danger"),o.replaceWith(l("p",{innerText:e.error})),i.classList.add("d-none"))}catch(r){const e=r;document.getElementById("result-download-new-version").replaceWith(l("p",{innerText:e.error})),i.classList.add("d-none")}}),o&&o.addEventListener("click",async e=>{e.preventDefault();const t=document.getElementById("spinner-extract-package");t.classList.remove("d-none");try{const e=await(async()=>{try{const e=await fetch("./api/extract-package",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}});return await e.json()}catch(e){throw e}})(),n=document.getElementById("result-extract-package"),a=document.getElementById("pmf-update-step-install-package"),i=document.getElementById("pmf-update-step-extract-package");n&&(i.classList.add("text-bg-success"),a.classList.remove("d-none"),n.replaceWith(l("p",{innerText:e.message})),t.classList.add("d-none"),o.disabled=!0)}catch(n){console.error(n)}}),a&&a.addEventListener("click",async e=>{e.preventDefault();const t=document.getElementById("spinner-install-package");t.classList.remove("d-none"),await rn(),t.classList.add("d-none")})},rn=async()=>{try{const e=await(async()=>{try{return await fetch("./api/create-temporary-backup",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}})}catch(e){throw e}})();await on(e,"result-backup-package")}catch(e){console.error("Error during temporary backup:",e);const t=document.getElementById("result-backup-package");throw t&&(t.classList.remove("progress-bar-animated","bg-primary"),t.classList.add("bg-danger")),e}await sn()},sn=async()=>{try{const e=await(async()=>{try{return await fetch("./api/install-package",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}})}catch(e){throw e}})();await on(e,"result-install-package")}catch(e){console.error("Error during package installation:",e);const t=document.getElementById("result-install-package");throw t&&(t.classList.remove("progress-bar-animated","bg-primary"),t.classList.add("bg-danger")),e}await ln()},ln=async()=>{const e=document.getElementById("pmf-update-step-install-package");try{const t=await(async()=>{try{return await fetch("./api/update-database",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}})}catch(e){throw e}})();await on(t,"result-update-database"),e&&e.classList.add("text-bg-success")}catch(t){console.error("Error during database update:",t);const n=document.getElementById("result-update-database");throw n&&(n.classList.remove("progress-bar-animated","bg-primary"),n.classList.add("bg-danger")),e&&e.classList.add("text-bg-danger"),t}},cn=()=>{const e=document.getElementById("filesToUpload"),t=document.getElementById("pmf-attachment-modal-upload");e&&(e.addEventListener("change",()=>{const t=e.files,n=document.getElementById("filesize"),o=document.querySelector(".pmf-attachment-upload-files");o.classList.remove("invisible");let a=0;const i=t?.length||0,r=[];for(let e=0;e<i;e++)a+=t[e].size,r.push(l("li",{innerText:t[e].name}));let s=a+" bytes";for(let e=["KiB","MiB","GiB","TiB"],l=0,c=a/1024;c>1;c/=1024,l++)s=c.toFixed(2)+" "+e[l]+" ("+a+" bytes)";n.innerHTML=s,o.append(l("ul",{className:"mt-2"},r))}),t?.addEventListener("click",async t=>{t.preventDefault(),t.stopImmediatePropagation();const n=e.files;if(!n||0===n.length)return void console.error("No files selected for upload.");const o=new FormData;for(let e=0;e<n.length;e++)o.append("filesToUpload[]",n[e]);o.append("record_id",document.getElementById("attachment_record_id").value),o.append("record_lang",document.getElementById("attachment_record_lang").value);try{const e=await(async e=>{try{const t=await fetch("./api/content/attachments/upload",{method:"POST",cache:"no-cache",body:e});return await t.json()}catch(t){throw t}})(o),t=document.getElementById("attachmentModal"),n=document.querySelector(".modal-backdrop.fade.show"),a=document.querySelector(".adminAttachments"),i=document.getElementById("filesize"),r=document.querySelectorAll(".pmf-attachment-upload-files li");e.forEach(e=>{const t=a.getAttribute("data-pmf-csrf-token");a.insertAdjacentElement("beforeend",l("li",{},[l("a",{className:"me-2",href:`../index.php?action=attachment&id=${e.attachmentId}`,innerText:e.fileName}),l("button",{type:"button",className:"btn btn-sm btn-danger pmf-delete-attachment-button","data-pmfAttachmentId":e.attachmentId,"data-pmfCsrfToken":t},[l("i",{className:"bi bi-trash","data-pmfAttachmentId":e.attachmentId,"data-pmfCsrfToken":t})])]))}),i.innerHTML="",r.forEach(e=>{e.remove()}),t.style.display="none",t.classList.remove("show"),n.remove()}catch(a){console.error("An error occurred:",a)}}))},dn=()=>{const e=document.querySelectorAll(".btn-refresh-attachment");e.length>0&&e.forEach(e=>{const t=e.cloneNode(!0);e.replaceWith(t),t.addEventListener("click",async e=>{e.preventDefault();const a=t.getAttribute("data-attachment-id"),i=t.getAttribute("data-csrf");if(a&&i){const e=await(async(e,t)=>{try{const n=await fetch("./api/content/attachments/refresh",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({attId:e,csrf:t})});return await n.json()}catch(n){throw n}})(a,i);if(e.success&&(n(e.success),e.delete)){const e=document.getElementById(`attachment_${a}`);e.style.opacity="0",e.addEventListener("transitionend",()=>e.remove())}e.error&&o(e.error)}})})};function un(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function hn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?un(Object(n),!0).forEach(function(t){mn(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):un(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function pn(e){return(pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gn(){return gn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},gn.apply(this,arguments)}function fn(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function yn(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var vn=yn(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),bn=yn(/Edge/i),wn=yn(/firefox/i),En=yn(/safari/i)&&!yn(/chrome/i)&&!yn(/android/i),Sn=yn(/iP(ad|od|hone)/i),_n=yn(/chrome/i)&&yn(/android/i),kn={capture:!1,passive:!1};function In(e,t,n){e.addEventListener(t,n,!vn&&kn)}function jn(e,t,n){e.removeEventListener(t,n,!vn&&kn)}function Cn(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(n){return!1}return!1}}function Ln(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function Tn(e,t,n,o){if(e){n=n||document;do{if(null!=t&&(">"===t[0]?e.parentNode===n&&Cn(e,t):Cn(e,t))||o&&e===n)return e;if(e===n)break}while(e=Ln(e))}return null}var xn,Bn=/\s+/g;function An(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var o=(" "+e.className+" ").replace(Bn," ").replace(" "+t+" "," ");e.className=(o+(n?" "+t:"")).replace(Bn," ")}}function Mn(e,t,n){var o=e&&e.style;if(o){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in o||-1!==t.indexOf("webkit")||(t="-webkit-"+t),o[t]=n+("string"==typeof n?"":"px")}}function On(e,t){var n="";if("string"==typeof e)n=e;else do{var o=Mn(e,"transform");o&&"none"!==o&&(n=o+" "+n)}while(!t&&(e=e.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(n)}function qn(e,t,n){if(e){var o=e.getElementsByTagName(t),a=0,i=o.length;if(n)for(;a<i;a++)n(o[a],a);return o}return[]}function Dn(){var e=document.scrollingElement;return e||document.documentElement}function Nn(e,t,n,o,a){if(e.getBoundingClientRect||e===window){var i,r,s,l,c,d,u;if(e!==window&&e.parentNode&&e!==Dn()?(r=(i=e.getBoundingClientRect()).top,s=i.left,l=i.bottom,c=i.right,d=i.height,u=i.width):(r=0,s=0,l=window.innerHeight,c=window.innerWidth,d=window.innerHeight,u=window.innerWidth),(t||n)&&e!==window&&(a=a||e.parentNode,!vn))do{if(a&&a.getBoundingClientRect&&("none"!==Mn(a,"transform")||n&&"static"!==Mn(a,"position"))){var h=a.getBoundingClientRect();r-=h.top+parseInt(Mn(a,"border-top-width")),s-=h.left+parseInt(Mn(a,"border-left-width")),l=r+i.height,c=s+i.width;break}}while(a=a.parentNode);if(o&&e!==window){var p=On(a||e),m=p&&p.a,g=p&&p.d;p&&(l=(r/=g)+(d/=g),c=(s/=m)+(u/=m))}return{top:r,left:s,bottom:l,right:c,width:u,height:d}}}function Pn(e,t,n){for(var o=Wn(e,!0),a=Nn(e)[t];o;){if(!(a>=Nn(o)[n]))return o;if(o===Dn())break;o=Wn(o,!1)}return!1}function zn(e,t,n,o){for(var a=0,i=0,r=e.children;i<r.length;){if("none"!==r[i].style.display&&r[i]!==Go.ghost&&(o||r[i]!==Go.dragged)&&Tn(r[i],n.draggable,e,!1)){if(a===t)return r[i];a++}i++}return null}function Rn(e,t){for(var n=e.lastElementChild;n&&(n===Go.ghost||"none"===Mn(n,"display")||t&&!Cn(n,t));)n=n.previousElementSibling;return n||null}function Fn(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===Go.clone||t&&!Cn(e,t)||n++;return n}function Hn(e){var t=0,n=0,o=Dn();if(e)do{var a=On(e),i=a.a,r=a.d;t+=e.scrollLeft*i,n+=e.scrollTop*r}while(e!==o&&(e=e.parentNode));return[t,n]}function Wn(e,t){if(!e||!e.getBoundingClientRect)return Dn();var n=e,o=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var a=Mn(n);if(n.clientWidth<n.scrollWidth&&("auto"==a.overflowX||"scroll"==a.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==a.overflowY||"scroll"==a.overflowY)){if(!n.getBoundingClientRect||n===document.body)return Dn();if(o||t)return n;o=!0}}}while(n=n.parentNode);return Dn()}function Vn(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function $n(e,t){return function(){if(!xn){var n=arguments;1===n.length?e.call(this,n[0]):e.apply(this,n),xn=setTimeout(function(){xn=void 0},t)}}}function Yn(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function Un(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function Gn(e,t,n){var o={};return Array.from(e.children).forEach(function(a){var i,r,s,l;if(Tn(a,t.draggable,e,!1)&&!a.animated&&a!==n){var c=Nn(a);o.left=Math.min(null!==(i=o.left)&&void 0!==i?i:1/0,c.left),o.top=Math.min(null!==(r=o.top)&&void 0!==r?r:1/0,c.top),o.right=Math.max(null!==(s=o.right)&&void 0!==s?s:-1/0,c.right),o.bottom=Math.max(null!==(l=o.bottom)&&void 0!==l?l:-1/0,c.bottom)}}),o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}var Jn="Sortable"+(new Date).getTime();function Xn(){var e,t=[];return{captureAnimationState:function(){(t=[],this.options.animation)&&[].slice.call(this.el.children).forEach(function(e){if("none"!==Mn(e,"display")&&e!==Go.ghost){t.push({target:e,rect:Nn(e)});var n=hn({},t[t.length-1].rect);if(e.thisAnimationDuration){var o=On(e,!0);o&&(n.top-=o.f,n.left-=o.e)}e.fromRect=n}})},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(function(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var o in t)if(t.hasOwnProperty(o)&&t[o]===e[n][o])return Number(n);return-1}(t,{target:e}),1)},animateAll:function(n){var o=this;if(!this.options.animation)return clearTimeout(e),void("function"==typeof n&&n());var a=!1,i=0;t.forEach(function(e){var t=0,n=e.target,r=n.fromRect,s=Nn(n),l=n.prevFromRect,c=n.prevToRect,d=e.rect,u=On(n,!0);u&&(s.top-=u.f,s.left-=u.e),n.toRect=s,n.thisAnimationDuration&&Vn(l,s)&&!Vn(r,s)&&(d.top-s.top)/(d.left-s.left)===(r.top-s.top)/(r.left-s.left)&&(t=function(e,t,n,o){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*o.animation}(d,l,c,o.options)),Vn(s,r)||(n.prevFromRect=r,n.prevToRect=s,t||(t=o.options.animation),o.animate(n,d,s,t)),t&&(a=!0,i=Math.max(i,t),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout(function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null},t),n.thisAnimationDuration=t)}),clearTimeout(e),a?e=setTimeout(function(){"function"==typeof n&&n()},i):"function"==typeof n&&n(),t=[]},animate:function(e,t,n,o){if(o){Mn(e,"transition",""),Mn(e,"transform","");var a=On(this.el),i=a&&a.a,r=a&&a.d,s=(t.left-n.left)/(i||1),l=(t.top-n.top)/(r||1);e.animatingX=!!s,e.animatingY=!!l,Mn(e,"transform","translate3d("+s+"px,"+l+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),Mn(e,"transition","transform "+o+"ms"+(this.options.easing?" "+this.options.easing:"")),Mn(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout(function(){Mn(e,"transition",""),Mn(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1},o)}}}}var Zn=[],Kn={initializeByDefault:!0},Qn={mount:function(e){for(var t in Kn)Kn.hasOwnProperty(t)&&!(t in e)&&(e[t]=Kn[t]);Zn.forEach(function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Zn.push(e)},pluginEvent:function(e,t,n){var o=this;this.eventCanceled=!1,n.cancel=function(){o.eventCanceled=!0};var a=e+"Global";Zn.forEach(function(o){t[o.pluginName]&&(t[o.pluginName][a]&&t[o.pluginName][a](hn({sortable:t},n)),t.options[o.pluginName]&&t[o.pluginName][e]&&t[o.pluginName][e](hn({sortable:t},n)))})},initializePlugins:function(e,t,n,o){for(var a in Zn.forEach(function(o){var a=o.pluginName;if(e.options[a]||o.initializeByDefault){var i=new o(e,t,e.options);i.sortable=e,i.options=e.options,e[a]=i,gn(n,i.defaults)}}),e.options)if(e.options.hasOwnProperty(a)){var i=this.modifyOption(e,a,e.options[a]);void 0!==i&&(e.options[a]=i)}},getEventProperties:function(e,t){var n={};return Zn.forEach(function(o){"function"==typeof o.eventProperties&&gn(n,o.eventProperties.call(t[o.pluginName],e))}),n},modifyOption:function(e,t,n){var o;return Zn.forEach(function(a){e[a.pluginName]&&a.optionListeners&&"function"==typeof a.optionListeners[t]&&(o=a.optionListeners[t].call(e[a.pluginName],n))}),o}};var eo=["evt"],to=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.evt,a=fn(n,eo);Qn.pluginEvent.bind(Go)(e,t,hn({dragEl:oo,parentEl:ao,ghostEl:io,rootEl:ro,nextEl:so,lastDownEl:lo,cloneEl:co,cloneHidden:uo,dragStarted:ko,putSortable:yo,activeSortable:Go.active,originalEvent:o,oldIndex:ho,oldDraggableIndex:mo,newIndex:po,newDraggableIndex:go,hideGhostForTarget:Vo,unhideGhostForTarget:$o,cloneNowHidden:function(){uo=!0},cloneNowShown:function(){uo=!1},dispatchSortableEvent:function(e){no({sortable:t,name:e,originalEvent:o})}},a))};function no(e){!function(e){var t=e.sortable,n=e.rootEl,o=e.name,a=e.targetEl,i=e.cloneEl,r=e.toEl,s=e.fromEl,l=e.oldIndex,c=e.newIndex,d=e.oldDraggableIndex,u=e.newDraggableIndex,h=e.originalEvent,p=e.putSortable,m=e.extraEventProperties;if(t=t||n&&n[Jn]){var g,f=t.options,y="on"+o.charAt(0).toUpperCase()+o.substr(1);!window.CustomEvent||vn||bn?(g=document.createEvent("Event")).initEvent(o,!0,!0):g=new CustomEvent(o,{bubbles:!0,cancelable:!0}),g.to=r||n,g.from=s||n,g.item=a||n,g.clone=i,g.oldIndex=l,g.newIndex=c,g.oldDraggableIndex=d,g.newDraggableIndex=u,g.originalEvent=h,g.pullMode=p?p.lastPutMode:void 0;var v=hn(hn({},m),Qn.getEventProperties(o,t));for(var b in v)g[b]=v[b];n&&n.dispatchEvent(g),f[y]&&f[y].call(t,g)}}(hn({putSortable:yo,cloneEl:co,targetEl:oo,rootEl:ro,oldIndex:ho,oldDraggableIndex:mo,newIndex:po,newDraggableIndex:go},e))}var oo,ao,io,ro,so,lo,co,uo,ho,po,mo,go,fo,yo,vo,bo,wo,Eo,So,_o,ko,Io,jo,Co,Lo,To=!1,xo=!1,Bo=[],Ao=!1,Mo=!1,Oo=[],qo=!1,Do=[],No="undefined"!=typeof document,Po=Sn,zo=bn||vn?"cssFloat":"float",Ro=No&&!_n&&!Sn&&"draggable"in document.createElement("div"),Fo=function(){if(No){if(vn)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Ho=function(e,t){var n=Mn(e),o=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),a=zn(e,0,t),i=zn(e,1,t),r=a&&Mn(a),s=i&&Mn(i),l=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+Nn(a).width,c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+Nn(i).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(a&&r.float&&"none"!==r.float){var d="left"===r.float?"left":"right";return!i||"both"!==s.clear&&s.clear!==d?"horizontal":"vertical"}return a&&("block"===r.display||"flex"===r.display||"table"===r.display||"grid"===r.display||l>=o&&"none"===n[zo]||i&&"none"===n[zo]&&l+c>o)?"vertical":"horizontal"},Wo=function(e){function t(e,n){return function(o,a,i,r){var s=o.options.group.name&&a.options.group.name&&o.options.group.name===a.options.group.name;if(null==e&&(n||s))return!0;if(null==e||!1===e)return!1;if(n&&"clone"===e)return e;if("function"==typeof e)return t(e(o,a,i,r),n)(o,a,i,r);var l=(n?o:a).options.group.name;return!0===e||"string"==typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var n={},o=e.group;o&&"object"==pn(o)||(o={name:o}),n.name=o.name,n.checkPull=t(o.pull,!0),n.checkPut=t(o.put),n.revertClone=o.revertClone,e.group=n},Vo=function(){!Fo&&io&&Mn(io,"display","none")},$o=function(){!Fo&&io&&Mn(io,"display","")};No&&!_n&&document.addEventListener("click",function(e){if(xo)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),xo=!1,!1},!0);var Yo=function(e){if(oo){e=e.touches?e.touches[0]:e;var t=(a=e.clientX,i=e.clientY,Bo.some(function(e){var t=e[Jn].options.emptyInsertThreshold;if(t&&!Rn(e)){var n=Nn(e),o=a>=n.left-t&&a<=n.right+t,s=i>=n.top-t&&i<=n.bottom+t;return o&&s?r=e:void 0}}),r);if(t){var n={};for(var o in e)e.hasOwnProperty(o)&&(n[o]=e[o]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[Jn]._onDragOver(n)}}var a,i,r},Uo=function(e){oo&&oo.parentNode[Jn]._isOutsideThisEl(e.target)};function Go(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=gn({},t),e[Jn]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Ho(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Go.supportPointer&&"PointerEvent"in window&&(!En||Sn),emptyInsertThreshold:5};for(var o in Qn.initializePlugins(this,e,n),n)!(o in t)&&(t[o]=n[o]);for(var a in Wo(t),this)"_"===a.charAt(0)&&"function"==typeof this[a]&&(this[a]=this[a].bind(this));this.nativeDraggable=!t.forceFallback&&Ro,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?In(e,"pointerdown",this._onTapStart):(In(e,"mousedown",this._onTapStart),In(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(In(e,"dragover",this),In(e,"dragenter",this)),Bo.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),gn(this,Xn())}function Jo(e,t,n,o,a,i,r,s){var l,c,d=e[Jn],u=d.options.onMove;return!window.CustomEvent||vn||bn?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=n,l.draggedRect=o,l.related=a||t,l.relatedRect=i||Nn(t),l.willInsertAfter=s,l.originalEvent=r,e.dispatchEvent(l),u&&(c=u.call(d,l,r)),c}function Xo(e){e.draggable=!1}function Zo(){qo=!1}function Ko(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,o=0;n--;)o+=t.charCodeAt(n);return o.toString(36)}function Qo(e){return setTimeout(e,0)}function ea(e){return clearTimeout(e)}Go.prototype={constructor:Go,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(Io=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,oo):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,n=this.el,o=this.options,a=o.preventOnFilter,i=e.type,r=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,s=(r||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,c=o.filter;if(function(e){Do.length=0;var t=e.getElementsByTagName("input"),n=t.length;for(;n--;){var o=t[n];o.checked&&Do.push(o)}}(n),!oo&&!(/mousedown|pointerdown/.test(i)&&0!==e.button||o.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!En||!s||"SELECT"!==s.tagName.toUpperCase())&&!((s=Tn(s,o.draggable,n,!1))&&s.animated||lo===s)){if(ho=Fn(s),mo=Fn(s,o.draggable),"function"==typeof c){if(c.call(this,e,s,this))return no({sortable:t,rootEl:l,name:"filter",targetEl:s,toEl:n,fromEl:n}),to("filter",t,{evt:e}),void(a&&e.preventDefault())}else if(c&&(c=c.split(",").some(function(o){if(o=Tn(l,o.trim(),n,!1))return no({sortable:t,rootEl:o,name:"filter",targetEl:s,fromEl:n,toEl:n}),to("filter",t,{evt:e}),!0})))return void(a&&e.preventDefault());o.handle&&!Tn(l,o.handle,n,!1)||this._prepareDragStart(e,r,s)}}},_prepareDragStart:function(e,t,n){var o,a=this,i=a.el,r=a.options,s=i.ownerDocument;if(n&&!oo&&n.parentNode===i){var l=Nn(n);if(ro=i,ao=(oo=n).parentNode,so=oo.nextSibling,lo=n,fo=r.group,Go.dragged=oo,vo={target:oo,clientX:(t||e).clientX,clientY:(t||e).clientY},So=vo.clientX-l.left,_o=vo.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,oo.style["will-change"]="all",o=function(){to("delayEnded",a,{evt:e}),Go.eventCanceled?a._onDrop():(a._disableDelayedDragEvents(),!wn&&a.nativeDraggable&&(oo.draggable=!0),a._triggerDragStart(e,t),no({sortable:a,name:"choose",originalEvent:e}),An(oo,r.chosenClass,!0))},r.ignore.split(",").forEach(function(e){qn(oo,e.trim(),Xo)}),In(s,"dragover",Yo),In(s,"mousemove",Yo),In(s,"touchmove",Yo),r.supportPointer?(In(s,"pointerup",a._onDrop),!this.nativeDraggable&&In(s,"pointercancel",a._onDrop)):(In(s,"mouseup",a._onDrop),In(s,"touchend",a._onDrop),In(s,"touchcancel",a._onDrop)),wn&&this.nativeDraggable&&(this.options.touchStartThreshold=4,oo.draggable=!0),to("delayStart",this,{evt:e}),!r.delay||r.delayOnTouchOnly&&!t||this.nativeDraggable&&(bn||vn))o();else{if(Go.eventCanceled)return void this._onDrop();r.supportPointer?(In(s,"pointerup",a._disableDelayedDrag),In(s,"pointercancel",a._disableDelayedDrag)):(In(s,"mouseup",a._disableDelayedDrag),In(s,"touchend",a._disableDelayedDrag),In(s,"touchcancel",a._disableDelayedDrag)),In(s,"mousemove",a._delayedDragTouchMoveHandler),In(s,"touchmove",a._delayedDragTouchMoveHandler),r.supportPointer&&In(s,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(o,r.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){oo&&Xo(oo),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;jn(e,"mouseup",this._disableDelayedDrag),jn(e,"touchend",this._disableDelayedDrag),jn(e,"touchcancel",this._disableDelayedDrag),jn(e,"pointerup",this._disableDelayedDrag),jn(e,"pointercancel",this._disableDelayedDrag),jn(e,"mousemove",this._delayedDragTouchMoveHandler),jn(e,"touchmove",this._delayedDragTouchMoveHandler),jn(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?In(document,"pointermove",this._onTouchMove):In(document,t?"touchmove":"mousemove",this._onTouchMove):(In(oo,"dragend",this),In(ro,"dragstart",this._onDragStart));try{document.selection?Qo(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch(n){}},_dragStarted:function(e,t){if(To=!1,ro&&oo){to("dragStarted",this,{evt:t}),this.nativeDraggable&&In(document,"dragover",Uo);var n=this.options;!e&&An(oo,n.dragClass,!1),An(oo,n.ghostClass,!0),Go.active=this,e&&this._appendGhost(),no({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(bo){this._lastX=bo.clientX,this._lastY=bo.clientY,Vo();for(var e=document.elementFromPoint(bo.clientX,bo.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(bo.clientX,bo.clientY))!==t;)t=e;if(oo.parentNode[Jn]._isOutsideThisEl(e),t)do{if(t[Jn]){if(t[Jn]._onDragOver({clientX:bo.clientX,clientY:bo.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break}e=t}while(t=Ln(t));$o()}},_onTouchMove:function(e){if(vo){var t=this.options,n=t.fallbackTolerance,o=t.fallbackOffset,a=e.touches?e.touches[0]:e,i=io&&On(io,!0),r=io&&i&&i.a,s=io&&i&&i.d,l=Po&&Lo&&Hn(Lo),c=(a.clientX-vo.clientX+o.x)/(r||1)+(l?l[0]-Oo[0]:0)/(r||1),d=(a.clientY-vo.clientY+o.y)/(s||1)+(l?l[1]-Oo[1]:0)/(s||1);if(!Go.active&&!To){if(n&&Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(io){i?(i.e+=c-(wo||0),i.f+=d-(Eo||0)):i={a:1,b:0,c:0,d:1,e:c,f:d};var u="matrix(".concat(i.a,",").concat(i.b,",").concat(i.c,",").concat(i.d,",").concat(i.e,",").concat(i.f,")");Mn(io,"webkitTransform",u),Mn(io,"mozTransform",u),Mn(io,"msTransform",u),Mn(io,"transform",u),wo=c,Eo=d,bo=a}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!io){var e=this.options.fallbackOnBody?document.body:ro,t=Nn(oo,!0,Po,!0,e),n=this.options;if(Po){for(Lo=e;"static"===Mn(Lo,"position")&&"none"===Mn(Lo,"transform")&&Lo!==document;)Lo=Lo.parentNode;Lo!==document.body&&Lo!==document.documentElement?(Lo===document&&(Lo=Dn()),t.top+=Lo.scrollTop,t.left+=Lo.scrollLeft):Lo=Dn(),Oo=Hn(Lo)}An(io=oo.cloneNode(!0),n.ghostClass,!1),An(io,n.fallbackClass,!0),An(io,n.dragClass,!0),Mn(io,"transition",""),Mn(io,"transform",""),Mn(io,"box-sizing","border-box"),Mn(io,"margin",0),Mn(io,"top",t.top),Mn(io,"left",t.left),Mn(io,"width",t.width),Mn(io,"height",t.height),Mn(io,"opacity","0.8"),Mn(io,"position",Po?"absolute":"fixed"),Mn(io,"zIndex","100000"),Mn(io,"pointerEvents","none"),Go.ghost=io,e.appendChild(io),Mn(io,"transform-origin",So/parseInt(io.style.width)*100+"% "+_o/parseInt(io.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,o=e.dataTransfer,a=n.options;to("dragStart",this,{evt:e}),Go.eventCanceled?this._onDrop():(to("setupClone",this),Go.eventCanceled||((co=Un(oo)).removeAttribute("id"),co.draggable=!1,co.style["will-change"]="",this._hideClone(),An(co,this.options.chosenClass,!1),Go.clone=co),n.cloneId=Qo(function(){to("clone",n),Go.eventCanceled||(n.options.removeCloneOnHide||ro.insertBefore(co,oo),n._hideClone(),no({sortable:n,name:"clone"}))}),!t&&An(oo,a.dragClass,!0),t?(xo=!0,n._loopId=setInterval(n._emulateDragOver,50)):(jn(document,"mouseup",n._onDrop),jn(document,"touchend",n._onDrop),jn(document,"touchcancel",n._onDrop),o&&(o.effectAllowed="move",a.setData&&a.setData.call(n,o,oo)),In(document,"drop",n),Mn(oo,"transform","translateZ(0)")),To=!0,n._dragStartId=Qo(n._dragStarted.bind(n,t,e)),In(document,"selectstart",n),ko=!0,window.getSelection().removeAllRanges(),En&&Mn(document.body,"user-select","none"))},_onDragOver:function(e){var t,n,o,a,i=this.el,r=e.target,s=this.options,l=s.group,c=Go.active,d=fo===l,u=s.sort,h=yo||c,p=this,m=!1;if(!qo){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),r=Tn(r,s.draggable,i,!0),T("dragOver"),Go.eventCanceled)return m;if(oo.contains(e.target)||r.animated&&r.animatingX&&r.animatingY||p._ignoreWhileAnimating===r)return B(!1);if(xo=!1,c&&!s.disabled&&(d?u||(o=ao!==ro):yo===this||(this.lastPutMode=fo.checkPull(this,c,oo,e))&&l.checkPut(this,c,oo,e))){if(a="vertical"===this._getDirection(e,r),t=Nn(oo),T("dragOverValid"),Go.eventCanceled)return m;if(o)return ao=ro,x(),this._hideClone(),T("revert"),Go.eventCanceled||(so?ro.insertBefore(oo,so):ro.appendChild(oo)),B(!0);var g=Rn(i,s.draggable);if(!g||function(e,t,n){var o=Nn(Rn(n.el,n.options.draggable)),a=Gn(n.el,n.options,io),i=10;return t?e.clientX>a.right+i||e.clientY>o.bottom&&e.clientX>o.left:e.clientY>a.bottom+i||e.clientX>o.right&&e.clientY>o.top}(e,a,this)&&!g.animated){if(g===oo)return B(!1);if(g&&i===e.target&&(r=g),r&&(n=Nn(r)),!1!==Jo(ro,i,oo,t,r,n,e,!!r))return x(),g&&g.nextSibling?i.insertBefore(oo,g.nextSibling):i.appendChild(oo),ao=i,A(),B(!0)}else if(g&&function(e,t,n){var o=Nn(zn(n.el,0,n.options,!0)),a=Gn(n.el,n.options,io),i=10;return t?e.clientX<a.left-i||e.clientY<o.top&&e.clientX<o.right:e.clientY<a.top-i||e.clientY<o.bottom&&e.clientX<o.left}(e,a,this)){var f=zn(i,0,s,!0);if(f===oo)return B(!1);if(n=Nn(r=f),!1!==Jo(ro,i,oo,t,r,n,e,!1))return x(),i.insertBefore(oo,f),ao=i,A(),B(!0)}else if(r.parentNode===i){n=Nn(r);var y,v,b,w=oo.parentNode!==i,E=!function(e,t,n){var o=n?e.left:e.top,a=n?e.right:e.bottom,i=n?e.width:e.height,r=n?t.left:t.top,s=n?t.right:t.bottom,l=n?t.width:t.height;return o===r||a===s||o+i/2===r+l/2}(oo.animated&&oo.toRect||t,r.animated&&r.toRect||n,a),S=a?"top":"left",_=Pn(r,"top","top")||Pn(oo,"top","top"),k=_?_.scrollTop:void 0;if(Io!==r&&(v=n[S],Ao=!1,Mo=!E&&s.invertSwap||w),y=function(e,t,n,o,a,i,r,s){var l=o?e.clientY:e.clientX,c=o?n.height:n.width,d=o?n.top:n.left,u=o?n.bottom:n.right,h=!1;if(!r)if(s&&Co<c*a){if(!Ao&&(1===jo?l>d+c*i/2:l<u-c*i/2)&&(Ao=!0),Ao)h=!0;else if(1===jo?l<d+Co:l>u-Co)return-jo}else if(l>d+c*(1-a)/2&&l<u-c*(1-a)/2)return function(e){return Fn(oo)<Fn(e)?1:-1}(t);if((h=h||r)&&(l<d+c*i/2||l>u-c*i/2))return l>d+c/2?1:-1;return 0}(e,r,n,a,E?1:s.swapThreshold,null==s.invertedSwapThreshold?s.swapThreshold:s.invertedSwapThreshold,Mo,Io===r),0!==y){var I=Fn(oo);do{I-=y,b=ao.children[I]}while(b&&("none"===Mn(b,"display")||b===io))}if(0===y||b===r)return B(!1);Io=r,jo=y;var j=r.nextElementSibling,C=!1,L=Jo(ro,i,oo,t,r,n,e,C=1===y);if(!1!==L)return 1!==L&&-1!==L||(C=1===L),qo=!0,setTimeout(Zo,30),x(),C&&!j?i.appendChild(oo):r.parentNode.insertBefore(oo,C?j:r),_&&Yn(_,0,k-_.scrollTop),ao=oo.parentNode,void 0===v||Mo||(Co=Math.abs(v-Nn(r)[S])),A(),B(!0)}if(i.contains(oo))return B(!1)}return!1}function T(s,l){to(s,p,hn({evt:e,isOwner:d,axis:a?"vertical":"horizontal",revert:o,dragRect:t,targetRect:n,canSort:u,fromSortable:h,target:r,completed:B,onMove:function(n,o){return Jo(ro,i,oo,t,n,Nn(n),e,o)},changed:A},l))}function x(){T("dragOverAnimationCapture"),p.captureAnimationState(),p!==h&&h.captureAnimationState()}function B(t){return T("dragOverCompleted",{insertion:t}),t&&(d?c._hideClone():c._showClone(p),p!==h&&(An(oo,yo?yo.options.ghostClass:c.options.ghostClass,!1),An(oo,s.ghostClass,!0)),yo!==p&&p!==Go.active?yo=p:p===Go.active&&yo&&(yo=null),h===p&&(p._ignoreWhileAnimating=r),p.animateAll(function(){T("dragOverAnimationComplete"),p._ignoreWhileAnimating=null}),p!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(r===oo&&!oo.animated||r===i&&!r.animated)&&(Io=null),s.dragoverBubble||e.rootEl||r===document||(oo.parentNode[Jn]._isOutsideThisEl(e.target),!t&&Yo(e)),!s.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),m=!0}function A(){po=Fn(oo),go=Fn(oo,s.draggable),no({sortable:p,name:"change",toEl:i,newIndex:po,newDraggableIndex:go,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){jn(document,"mousemove",this._onTouchMove),jn(document,"touchmove",this._onTouchMove),jn(document,"pointermove",this._onTouchMove),jn(document,"dragover",Yo),jn(document,"mousemove",Yo),jn(document,"touchmove",Yo)},_offUpEvents:function(){var e=this.el.ownerDocument;jn(e,"mouseup",this._onDrop),jn(e,"touchend",this._onDrop),jn(e,"pointerup",this._onDrop),jn(e,"pointercancel",this._onDrop),jn(e,"touchcancel",this._onDrop),jn(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;po=Fn(oo),go=Fn(oo,n.draggable),to("drop",this,{evt:e}),ao=oo&&oo.parentNode,po=Fn(oo),go=Fn(oo,n.draggable),Go.eventCanceled||(To=!1,Mo=!1,Ao=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ea(this.cloneId),ea(this._dragStartId),this.nativeDraggable&&(jn(document,"drop",this),jn(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),En&&Mn(document.body,"user-select",""),Mn(oo,"transform",""),e&&(ko&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),io&&io.parentNode&&io.parentNode.removeChild(io),(ro===ao||yo&&"clone"!==yo.lastPutMode)&&co&&co.parentNode&&co.parentNode.removeChild(co),oo&&(this.nativeDraggable&&jn(oo,"dragend",this),Xo(oo),oo.style["will-change"]="",ko&&!To&&An(oo,yo?yo.options.ghostClass:this.options.ghostClass,!1),An(oo,this.options.chosenClass,!1),no({sortable:this,name:"unchoose",toEl:ao,newIndex:null,newDraggableIndex:null,originalEvent:e}),ro!==ao?(po>=0&&(no({rootEl:ao,name:"add",toEl:ao,fromEl:ro,originalEvent:e}),no({sortable:this,name:"remove",toEl:ao,originalEvent:e}),no({rootEl:ao,name:"sort",toEl:ao,fromEl:ro,originalEvent:e}),no({sortable:this,name:"sort",toEl:ao,originalEvent:e})),yo&&yo.save()):po!==ho&&po>=0&&(no({sortable:this,name:"update",toEl:ao,originalEvent:e}),no({sortable:this,name:"sort",toEl:ao,originalEvent:e})),Go.active&&(null!=po&&-1!==po||(po=ho,go=mo),no({sortable:this,name:"end",toEl:ao,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){to("nulling",this),ro=oo=ao=io=so=co=lo=uo=vo=bo=ko=po=go=ho=mo=Io=jo=yo=fo=Go.dragged=Go.ghost=Go.clone=Go.active=null,Do.forEach(function(e){e.checked=!0}),Do.length=wo=Eo=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":oo&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],n=this.el.children,o=0,a=n.length,i=this.options;o<a;o++)Tn(e=n[o],i.draggable,this.el,!1)&&t.push(e.getAttribute(i.dataIdAttr)||Ko(e));return t},sort:function(e,t){var n={},o=this.el;this.toArray().forEach(function(e,t){var a=o.children[t];Tn(a,this.options.draggable,o,!1)&&(n[e]=a)},this),t&&this.captureAnimationState(),e.forEach(function(e){n[e]&&(o.removeChild(n[e]),o.appendChild(n[e]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return Tn(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var o=Qn.modifyOption(this,e,t);n[e]=void 0!==o?o:t,"group"===e&&Wo(n)},destroy:function(){to("destroy",this);var e=this.el;e[Jn]=null,jn(e,"mousedown",this._onTapStart),jn(e,"touchstart",this._onTapStart),jn(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(jn(e,"dragover",this),jn(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(e){e.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Bo.splice(Bo.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!uo){if(to("hideClone",this),Go.eventCanceled)return;Mn(co,"display","none"),this.options.removeCloneOnHide&&co.parentNode&&co.parentNode.removeChild(co),uo=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(uo){if(to("showClone",this),Go.eventCanceled)return;oo.parentNode!=ro||this.options.group.revertClone?so?ro.insertBefore(co,so):ro.appendChild(co):ro.insertBefore(co,oo),this.options.group.revertClone&&this.animate(oo,co),Mn(co,"display",""),uo=!1}}else this._hideClone()}},No&&In(document,"touchmove",function(e){(Go.active||To)&&e.cancelable&&e.preventDefault()}),Go.utils={on:In,off:jn,css:Mn,find:qn,is:function(e,t){return!!Tn(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},throttle:$n,closest:Tn,toggleClass:An,clone:Un,index:Fn,nextTick:Qo,cancelNextTick:ea,detectDirection:Ho,getChild:zn,expando:Jn},Go.get=function(e){return e[Jn]},Go.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach(function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(Go.utils=hn(hn({},Go.utils),e.utils)),Qn.mount(e)})},Go.create=function(e,t){return new Go(e,t)},Go.version="1.15.6";var ta,na,oa,aa,ia,ra,sa=[],la=!1;function ca(){sa.forEach(function(e){clearInterval(e.pid)}),sa=[]}function da(){clearInterval(ra)}var ua=$n(function(e,t,n,o){if(t.scroll){var a,i=(e.touches?e.touches[0]:e).clientX,r=(e.touches?e.touches[0]:e).clientY,s=t.scrollSensitivity,l=t.scrollSpeed,c=Dn(),d=!1;na!==n&&(na=n,ca(),ta=t.scroll,a=t.scrollFn,!0===ta&&(ta=Wn(n,!0)));var u=0,h=ta;do{var p=h,m=Nn(p),g=m.top,f=m.bottom,y=m.left,v=m.right,b=m.width,w=m.height,E=void 0,S=void 0,_=p.scrollWidth,k=p.scrollHeight,I=Mn(p),j=p.scrollLeft,C=p.scrollTop;p===c?(E=b<_&&("auto"===I.overflowX||"scroll"===I.overflowX||"visible"===I.overflowX),S=w<k&&("auto"===I.overflowY||"scroll"===I.overflowY||"visible"===I.overflowY)):(E=b<_&&("auto"===I.overflowX||"scroll"===I.overflowX),S=w<k&&("auto"===I.overflowY||"scroll"===I.overflowY));var L=E&&(Math.abs(v-i)<=s&&j+b<_)-(Math.abs(y-i)<=s&&!!j),T=S&&(Math.abs(f-r)<=s&&C+w<k)-(Math.abs(g-r)<=s&&!!C);if(!sa[u])for(var x=0;x<=u;x++)sa[x]||(sa[x]={});sa[u].vx==L&&sa[u].vy==T&&sa[u].el===p||(sa[u].el=p,sa[u].vx=L,sa[u].vy=T,clearInterval(sa[u].pid),0==L&&0==T||(d=!0,sa[u].pid=setInterval(function(){o&&0===this.layer&&Go.active._onTouchMove(ia);var t=sa[this.layer].vy?sa[this.layer].vy*l:0,n=sa[this.layer].vx?sa[this.layer].vx*l:0;"function"==typeof a&&"continue"!==a.call(Go.dragged.parentNode[Jn],n,t,e,ia,sa[this.layer].el)||Yn(sa[this.layer].el,n,t)}.bind({layer:u}),24))),u++}while(t.bubbleScroll&&h!==c&&(h=Wn(h,!1)));la=d}},30),ha=function(e){var t=e.originalEvent,n=e.putSortable,o=e.dragEl,a=e.activeSortable,i=e.dispatchSortableEvent,r=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(t){var l=n||a;r();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,d=document.elementFromPoint(c.clientX,c.clientY);s(),l&&!l.el.contains(d)&&(i("spill"),this.onSpill({dragEl:o,putSortable:n}))}};function pa(){}function ma(){}pa.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var o=zn(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(t,o):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:ha},gn(pa,{pluginName:"revertOnSpill"}),ma.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable||this.sortable;n.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),n.animateAll()},drop:ha},gn(ma,{pluginName:"removeOnSpill"}),Go.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?In(document,"dragover",this._handleAutoScroll):this.options.supportPointer?In(document,"pointermove",this._handleFallbackAutoScroll):t.touches?In(document,"touchmove",this._handleFallbackAutoScroll):In(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?jn(document,"dragover",this._handleAutoScroll):(jn(document,"pointermove",this._handleFallbackAutoScroll),jn(document,"touchmove",this._handleFallbackAutoScroll),jn(document,"mousemove",this._handleFallbackAutoScroll)),da(),ca(),clearTimeout(xn),xn=void 0},nulling:function(){ia=na=ta=la=ra=oa=aa=null,sa.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var n=this,o=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,i=document.elementFromPoint(o,a);if(ia=e,t||this.options.forceAutoScrollFallback||bn||vn||En){ua(e,this.options,i,t);var r=Wn(i,!0);!la||ra&&o===oa&&a===aa||(ra&&da(),ra=setInterval(function(){var i=Wn(document.elementFromPoint(o,a),!0);i!==r&&(r=i,ca()),ua(e,n.options,i,t)},10),oa=o,aa=a)}else{if(!this.options.bubbleScroll||Wn(i,!0)===Dn())return void ca();ua(e,this.options,Wn(i,!1),!1)}}},gn(e,{pluginName:"scroll",initializeByDefault:!0})}),Go.mount(ma,pa);const ga=".nested-sortable",fa="pmfCatid",ya=async()=>{const e=document.getElementsByName("pmf-category-delete-button"),t=document.getElementById("deleteConfirmModal");if(!t||!e)return;const o=new m(t),a=document.getElementById("confirmDeleteButton");let i="",r="";e.forEach(e=>{e.addEventListener("click",async e=>{e.preventDefault();const t=e.target;i=t.getAttribute("data-pmf-category-id"),r=t.getAttribute("data-pmf-language"),o.show()})}),a.addEventListener("click",async()=>{if(!i||!r)return;const e=document.querySelector("input[name=pmf-csrf-token]").value,t=await(async(e,t,n)=>{try{const o=await fetch("./api/category/delete",{method:"DELETE",cache:"no-cache",headers:{"Content-Type":"application/json"},body:JSON.stringify({categoryId:e,language:t,csrfToken:n}),redirect:"follow",referrerPolicy:"no-referrer"});return await o.json()}catch(o){throw o}})(i,r,e);t.success&&n(t.success),document.getElementById(`pmf-category-${i}`)?.remove(),o.hide(),i="",r=""})},va=e=>{const t=document.getElementById("returnMessage"),n=document.getElementById(`pmf-comments-selected-${e}`),o=new FormData(n);fetch(`${window.location.pathname}api/content/comments`,{method:"DELETE",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({type:e,data:c(o)})}).then(async e=>{if(e.ok)return e.json();throw new Error("Network response was not ok.")}).then(e=>{if(e.success){document.querySelectorAll("tr td input:checked").forEach(e=>{e.parentNode?.parentNode?.parentNode?.remove()})}else t.append(l("div",{className:"alert alert-danger",innerText:e.error}))}).catch(async e=>{const n=await e.cause.response.json();t.append(l("div",{className:"alert alert-danger",innerText:n}))})};y.prototype.controls.classSpan={command:"applyClassName",exec:f,list:["enabled","disabled","activated","text-left","text-center","text-right","warning","error"],isChildActive:(e,t)=>{const n=e.s.current();if(n){const o=v.closest(n,v.isElement,e.editor)||e.editor;return Boolean(t.control.args&&o.classList.contains(t.control.args[0].toString()))}return!1},isActive:(e,t)=>{const n=e.s.current();if(n){const o=v.closest(n,v.isElement,e.editor)||e.editor;let a=!1;return t.control.list&&Object.keys(t.control.list).forEach(e=>{o.classList.contains(e)&&(a=!0)}),Boolean(o&&o!==e.editor&&void 0!==t.control.list&&a)}return!1},childTemplate:(e,t,n)=>`<span class="${t}">${e.i18n(n)}</span>`,tooltip:"Insert className"};b.add("classSpan",class extends E{constructor(){super(...arguments),this.buttons=[{name:"classSpan",group:"script"}]}afterInit(e){e.registerCommand("applyClassName",(t,n,o)=>(e.s.commitStyle({attributes:{class:o}}),!1))}beforeDestruct(){}}),w.set("class-span",'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"> <path d="M36 4h-24c-2.21 0-4 1.79-4 4v32c0 2.21 1.79 4 4 4h24c2.21 0 4-1.79 4-4v-32c0-2.21-1.79-4-4-4zm-24 4h10v16l-5-3-5 3v-16z"/> </svg> ');function ba(e){const t=/([^[]*)\[([^\]]+)]/,n=/[\s]*,[\s]*/,o=/^(.*)[\s]*=[\s]*(.*)$/,a={};return S(e)?(e.split(n).map(e=>{e=_(e);const i=t.exec(e),r={},s=e=>{e=_(e);const t=o.exec(e);t?r[t[1]]=t[2]:r[e]=!0};if(i){const e=i[2].split(n);i[1]&&(e.forEach(s),a[i[1].toUpperCase()]=r)}else a[e.toUpperCase()]=!0}),a):!!e&&(Object.keys(e).forEach(t=>{a[t.toUpperCase()]=e[t]}),a)}function wa(e,t){const{s:n}=e;let o=t;if(!o){o=e.createInside.fake();const{range:t}=n;v.safeInsertNode(t,o),t.collapse()}const a=v.furthest(o,Ea,e.editor);if(a)if(n.cursorOnTheLeft(a))v.before(a,o);else if(n.cursorOnTheRight(a))v.after(a,o);else{const e=n.splitSelection(a);e&&v.after(e,o)}t||(n.setCursorBefore(o),v.safeRemove(o))}function Ea(e){return v.isInlineBlock(e)&&!v.isTag(e,k)}y.prototype.cleanHTML={timeout:300,removeEmptyElements:!0,fillEmptyParagraph:!0,replaceNBSP:!0,replaceOldTags:{i:"em",b:"strong"},allowTags:!1,denyTags:"script",useIframeSandbox:!1,removeOnError:!0,safeJavaScriptLink:!0,disableCleanFilter:null},y.prototype.controls.eraser={command:"removeFormat",tooltip:"Clear Formatting"},w.set("eraser",'<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox="0 0 1792 1792"> <path d="M832 1408l336-384h-768l-336 384h768zm1013-1077q15 34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38 0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38 0 69.5 20.5t47.5 54.5z"/> </svg> ');const Sa=new Set(["table","tbody","thead","tfoot","tr"]);const _a=Object.freeze(Object.defineProperty({__proto__:null,allowAttributes:function(e,t,n,o){if(o&&v.isElement(t)&&!0!==o[t.nodeName]){const e=t.attributes;if(e&&e.length){const a=[];for(let n=0;n<e.length;n+=1){const i=o[t.nodeName][e[n].name];(!i||!0!==i&&i!==e[n].value)&&a.push(e[n].name)}a.length&&(n=!0),a.forEach(e=>{t.removeAttribute(e)})}}return n},fillEmptyParagraph:function(e,t,n){if(e.o.cleanHTML.fillEmptyParagraph&&v.isBlock(t)&&v.isEmpty(t,k)&&!v.isTag(t,Sa)){const n=e.createInside.element("br");return t.appendChild(n),!0}return n},removeEmptyTextNode:function(e,t,n,o,a,i){return v.isText(t)&&!t.nodeValue?(t===i&&e.s.isCollapsed()&&e.s.setCursorAfter(t),v.safeRemove(t),!0):n},removeInvTextNodes:function(e,t,n,o,a,i){if(i===t||!v.isText(t)||null==t.nodeValue)return n;if(!j().test(t.nodeValue))return n;const r=v.furthest(i,v.isBlock,e.editor);return!r||v.isOrContains(r,t)?n:(t.nodeValue=t.nodeValue.replace(j(),""),t===i&&e.s.isCollapsed()&&e.s.setCursorAfter(t),t.nodeValue||v.safeRemove(t),!0)},replaceOldTags:function(e,t,n){const o=function(e,t,n){if(!n||!v.isHTMLElement(t))return t;const o=n[t.nodeName.toLowerCase()]||n[t.nodeName];if(o)return v.replace(t,o,e.createInside,!0,!1);return t}(e,t,e.o.cleanHTML.replaceOldTags);return t!==o?(t=o,!0):n},sanitizeAttributes:function(e,t,n){return!(!v.isElement(t)||!C(t,{safeJavaScriptLink:e.options.cleanHTML.safeJavaScriptLink,removeOnError:e.options.cleanHTML.removeOnError}))||n},tryRemoveNode:function(e,t,n,o,a,i){return function(e,t,n,o,a){if(!v.isText(t)){if(o&&!o[t.nodeName])return!0;if(!o&&a&&a[t.nodeName])return!0}if(!e.o.cleanHTML.removeEmptyElements)return!1;return v.isElement(t)&&null!=t.nodeName.match(L)&&!v.isTemporary(t)&&0===T(t.innerHTML).length&&(null==n||!v.isOrContains(t,n))}(e,t,i,o,a)?(v.safeRemove(t),!0):n}},Symbol.toStringTag,{value:"Module"})),ka=Object.keys(_a);var Ia=function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};class ja extends E{constructor(){super(...arguments),this.buttons=[{name:"eraser",group:"font-style"}],this.currentSelectionNode=null,this.walker=new A(this.j.async,{timeout:this.j.o.cleanHTML.timeout})}afterInit(e){}get isEditMode(){return!(this.j.isInDestruct||!this.j.isEditorMode()||this.j.getReadOnly())}onChangeCleanHTML(){if(!this.isEditMode)return;const e=this.j;this.walker.setWork(e.editor),this.currentSelectionNode=e.s.current()}startWalker(){const{jodit:e}=this,t=ba(this.j.o.cleanHTML.allowTags),n=ba(this.j.o.cleanHTML.denyTags);this.walker.on("visit",o=>function(e,t,n,o,a){let i=!1;const r=e.o.cleanHTML.disableCleanFilter;for(const s of ka)if(!(r&&r.has(s)||(i=(0,_a[s])(e,t,i,n,o,a),t.isConnected)))return!0;return i}(e,o,t,n,this.currentSelectionNode)).on("end",e=>{this.j.e.fire(e?"internalChange finishedCleanHTMLWorker":"finishedCleanHTMLWorker")})}beforeCommand(e){if("removeformat"===e.toLowerCase())return this.j.s.isCollapsed()?wa(this.j):function(e){const{s:t,editor:n,createInside:o}=e,{range:a}=t,i=a.cloneRange(),r=a.cloneRange(),s=o.fake(),l=o.fake();i.collapse(!0),r.collapse(!1),v.safeInsertNode(i,s),v.safeInsertNode(r,l),a.setStartBefore(s),a.collapse(!0),t.selectRange(a),wa(e,s),a.setEndAfter(l),a.collapse(!1),t.selectRange(a),wa(e,l);const c=[];v.between(s,l,e=>{Ea(e)&&!v.isTag(e,"a")&&c.push(e),v.isElement(e)&&I(e,"style")&&I(e,"style",null)}),c.forEach(e=>v.unwrap(e));const d=(e,t)=>{if(!v.findNotEmptySibling(e,t)){const o=e.parentNode;if(o&&o!==n&&I(o,"style"))return I(o,"style",null),d(o,t),!0}};d(s,!0)&&d(l,!1),a.setStartAfter(s),a.setEndBefore(l),t.selectRange(a),v.safeRemove(s),v.safeRemove(l)}(this.j),!1}onBeforeSetNativeEditorValue(e){const[t,n]=this.j.o.cleanHTML.useIframeSandbox?this.j.createInside.sandbox():[this.j.createInside.div()];return t.innerHTML=e.value,this.onSafeHTML(t),e.value=t.innerHTML,M(t,{safeJavaScriptLink:!0,removeOnError:!0}),v.safeRemove(n),!1}onSafeHTML(e){M(e,this.j.o.cleanHTML)}beforeDestruct(){this.walker.destruct()}}Ia([x([":change",":afterSetMode",":afterInit",":mousedown",":keydown"])],ja.prototype,"onChangeCleanHTML",null),Ia([B("ready")],ja.prototype,"startWalker",null),Ia([x(":beforeCommand")],ja.prototype,"beforeCommand",null),Ia([x(":beforeSetNativeEditorValue")],ja.prototype,"onBeforeSetNativeEditorValue",null),Ia([x(":safeHTML")],ja.prototype,"onSafeHTML",null),b.add("cleanHtml",ja);y.prototype.controls.cut={command:"cut",isDisabled:e=>e.s.isCollapsed(),tooltip:"Cut selection"},y.prototype.controls.copy={command:"copy",isDisabled:e=>e.s.isCollapsed(),tooltip:"Copy selection"},y.prototype.controls.selectall={icon:"select-all",command:"selectall",tooltip:"Select all"},w.set("copy",'<svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"> <path d="M24.89,6.61H22.31V4.47A2.47,2.47,0,0,0,19.84,2H6.78A2.47,2.47,0,0,0,4.31,4.47V22.92a2.47,2.47,0,0,0,2.47,2.47H9.69V27.2a2.8,2.8,0,0,0,2.8,2.8h12.4a2.8,2.8,0,0,0,2.8-2.8V9.41A2.8,2.8,0,0,0,24.89,6.61ZM6.78,23.52a.61.61,0,0,1-.61-.6V4.47a.61.61,0,0,1,.61-.6H19.84a.61.61,0,0,1,.61.6V6.61h-8a2.8,2.8,0,0,0-2.8,2.8V23.52Zm19,3.68a.94.94,0,0,1-.94.93H12.49a.94.94,0,0,1-.94-.93V9.41a.94.94,0,0,1,.94-.93h12.4a.94.94,0,0,1,.94.93Z"/> <path d="M23.49,13.53h-9.6a.94.94,0,1,0,0,1.87h9.6a.94.94,0,1,0,0-1.87Z"/> <path d="M23.49,17.37h-9.6a.94.94,0,1,0,0,1.87h9.6a.94.94,0,1,0,0-1.87Z"/> <path d="M23.49,21.22h-9.6a.93.93,0,1,0,0,1.86h9.6a.93.93,0,1,0,0-1.86Z"/> </svg> ').set("cut",'<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox="0 0 1792 1792"> <path d="M960 896q26 0 45 19t19 45-19 45-45 19-45-19-19-45 19-45 45-19zm300 64l507 398q28 20 25 56-5 35-35 51l-128 64q-13 7-29 7-17 0-31-8l-690-387-110 66q-8 4-12 5 14 49 10 97-7 77-56 147.5t-132 123.5q-132 84-277 84-136 0-222-78-90-84-79-207 7-76 56-147t131-124q132-84 278-84 83 0 151 31 9-13 22-22l122-73-122-73q-13-9-22-22-68 31-151 31-146 0-278-84-82-53-131-124t-56-147q-5-59 15.5-113t63.5-93q85-79 222-79 145 0 277 84 83 52 132 123t56 148q4 48-10 97 4 1 12 5l110 66 690-387q14-8 31-8 16 0 29 7l128 64q30 16 35 51 3 36-25 56zm-681-260q46-42 21-108t-106-117q-92-59-192-59-74 0-113 36-46 42-21 108t106 117q92 59 192 59 74 0 113-36zm-85 745q81-51 106-117t-21-108q-39-36-113-36-100 0-192 59-81 51-106 117t21 108q39 36 113 36 100 0 192-59zm178-613l96 58v-11q0-36 33-56l14-8-79-47-26 26q-3 3-10 11t-12 12q-2 2-4 3.5t-3 2.5zm224 224l96 32 736-576-128-64-768 431v113l-160 96 9 8q2 2 7 6 4 4 11 12t11 12l26 26zm704 416l128-64-520-408-177 138q-2 3-13 7z"/> </svg> ').set("paste",'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"> <path stroke-width="0" d="M10.5 20H2a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h1V3l2.03-.4a3 3 0 0 1 5.94 0L13 3v1h1a2 2 0 0 1 2 2v1h-2V6h-1v1H3V6H2v12h5v2h3.5zM8 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm2 4h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2v-8c0-1.1.9-2 2-2zm0 2v8h8v-8h-8z"/> </svg> ').set("select-all",'<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox="0 0 18 18"> <g fill-rule="evenodd" stroke="none" stroke-width="1"> <g transform="translate(-381.000000, -381.000000)"> <g transform="translate(381.000000, 381.000000)"> <path d="M0,2 L2,2 L2,0 C0.9,0 0,0.9 0,2 L0,2 Z M0,10 L2,10 L2,8 L0,8 L0,10 L0,10 Z M4,18 L6,18 L6,16 L4,16 L4,18 L4,18 Z M0,6 L2,6 L2,4 L0,4 L0,6 L0,6 Z M10,0 L8,0 L8,2 L10,2 L10,0 L10,0 Z M16,0 L16,2 L18,2 C18,0.9 17.1,0 16,0 L16,0 Z M2,18 L2,16 L0,16 C0,17.1 0.9,18 2,18 L2,18 Z M0,14 L2,14 L2,12 L0,12 L0,14 L0,14 Z M6,0 L4,0 L4,2 L6,2 L6,0 L6,0 Z M8,18 L10,18 L10,16 L8,16 L8,18 L8,18 Z M16,10 L18,10 L18,8 L16,8 L16,10 L16,10 Z M16,18 C17.1,18 18,17.1 18,16 L16,16 L16,18 L16,18 Z M16,6 L18,6 L18,4 L16,4 L16,6 L16,6 Z M16,14 L18,14 L18,12 L16,12 L16,14 L16,14 Z M12,18 L14,18 L14,16 L12,16 L12,18 L12,18 Z M12,2 L14,2 L14,0 L12,0 L12,2 L12,2 Z M4,14 L14,14 L14,4 L4,4 L4,14 L4,14 Z M6,6 L12,6 L12,12 L6,12 L6,6 L6,6 Z"/> </g> </g> </g> </svg> ');b.add("clipboard",class{constructor(){this.buttons=[{name:"cut",group:"clipboard"},{name:"copy",group:"clipboard"},{name:"paste",group:"clipboard"},{name:"selectall",group:"clipboard"}]}init(e){var t;null===(t=this.buttons)||void 0===t||t.forEach(t=>e.registerButton(t)),e.e.off(`copy.${O} cut.${O}`).on(`copy.${O} cut.${O}`,t=>{var n;const o=e.s.html,a=q(t)||q(e.ew)||q(t.originalEvent);a&&(a.setData(D,N(o)),a.setData(P,o)),e.buffer.set(O,o),e.e.fire("pasteStack",{html:o,action:e.o.defaultActionOnPaste||z}),"cut"===t.type&&(e.s.remove(),e.s.focus()),t.preventDefault(),null===(n=null==e?void 0:e.events)||void 0===n||n.fire("afterCopy",o)})}destruct(e){var t,n;null===(t=R(e,"buffer"))||void 0===t||t.set(O,""),null===(n=null==e?void 0:e.events)||void 0===n||n.off("."+O)}});const Ca=Object.freeze(Object.defineProperty({__proto__:null,ar:{"copy-format":" "},cs_cz:{"copy-format":"Koprovat formt"},de:{"copy-format":"Format kopieren"},es:{"copy-format":"Copiar formato"},fa:{"copy-format":"  "},fi:{"copy-format":"Kopioi muotoilu"},fr:{"copy-format":"Format de copie"},he:{"copy-format":" "},hu:{"copy-format":"Formtum msols"},id:{"copy-format":"salin format"},it:{"copy-format":"Copia il formato"},ja:{"copy-format":"copyformat"},ko:{"copy-format":" "},mn:{"copy-format":" "},nl:{"copy-format":"opmaak kopiren"},pl:{"copy-format":"format kopii"},pt_br:{"copy-format":"Copiar formato"},ru:{"copy-format":" "},tr:{"copy-format":"Kopyalama Biimi"},zh_cn:{"copy-format":""},zh_tw:{"copy-format":""}},Symbol.toStringTag,{value:"Module"})),La="copy-format",Ta=["lineHeight","fontWeight","fontStyle","fontSize","fontFamily","color","margin","padding","borderWidth","borderStyle","borderColor","borderRadius","backgroundColor","textDecorationLine"],xa=(e,t,n,o)=>{let a=F(n,t);return a===o[t]&&(a=n.parentNode&&n!==e.editor&&n.parentNode!==e.editor?xa(e,t,n.parentNode,o):void 0),a};y.prototype.controls.copyformat={exec:(e,t,{button:n})=>{if(t){if(e.buffer.exists(La))e.buffer.delete(La),e.e.off(e.editor,"mouseup."+La);else{const n={},o=v.up(t,e=>e&&!v.isText(e),e.editor)||e.editor,a=e.createInside.span();e.editor.appendChild(a),Ta.forEach(e=>{n[e]=F(a,e)}),a!==e.editor&&v.safeRemove(a);const i=((e,t,n)=>{const o={};return t&&Ta.forEach(a=>{o[a]=xa(e,a,t,n),a.match(/border(Style|Color)/)&&!o.borderWidth&&(o[a]=void 0)}),o})(e,o,n),r=()=>{e.buffer.delete(La);const t=e.s.current();t&&(v.isTag(t,"img")?F(t,i):e.s.commitStyle({attributes:{style:i}})),e.e.off(e.editor,"mouseup."+La)};e.e.on(e.editor,"mouseup."+La,r),e.buffer.set(La,!0)}n.update()}},isActive:e=>e.buffer.exists(La),tooltip:"Paint format"},b.add("copyformat",function(e){e.registerButton({name:"copyformat",group:"clipboard"}),H(Ca)}),w.set("copyformat",'<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox="0 0 16 16"> <path stroke-width="0" d="M16 9v-6h-3v-1c0-0.55-0.45-1-1-1h-11c-0.55 0-1 0.45-1 1v3c0 0.55 0.45 1 1 1h11c0.55 0 1-0.45 1-1v-1h2v4h-9v2h-0.5c-0.276 0-0.5 0.224-0.5 0.5v5c0 0.276 0.224 0.5 0.5 0.5h2c0.276 0 0.5-0.224 0.5-0.5v-5c0-0.276-0.224-0.5-0.5-0.5h-0.5v-1h9zM12 3h-11v-1h11v1z"/> </svg> ');y.prototype.fullsize=!1,y.prototype.globalFullSize=!0,w.set("fullsize",'<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox="0 0 24 24"> <path stroke-width="0" d="M22,20.6L3.4,2H8V0H0v8h2V3.4L20.6,22H16v2h8v-8h-2V20.6z M16,0v2h4.7l-6.3,6.3l1.4,1.4L22,3.5V8h2V0H16z M8.3,14.3L2,20.6V16H0v8h8v-2H3.5l6.3-6.3L8.3,14.3z"/> </svg> ').set("shrink",'<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox="0 0 1792 1792"> <path d="M896 960v448q0 26-19 45t-45 19-45-19l-144-144-332 332q-10 10-23 10t-23-10l-114-114q-10-10-10-23t10-23l332-332-144-144q-19-19-19-45t19-45 45-19h448q26 0 45 19t19 45zm755-672q0 13-10 23l-332 332 144 144q19 19 19 45t-19 45-45 19h-448q-26 0-45-19t-19-45v-448q0-26 19-45t45-19 45 19l144 144 332-332q10-10 23-10t23 10l114 114q10 10 10 23z"/> </svg> '),y.prototype.controls.fullsize={exec:e=>{e.toggleFullSize()},update(e,t){const n=e.isFullSize?"shrink":"fullsize";t.state.activated=e.isFullSize,e.o.textIcons?t.state.text=n:t.state.icon.name=n},tooltip:"Open in fullsize",mode:W+V};const Ba=new Set;b.add("fullsize",function(e){e.registerButton({name:"fullsize"});let t=!1,n=0,o=0,a=!1;const i=()=>{const{container:i,events:r}=e;r&&(t?(n=F(i,"height",!0),o=F(i,"width",!0),F(i,{height:e.ow.innerHeight,width:e.ow.innerWidth}),a=!0):a&&F(i,{height:n||"auto",width:o||"auto"}))},r=n=>{var o;const{container:a,events:r}=e;if(!a)return;void 0===n&&(n=!a.classList.contains("jodit_fullsize")),e.setMod("fullsize",n),e.o.fullsize=n,t=n,a.classList.toggle("jodit_fullsize",n),e.toolbar&&($(e)&&(null===(o=e.toolbarContainer)||void 0===o||o.appendChild(e.toolbar.container)),F(e.toolbar.container,"width","auto")),n?Ba.add(a):Ba.delete(a);if(e.o.globalFullSize&&(1===Ba.size&&n||0===Ba.size&&!n)){let e=a.parentNode;for(;e&&e.nodeType!==Node.DOCUMENT_NODE&&e.nodeType!==Node.DOCUMENT_FRAGMENT_NODE;)e.classList.toggle("jodit_fullsize-box_true",n),e=e.parentNode;i()}r.fire("afterResize")};e.o.globalFullSize&&e.e.on(e.ow,"resize",i),e.e.on("afterInit afterOpen",()=>{var t;e.toggleFullSize(null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.fullsize)}).on("toggleFullSize",r).on("beforeDestruct",()=>{t&&r(!1)}).on("beforeDestruct",()=>{e.events&&e.e.off(e.ow,"resize",i)})});w.set("hr",'<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox="0 0 1792 1792"> <path d="M1600 736v192q0 40-28 68t-68 28h-1216q-40 0-68-28t-28-68v-192q0-40 28-68t68-28h1216q40 0 68 28t28 68z"/> </svg> '),y.prototype.controls.hr={command:"insertHorizontalRule",tags:["hr"],tooltip:"Insert Horizontal Line"},b.add("hr",function(e){e.registerButton({name:"hr",group:"insert"}),e.registerCommand("insertHorizontalRule",()=>{const t=e.createInside.element("hr");e.s.insertNode(t,!1,!1);const n=v.closest(t.parentElement,v.isBlock,e.editor);n&&v.isEmpty(n)&&n!==e.editor&&(v.after(n,t),v.safeRemove(n));let o=v.next(t,v.isBlock,e.editor,!1);return o||(o=e.createInside.element(e.o.enter),v.after(t,o)),e.s.setCursorIn(o),!1})}),y.prototype.imageProcessor={replaceDataURIToBlobIdInView:!0};var Aa=function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};const Ma="__jodit_imageprocessor_binded",Oa=Ma+"blob-id";class qa extends E{afterInit(e){}beforeDestruct(e){const t=R(e,"buffer"),n=null==t?void 0:t.get(Oa);if(t&&n){const e=Object.keys(n);for(const t of e)URL.revokeObjectURL(t);t.delete(Oa)}}onAfterGetValueFromEditor(e,t){if(t!==U)return this.onBeforeSetElementValue(e)}onBeforeSetElementValue(e){const{jodit:t}=this;if(!t.o.imageProcessor.replaceDataURIToBlobIdInView)return;const n=t.buffer.get(Oa);if(n){const t=Object.keys(n);for(const o of t)for(;e.value.includes(o);)e.value=e.value.replace(o,n[o])}}async afterChange(e){const{jodit:t}=this;t.editor&&G("img",t.editor).forEach(e=>{J(e,Ma)||(J(e,Ma,!0),e.complete||t.e.on(e,"load",function n(){var o;!t.isInDestruct&&(null===(o=t.e)||void 0===o||o.fire("resize")),t.e.off(e,"load",n)}),e.src&&/^data:/.test(e.src)&&function(e,t){if(!e.o.imageProcessor.replaceDataURIToBlobIdInView)return;if("undefined"==typeof ArrayBuffer||"undefined"==typeof URL)return;const n=t.src,o=function(e){const t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],o=new ArrayBuffer(t.length),a=new Uint8Array(o);for(let i=0;i<t.length;i++)a[i]=t.charCodeAt(i);return new Blob([o],{type:n})}(n);t.src=URL.createObjectURL(o),e.e.fire("internalUpdate");const{buffer:a}=e,i=a.get(Oa)||{};i[t.src]=n,e.buffer.set(Oa,i)}(t,e),t.e.on(e,"mousedown touchstart",()=>{t.s.select(e)}))})}}Aa([x(":afterGetValueFromEditor")],qa.prototype,"onAfterGetValueFromEditor",null),Aa([x(":beforeSetElementValue")],qa.prototype,"onBeforeSetElementValue",null),Aa([x([":change",":afterInit",":changePlace"]),Y()],qa.prototype,"afterChange",null),b.add("imageProcessor",qa),y.prototype.image={dialogWidth:600,openOnDblClick:!0,editSrc:!0,useImageEditor:!0,editTitle:!0,editAlt:!0,editLink:!0,editSize:!0,editBorderRadius:!0,editMargins:!0,editClass:!0,availableClasses:[],editStyle:!0,editId:!0,editAlign:!0,showPreview:!0,selectImageAfterClose:!0};var Da=function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};let Na=class extends Z{className(){return"UIImageMainTab"}appendChildToContainer(){}constructor(e,t,n){super(e),this.state=t,this.handlers=n}render(){return'<div class="jodit-form__group &__editSrc">\n\t\t\t<label>~Src~</label>\n\t\t\t<div class="jodit-input_group">\n\t\t\t\t<input class="jodit-input &__imageSrc" type="text"/>\n\t\t\t\t<div class="jodit-input_group-buttons &__fixImage">\n\t\t\t\t\t\t<a class="jodit-button &__changeImage">*image*</a>\n\t\t\t\t\t\t<a class="jodit-button &__editImage">*crop*</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="jodit-form__group &__editTitle">\n\t\t\t<label>~Title~</label>\n\t\t\t<input type="text" class="jodit-input &__imageTitle"/>\n\t\t</div>\n\t\t<div class="jodit-form__group &__editAlt">\n\t\t\t<label>~Alternative~</label>\n\t\t\t<input type="text" class="jodit-input &__imageAlt"/>\n\t\t</div>\n\t\t<div class="jodit-form__group &__editLink">\n\t\t\t<label>~Link~</label>\n\t\t\t<input type="text" class="jodit-input &__imageLink"/>\n\t\t</div>\n\t\t<div class="jodit-form__group &__editLinkTarget">\n\t\t\t<label class="jodit_vertical_middle">\n\t\t\t\t<input type="checkbox" class="jodit-checkbox &__imageLinkOpenInNewTab"/>\n\t\t\t\t<span>~Open link in new tab~</span>\n\t\t\t</label>\n\t\t</div>'}async onStateImageSrcChange(){this.getElm("imageSrc").value=this.state.values.imageSrc}onImageSrcChange(){this.state.values.imageSrc=this.getElm("imageSrc").value}onEditImageClick(e){this.handlers.openImageEditor(),e.stopPropagation()}onChangeImageClick(e){this.handlers.openImagePopup(this.getElm("changeImage")),e.stopPropagation()}onStateTitleChange(){this.getElm("imageTitle").value=this.state.values.imageTitle}onTitleChange(){this.state.values.imageTitle=this.getElm("imageTitle").value}onStateAltChange(){this.getElm("imageAlt").value=this.state.values.imageAlt}onAltChange(){this.state.values.imageAlt=this.getElm("imageAlt").value}onStateImageLinkChange(){this.getElm("imageLink").value=this.state.values.imageLink}onImageLinkChange(){this.state.values.imageLink=this.getElm("imageLink").value}onStateImageLinkOpenInNewTabChange(){this.getElm("imageLinkOpenInNewTab").checked=this.state.values.imageLinkOpenInNewTab}onImageLinkOpenInNewTabChange(){this.state.values.imageLinkOpenInNewTab=this.getElm("imageLinkOpenInNewTab").checked}hideFieldByOptions(){const e=this.j.o,t=e.image;[["editSrc","editSrc"],["editTitle","editTitle"],["editAlt","editAlt"],["editLink","editLink"],["editLink","editLinkTarget"],["useImageEditor","editImage"]].forEach(([e,n])=>{const o=this.getElm(n);F(o,"display",t[e]?null:"none")});const n=this.getElm("changeImage"),o=Boolean(e.filebrowser.ajax.url||e.uploader.url);F(n,"display",o?null:"none");const a=this.getElm("editImage"),i=Boolean(e.filebrowser.ajax.url)&&t.useImageEditor;F(a,"display",i?null:"none");const r=this.getElm("fixImage");F(r,"display",o||i?null:"none")}};Da([x("state.values.imageSrc")],Na.prototype,"onStateImageSrcChange",null),Da([x("imageSrc:change")],Na.prototype,"onImageSrcChange",null),Da([x("editImage:click")],Na.prototype,"onEditImageClick",null),Da([x("changeImage:click")],Na.prototype,"onChangeImageClick",null),Da([x("state.values.imageTitle")],Na.prototype,"onStateTitleChange",null),Da([x("imageTitle:change")],Na.prototype,"onTitleChange",null),Da([x("state.values.imageAlt")],Na.prototype,"onStateAltChange",null),Da([x("imageAlt:change")],Na.prototype,"onAltChange",null),Da([x("state.values.imageLink")],Na.prototype,"onStateImageLinkChange",null),Da([x("imageLink:change")],Na.prototype,"onImageLinkChange",null),Da([x("state.values.imageLinkOpenInNewTab")],Na.prototype,"onStateImageLinkOpenInNewTabChange",null),Da([x("imageLinkOpenInNewTab:change")],Na.prototype,"onImageLinkOpenInNewTabChange",null),Da([B("ready")],Na.prototype,"hideFieldByOptions",null),Na=Da([X],Na);const Pa=e=>/^[-+]?[0-9.]+(px)?$/.test(e.toString())?parseFloat(e.toString()):e,za=e=>K(e)?e?e+"px":e.toString():(e=_(e),/^[0-9]+$/.test(e)?e+"px":e);var Ra=function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};let Fa=class extends Q{className(){return"UIImagePositionTab"}constructor(e,t,n){super(e,{availableClasses:e.o.image.availableClasses}),this.state=t,this.handlers=n}render({availableClasses:e}){return`<div class="jodit-form__group &__editMargins">\n\t\t\t<label>~Margins~</label>\n\t\t\t<div class="jodit-grid jodit_vertical_middle">\n\t\t\t\t<input class="jodit_col-lg-1-5 jodit-input &__marginTop" type="text" placeholder="~top~"/>\n\t\t\t\t<a style="text-align: center;" class="jodit-properties__lock jodit_col-lg-1-5 &__lockMargin">*lock*</a>\n\t\t\t\t<input disabled="disabled" class="jodit_col-lg-1-5 jodit-input &__marginRight" type="text" placeholder="~right~"/>\n\t\t\t\t<input disabled="disabled" class="jodit_col-lg-1-5 jodit-input &__marginBottom" type="text" placeholder="~bottom~"/>\n\t\t\t\t<input disabled="disabled" class="jodit_col-lg-1-5 jodit-input &__marginLeft" type="text" placeholder="~left~"/>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="jodit-form__group &__editAlign">\n\t\t\t<label>~Align~</label>\n\t\t\t<select class="jodit-select &__align">\n\t\t\t\t<option value="">~--Not Set--~</option>\n\t\t\t\t<option value="left">~Left~</option>\n\t\t\t\t<option value="center">~Center~</option>\n\t\t\t\t<option value="right">~Right~</option>\n\t\t\t</select>\n\t\t</div>\n\t\t<div class="jodit-form__group &__editStyle">\n\t\t\t<label>~Styles~</label>\n\t\t\t<input type="text" class="jodit-input &__style"/>\n\t\t</div>\n\t\t<div class="jodit-form__group &__editClass">\n\t\t\t<label>~Classes~</label>\n\t\t\t${(()=>{const t=[];return e&&e.length>0?(t.push('<select class="jodit-input jodit-select &__classes">'),e.forEach(e=>{S(e)?t.push(`<option value="${e}">${e}</option>`):t.push(`<option value="${e[0]}">${e[1]}</option>`)}),t.push("</select>")):t.push('<input type="text" class="jodit-input &__classes"/>'),t.join("")})()}\n\t\t</div>\n\t\t<div class="jodit-form__group &__editId">\n\t\t\t<label>Id</label>\n\t\t\t<input type="text" class="jodit-input &__id"/>\n\t\t</div>\n\t\t<div\n\t\t\tclass="jodit-form__group &__editBorderRadius"\n\t\t>\n\t\t\t<label>~Border radius~</label>\n\t\t\t<input type="number" class="jodit-input &__borderRadius"/>\n\t\t</div>`}onStateAlignChange(){this.getElm("align").value=this.state.values.align}onChangeAlign(){const e=this.getElm("align");this.state.values.align=e.value}onStateValuesBorderRadiusChange(){this.getElm("borderRadius").value=this.state.values.borderRadius.toString()}onChangeBorderRadius(){const e=this.getElm("borderRadius");this.state.values.borderRadius=parseFloat(e.value)}onStateValuesIdChange(){this.getElm("id").value=this.state.values.id}onChangeId(){const e=this.getElm("id");this.state.values.id=e.value}onStateValuesStyleChange(){this.getElm("style").value=this.state.values.style}onChangeStyle(){const e=this.getElm("style");this.state.values.style=e.value}onStateValuesClassesChange(){this.getElm("classes").value=this.state.values.classes}onChangClasses(){const e=this.getElm("classes");this.state.values.classes=e.value}onLockMarginClick(e){this.state.marginIsLocked=!this.state.marginIsLocked,e.preventDefault()}onChangeMarginIsLocked(){const e=this.getElm("marginBottom"),t=this.getElm("marginRight"),n=this.getElm("marginLeft"),o=this.getElm("lockMargin");if([t,e,n].forEach(e=>{I(e,"disabled",this.state.marginIsLocked||null)}),o.innerHTML=w.get(this.state.marginIsLocked?"lock":"unlock"),this.state.marginIsLocked){const e=this.state.values.marginTop;this.state.values.marginRight=e,this.state.values.marginBottom=e,this.state.values.marginLeft=e}}onStateValuesMarginChange(){const e=this.getElm("marginTop"),t=this.getElm("marginRight"),n=this.getElm("marginBottom"),o=this.getElm("marginLeft");e.value=this.state.values.marginTop.toString(),t.value=this.state.values.marginRight.toString(),n.value=this.state.values.marginBottom.toString(),o.value=this.state.values.marginLeft.toString()}onChangeMargin(){const e=this.getElm("marginTop"),t=this.getElm("marginRight"),n=this.getElm("marginBottom"),o=this.getElm("marginLeft");this.state.values.marginTop=Pa(e.value),this.state.marginIsLocked?(this.state.values.marginRight=this.state.values.marginTop,this.state.values.marginBottom=this.state.values.marginTop,this.state.values.marginLeft=this.state.values.marginTop):(this.state.values.marginRight=Pa(t.value),this.state.values.marginBottom=Pa(n.value),this.state.values.marginLeft=Pa(o.value))}hideFieldByOptions(){const e=this.j.o.image;[["editMargins","editMargins"],["editAlign","editAlign"],["editStyle","editStyle"],["editClass","editClass"],["editId","editId"],["editBorderRadius","editBorderRadius"]].forEach(([t,n])=>{const o=this.getElm(n);F(o,"display",e[t]?null:"none")})}};Ra([B("ready"),x("state.values.align")],Fa.prototype,"onStateAlignChange",null),Ra([x("align:change")],Fa.prototype,"onChangeAlign",null),Ra([B("ready"),x("state.values.borderRadius")],Fa.prototype,"onStateValuesBorderRadiusChange",null),Ra([x("borderRadius:change")],Fa.prototype,"onChangeBorderRadius",null),Ra([B("ready"),x("state.values.id")],Fa.prototype,"onStateValuesIdChange",null),Ra([x("id:change")],Fa.prototype,"onChangeId",null),Ra([B("ready"),x("state.values.style")],Fa.prototype,"onStateValuesStyleChange",null),Ra([x("style:change")],Fa.prototype,"onChangeStyle",null),Ra([B("ready"),x("state.values.classes")],Fa.prototype,"onStateValuesClassesChange",null),Ra([x("classes:change")],Fa.prototype,"onChangClasses",null),Ra([x("lockMargin:click")],Fa.prototype,"onLockMarginClick",null),Ra([B("ready"),x("state.marginIsLocked")],Fa.prototype,"onChangeMarginIsLocked",null),Ra([B("ready"),x(["state.values.marginTop","state.values.marginRight","state.values.marginBottom","state.values.marginLeft"])],Fa.prototype,"onStateValuesMarginChange",null),Ra([x(["marginTop:change","marginRight:change","marginBottom:change","marginLeft:change"])],Fa.prototype,"onChangeMargin",null),Ra([B("ready")],Fa.prototype,"hideFieldByOptions",null),Fa=Ra([X],Fa);var Ha=function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};let Wa=class extends Z{className(){return"UIImagePropertiesForm"}appendChildToContainer(){}getElm(e){const t=super.getElm(e);if(t)return t;for(const n of this.elements){const t=n.getElm(e);if(t)return t}return null}constructor(e,t,n,o){super(e),this.state=t,this.handlers=o,this.__mainTab=new Na(this.jodit,this.state,this.handlers),this.__positionTab=new Fa(this.jodit,this.state,this.handlers),this.getElm("tabsBox").appendChild(ee(e,[{name:"Image",content:this.__mainTab},{name:"Advanced",content:this.__positionTab}],n)),this.setMod("lock-size",this.state.sizeIsLocked),this.append(this.__mainTab).append(this.__positionTab)}render(){return`<form>\n\t\t<div class="jodit-grid jodit-grid_xs-column">\n\t\t\t<div class="jodit_col-lg-2-5 jodit_col-xs-5-5">\n\t\t\t\t<div class="&__view-box">\n\t\t\t\t\t<div class="&__imageView">\n\t\t\t\t\t\t<img class="&__imageViewSrc" src="" alt=""/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="jodit-form__group &__imageSizes">\n\t\t\t\t\t\t<input type="text" class="jodit-input &__imageWidth"/>\n\t\t\t\t\t\t<a class="&__lockSize">${w.get("lock")}</a>\n\t\t\t\t\t\t<input type="text" class="&__imageHeight jodit-input"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="jodit_col-lg-3-5 jodit_col-xs-5-5 &__tabsBox"></div>\n\t\t</div>\n\t</form>`}onChangeSizeIsLocked(){const e=this.getElm("lockSize"),t=this.getElm("imageWidth");e.innerHTML=w.get(this.state.sizeIsLocked?"lock":"unlock"),this.setMod("lock-size",this.state.sizeIsLocked),this.j.e.fire(t,"change")}onLockSizeClick(){this.state.sizeIsLocked=!this.state.sizeIsLocked}onStateValuesSizeChange(){const e=this.getElm("imageWidth"),t=this.getElm("imageHeight");e!==this.j.od.activeElement&&(e.value=this.state.values.imageWidth.toString()),t!==this.j.od.activeElement&&(t.value=this.state.values.imageHeight.toString())}onImageWidthChange(e){const t=this.getElm("imageWidth"),n=this.getElm("imageHeight");if(!this.state.sizeIsLocked||!te(t.value)||!te(n.value))return this.state.values.imageWidth=t.value,void(this.state.values.imageHeight=n.value);const o=parseFloat(t.value),a=parseFloat(n.value);e.target===t?(this.state.values.imageWidth=o,this.state.values.imageHeight=Math.round(o/this.state.ratio)):(this.state.values.imageWidth=Math.round(a*this.state.ratio),this.state.values.imageHeight=a)}onStateValuesImageSrcChange(){const{imageSrc:e}=this.state.values;if(!e)return;const t=this.getElm("imageViewSrc");I(t,"src",e);const n=new Image;n.src=e,this.state.image=n}hideFieldByOptions(){const e=this.j.o.image;[["editSize","imageSizes"],["showPreview","imageView"]].forEach(([t,n])=>{const o=this.getElm(n);F(o,"display",e[t]?null:"none")})}};async function Va(e,t){const{sourceImage:n,values:o}=t;return function(e,t){e.style.cssFloat&&-1!==["left","right"].indexOf(e.style.cssFloat.toLowerCase())?t.align=F(e,"float"):"block"===F(e,"display")&&"auto"===e.style.marginLeft&&"auto"===e.style.marginRight?t.align="center":t.align=""}(n,o),o.borderRadius=parseInt(n.style.borderRadius||"0",10)||0,o.id=I(n,"id")||"",o.imageTitle=I(n,"title")||"",o.imageAlt=I(n,"alt")||"",o.style=I(n,"style")||"",o.classes=(I(n,"class")||"").replace(/jodit_focused_image[\s]*/,""),function(e,t,n){let o=!0,a=!1;["marginTop","marginRight","marginBottom","marginLeft"].forEach(n=>{let i=e.style.getPropertyValue(se(n));if(!i)return a=!0,void(t[n]=0);/^[0-9]+(px)?$/.test(i)&&(i=parseInt(i,10)),t[n]=i,(a&&t[n]||o&&"marginTop"!==n&&t[n]!==t.marginTop)&&(o=!1)}),n.marginIsLocked=o}(n,o,t),function(e,t,n){const o=v.closest(e.sourceImage,"a",t.editor);o?(n.imageLink=I(o,"href")||"",n.imageLinkOpenInNewTab="_blank"===I(o,"target")):(n.imageLink="",n.imageLinkOpenInNewTab=!1)}(t,e,o),o.imageSrc=I(n,"src")||"",async function(e,t,n){await e.decode();const o=F(e,"width",!0)||I(e,"width")||!1,a=F(e,"height",!0)||I(e,"height")||!1;t.imageWidth=!1!==o?Pa(o):e.offsetWidth||e.naturalWidth,te(t.imageWidth)?t.imageHeight=!1!==a?Pa(a):e.offsetHeight||e.naturalHeight:t.imageHeight=a||"";const{imageWidth:i,imageHeight:r}=t,s=parseFloat(i.toString());if(!te(i)||!te(r))return void(n.sizeIsLocked=!1);if(!1===a)return t.imageHeight=Math.round(s/n.ratio),void(n.sizeIsLocked=!0);const l=parseFloat(r.toString());n.sizeIsLocked=Math.abs(s-l*n.ratio)<1}(n,o,t)}function $a(e,t,n){const{style:o,imageSrc:a,borderRadius:i,imageTitle:r,imageAlt:s,imageLink:l,imageWidth:c,imageHeight:d,marginTop:u,marginRight:h,marginBottom:p,marginLeft:m,imageLinkOpenInNewTab:g,align:f,classes:y,id:b}=t.values,w=e.o;w.image.editStyle&&I(n,"style",o||null),a?(I(n,"src",a),n.style.borderRadius=i?i+"px":"",I(n,"title",r||null),I(n,"alt",s||null),function(e,t,n,o){let a=v.closest(t,"a",e.editor);n?(a||(a=v.wrap(t,"a",e.createInside)),I(a,"href",n),I(a,"target",o?"_blank":null)):a&&a.parentNode&&a.parentNode.replaceChild(t,a)}(e,n,l,g),function(e,t,n,o){if(t!==e.offsetWidth||n!==e.offsetHeight){const a=t?za(t):null;let i=n?za(n):null;F(e,{width:a,height:a&&o?null:i}),I(e,"width",a&&te(t)&&I(e,"width")?a:null),I(e,"width")&&!o||(i=null),I(e,"height",i)}}(n,c,d,t.sizeIsLocked),e.o.image.editMargins&&function(e,t,n,o,a,i,r){const s=[t,n,o,a],l=(e,t)=>{const n=F(i,e),o=za(t);n.toString()!==o.toString()&&F(i,e,o)};if(r)l("margin",t);else{const e=["margin-top","margin-right","margin-bottom","margin-left"];s.forEach((t,n)=>{const o=e[n];l(o,t)})}}(0,u,h,p,m,n,t.marginIsLocked),w.image.editClass&&I(n,"class",y||null),w.image.editId&&I(n,"id",b||null),w.image.editAlign&&le(n,f)):v.safeRemove(n)}Ha([B("ready"),x("state.sizeIsLocked")],Wa.prototype,"onChangeSizeIsLocked",null),Ha([x("lockSize:click")],Wa.prototype,"onLockSizeClick",null),Ha([B("ready"),x(["state.values.imageWidth","state.values.imageHeight"])],Wa.prototype,"onStateValuesSizeChange",null),Ha([x(["imageWidth:change","imageHeight:change","imageWidth:keydown","imageHeight:keydown","imageWidth:mousedown","imageHeight:mousedown","imageWidth:paste","imageHeight:paste"]),Y()],Wa.prototype,"onImageWidthChange",null),Ha([B("ready"),x("state.values.imageSrc")],Wa.prototype,"onStateValuesImageSrcChange",null),Ha([B("ready")],Wa.prototype,"hideFieldByOptions",null),Wa=Ha([X],Wa);var Ya=function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};class Ua extends E{constructor(){super(...arguments),this.state={image:new Image,sourceImage:new Image,get ratio(){const{naturalWidth:e,naturalHeight:t}=this.image;return e/t||1},sizeIsLocked:!0,marginIsLocked:!0,values:{style:"",imageSrc:"",borderRadius:0,imageTitle:"",imageAlt:"",imageLink:"",imageLinkOpenInNewTab:!1,imageWidth:0,imageHeight:0,marginTop:0,marginRight:0,marginBottom:0,marginLeft:0,classes:"",id:"",align:""}},this.activeTabState={activeTab:"Image"}}get form(){return new Wa(this.j,this.state,this.activeTabState,{openImageEditor:()=>function(e,t){const n=I(t.image,"src")||"",o=e.c.element("a"),a=()=>{o.host===location.host||e.confirm("You can only edit your own images. Download this image on the host?",n=>{n&&e.uploader&&e.uploader.uploadRemoteImage(o.href.toString(),n=>{e.alert("The image has been successfully uploaded to the host!",()=>{S(n.newfilename)&&(t.values.imageSrc=n.baseurl+n.newfilename)})},t=>{e.alert("There was an error loading %s",t.message)})})};o.href=n,e.filebrowser.dataProvider.getPathByUrl(o.href.toString()).then(a=>{ne.call(e.filebrowser,o.href,a.name,a.path,a.source,()=>{const e=(new Date).getTime();t.values.imageSrc=n+(-1!==n.indexOf("?")?"":"?")+"&_tmp="+e.toString()},t=>{e.alert(t.message)})}).catch(t=>{e.alert(t.message,a)})}(this.j,this.state),openImagePopup:e=>function(e,t,n,o){const a=new oe(t),i=()=>{a.close(),a.destruct()};a.setContent(ae(e,{upload:e=>{e.files&&e.files.length&&(n.values.imageSrc=e.baseurl+e.files[0]),i()},filebrowser:async e=>{e&&ie(e.files)&&e.files.length&&(n.values.imageSrc=e.files[0],i())}},n.image,i)).open(()=>re(o))}(this.j,this.dialog,this.state,e)})}get dialog(){const{j:e}=this,t=e.dlg({minWidth:Math.min(400,screen.width),minHeight:590,buttons:["fullsize","dialog.close"]}),n=this.__buttons;return n.check.onAction(()=>{$a(e,this.state,this.state.sourceImage),e.synchronizeValues(),t.close()}),n.remove.onAction(()=>{e.s.removeNode(this.state.sourceImage),t.close()}),n.cancel.onAction(()=>{t.close()}),t.setHeader(e.i18n("Image properties")),t.setContent(this.form),t.setFooter([[n.cancel,n.remove],n.check]),e.e.on(t,"afterClose",()=>{this.state.image.parentNode&&e.o.image.selectImageAfterClose&&e.s.select(this.state.sourceImage)}),t.setSize(e.o.image.dialogWidth),de(e,t.container),t}get __buttons(){const{j:e}=this;return{check:ue(e,"ok","Apply","primary"),remove:ue(e,"bin","Delete"),cancel:ue(e,"cancel","Cancel")}}open(){return this.activeTabState.activeTab="Image",this.__lock(),this.dialog.open().setModal(!0).setPosition(),this.async.promise((e,t)=>Va(this.j,this.state).then(e,t)).catch(e=>{he(e)||this.dialog.message.error(e.message)}).finally(()=>this.__unlock()),!1}__lock(){this.dialog.lock(),this.form.setMod("lock",!0),Object.values(this.__buttons).forEach(e=>e.state.disabled=!0)}__unlock(){this.dialog.unlock(),this.form.setMod("lock",!1),Object.values(this.__buttons).forEach(e=>e.state.disabled=!1)}afterInit(e){const t=this;e.e.on("afterConstructor changePlace",()=>{e.e.off(e.editor,".imageproperties").on(e.editor,"dblclick.imageproperties",n=>{const o=n.target;if(v.isTag(o,"img"))if(e.o.image.openOnDblClick){if(!1===this.j.e.fire("openOnDblClick",o))return;t.state.sourceImage=o,t.state.image=o.cloneNode(!0),e.o.readonly||(n.stopImmediatePropagation(),n.preventDefault(),t.open())}else n.stopImmediatePropagation(),e.s.select(o)})}).on("openImageProperties.imageproperties",e=>{t.state.sourceImage=e,this.state.image=e.cloneNode(!0),this.open()})}async onStateValuesImageSrcChange(){const{image:e,values:t}=this.state;if(e.src)try{if(this.__lock(),await e.decode(),this.state.sizeIsLocked&&te(t.imageWidth)){const e=parseFloat(t.imageWidth.toString());t.imageHeight=Math.round(e/this.state.ratio)}this.j.e.fire("updateImageProperties.imageproperties",e)}catch(n){this.j.alert(n.message)}finally{this.__unlock()}}beforeDestruct(e){var t,n,o;Object.values(null!==(t=R(this,"__buttons"))&&void 0!==t?t:{}).forEach(e=>e.destruct()),null===(n=R(this,"dialog"))||void 0===n||n.destruct(),null===(o=R(this,"form"))||void 0===o||o.destruct(),e.e.off(e.editor,".imageproperties").off(".imageproperties")}}Ya([ce],Ua.prototype,"form",null),Ya([ce],Ua.prototype,"dialog",null),Ya([ce],Ua.prototype,"__buttons",null),Ya([x("state.image")],Ua.prototype,"onStateValuesImageSrcChange",null),b.add("imageProperties",Ua);const Ga=(e,t)=>`${v.isCell(t)?"padding":"margin"}${"rtl"===e?"Right":"Left"}`;w.set("indent",'<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox="0 0 1792 1792"> <path d="M352 832q0 14-9 23l-288 288q-9 9-23 9-13 0-22.5-9.5t-9.5-22.5v-576q0-13 9.5-22.5t22.5-9.5q14 0 23 9l288 288q9 9 9 23zm1440 480v192q0 13-9.5 22.5t-22.5 9.5h-1728q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h1728q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5h-1088q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5h-1088q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5h-1728q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h1728q13 0 22.5 9.5t9.5 22.5z"/> </svg> ').set("outdent",'<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox="0 0 1792 1792"> <path d="M384 544v576q0 13-9.5 22.5t-22.5 9.5q-14 0-23-9l-288-288q-9-9-9-23t9-23l288-288q9-9 23-9 13 0 22.5 9.5t9.5 22.5zm1408 768v192q0 13-9.5 22.5t-22.5 9.5h-1728q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h1728q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5h-1088q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5h-1088q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h1088q13 0 22.5 9.5t9.5 22.5zm0-384v192q0 13-9.5 22.5t-22.5 9.5h-1728q-13 0-22.5-9.5t-9.5-22.5v-192q0-13 9.5-22.5t22.5-9.5h1728q13 0 22.5 9.5t9.5 22.5z"/> </svg> '),y.prototype.controls.indent={tooltip:"Increase Indent"},y.prototype.controls.outdent={isDisabled:e=>{const t=e.s.current();if(t){const n=v.closest(t,v.isBlock,e.editor);if(n){const t=Ga(e.o.direction,n);return!n.style[t]||parseInt(n.style[t],10)<=0}}return!0},tooltip:"Decrease Indent"},y.prototype.indentMargin=10;const Ja=(e,t,n,o)=>{if(!t)return;if(e.has(t))return;const a=Ga(n.o.direction,t);e.add(t);let i=t.style[a]?parseInt(t.style[a],10):0;i+=n.o.indentMargin*("outdent"===o?-1:1),t.style[a]=i>0?i+"px":"",I(t,"style")||I(t,"style",null)};b.add("indent",function(e){e.registerButton({name:"indent",group:"indent"}).registerButton({name:"outdent",group:"indent"});const t=t=>{const n=new Set,{enter:o,enterBlock:a}=e.o,i=o.toLowerCase()===pe,r=e.s.current();if(i&&e.s.isCollapsed()&&r){const o=v.wrapNextInline(r,a,e);return Ja(n,o,e,t),!1}return e.s.eachSelection(r=>{e.s.save();let s=!!r&&v.up(r,v.isBlock,e.editor);if(!s&&r&&(s=me(i?v.wrapNextInline:v.wrapInline,r,i?a:o.toLowerCase(),e)),!s)return e.s.restore(),!1;Ja(n,s,e,t),e.s.restore()}),e.synchronizeValues(),!1};e.registerCommand("indent",{exec:t,hotkeys:["ctrl+]","cmd+]"]}),e.registerCommand("outdent",{exec:t,hotkeys:["ctrl+[","cmd+["]})});w.set("justify",'<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox="0 0 1792 1792"> <path d="M1792 1344v128q0 26-19 45t-45 19h-1664q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1664q26 0 45 19t19 45zm0-384v128q0 26-19 45t-45 19h-1664q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1664q26 0 45 19t19 45zm0-384v128q0 26-19 45t-45 19h-1664q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1664q26 0 45 19t19 45zm0-384v128q0 26-19 45t-45 19h-1664q-26 0-45-19t-19-45v-128q0-26 19-45t45-19h1664q26 0 45 19t19 45z"/> </svg> '),y.prototype.controls.align={name:"left",tooltip:"Align",update(e,t){const n=t.control,o=e.s.current();if(o){const a=v.closest(o,v.isBlock,e.editor)||e.editor;let i=F(a,"text-align").toString();n.defaultValue&&-1!==n.defaultValue.indexOf(i)&&(i="left");const{list:r,data:s}=n;s&&s.currentValue!==i&&r&&(ge(r)?r[i]:r.includes(i))&&(e.o.textIcons||"select"===n.component?t.state.text=i:t.state.icon.name=i,s.currentValue=i)}},isActive:(e,t)=>{const n=e.s.current();if(!n||!t.control.defaultValue)return!1;const o=v.closest(n,v.isBlock,e.editor)||e.editor;return-1===t.control.defaultValue.indexOf(F(o,"text-align").toString())},defaultValue:["left","start","inherit"],data:{currentValue:"left"},list:["center","left","right","justify"]},y.prototype.controls.center={command:"justifyCenter",css:{"text-align":"center"},tooltip:"Align Center"},y.prototype.controls.justify={command:"justifyFull",css:{"text-align":"justify"},tooltip:"Align Justify"},y.prototype.controls.left={command:"justifyLeft",css:{"text-align":"left"},tooltip:"Align Left"},y.prototype.controls.right={command:"justifyRight",css:{"text-align":"right"},tooltip:"Align Right"},b.add("justify",function(e){e.registerButton({name:"align",group:"indent"});const t=t=>(e.s.focus(),e.s.eachSelection(n=>{if(!n)return;let o=v.up(n,v.isBlock,e.editor);o||(o=v.wrapInline(n,e.o.enterBlock,e)),fe(t,o)}),!1);e.registerCommand("justifyfull",t),e.registerCommand("justifyright",t),e.registerCommand("justifyleft",t),e.registerCommand("justifycenter",t)});y.prototype.defaultLineHeight=null,w.set("line-height",'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"> <path d="M5.09668 6.99707H7.17358L4.17358 3.99707L1.17358 6.99707H3.09668V17.0031H1.15881L4.15881 20.0031L7.15881 17.0031H5.09668V6.99707Z"/> <path d="M22.8412 7H8.84119V5H22.8412V7Z"/> <path d="M22.8412 11H8.84119V9H22.8412V11Z"/> <path d="M8.84119 15H22.8412V13H8.84119V15Z"/> <path d="M22.8412 19H8.84119V17H22.8412V19Z"/> </svg> '),y.prototype.controls.lineHeight={command:"applyLineHeight",tags:["ol"],tooltip:"Line height",list:[1,1.1,1.2,1.3,1.4,1.5,2],exec:(e,t,{control:n})=>f(e,t,{control:n},e=>e)};const Xa=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":" "}},Symbol.toStringTag,{value:"Module"})),Za=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":"Vka ry"}},Symbol.toStringTag,{value:"Module"})),Ka=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":"Zeilenhhe"}},Symbol.toStringTag,{value:"Module"})),Qa=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":"Altura de la lnea"}},Symbol.toStringTag,{value:"Module"})),ei=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":" "}},Symbol.toStringTag,{value:"Module"})),ti=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":"Rivin korkeus"}},Symbol.toStringTag,{value:"Module"})),ni=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":"Hauteur de ligne"}},Symbol.toStringTag,{value:"Module"})),oi=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":" "}},Symbol.toStringTag,{value:"Module"})),ai=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":"Vonal magassga"}},Symbol.toStringTag,{value:"Module"})),ii=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":"Tinggi baris"}},Symbol.toStringTag,{value:"Module"})),ri=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":"Altezza linea"}},Symbol.toStringTag,{value:"Module"})),si=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":""}},Symbol.toStringTag,{value:"Module"})),li=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":" "}},Symbol.toStringTag,{value:"Module"})),ci=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":" "}},Symbol.toStringTag,{value:"Module"})),di=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":"Lijnhoogte"}},Symbol.toStringTag,{value:"Module"})),ui=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":"Wysoko linii"}},Symbol.toStringTag,{value:"Module"})),hi=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":"Altura da linha"}},Symbol.toStringTag,{value:"Module"})),pi=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":" "}},Symbol.toStringTag,{value:"Module"})),mi=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":"izgi ykseklii"}},Symbol.toStringTag,{value:"Module"})),gi=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":" "}},Symbol.toStringTag,{value:"Module"})),fi=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":""}},Symbol.toStringTag,{value:"Module"})),yi=Object.freeze(Object.defineProperty({__proto__:null,default:{"Line height":""}},Symbol.toStringTag,{value:"Module"})),vi=Object.freeze(Object.defineProperty({__proto__:null,ar:Xa,cs_cz:Za,de:Ka,es:Qa,fa:ei,fi:ti,fr:ni,he:oi,hu:ai,id:ii,it:ri,ja:si,ko:li,mn:ci,nl:di,pl:ui,pt_br:hi,ru:pi,tr:mi,ua:gi,zh_cn:fi,zh_tw:yi},Symbol.toStringTag,{value:"Module"}));class bi extends E{constructor(e){super(e),this.buttons=[{name:"lineHeight",group:"font"}],H(vi)}afterInit(e){F(e.editor,{lineHeight:e.o.defaultLineHeight}),e.registerCommand("applyLineHeight",this.applyLineHeight)}applyLineHeight(e,t,n){const{s:o,createInside:a,editor:i,o:r}=this.j;let s;o.isFocused()||o.focus(),o.save();const l=e=>{let t=v.closest(e,v.isBlock,i);t||(t=v.wrap(e,r.enter,a));const o=F(t,"lineHeight");void 0===s&&(s=o.toString()!==n.toString()),F(t,"lineHeight",s?n:null)};try{if(o.isCollapsed()){const e=a.fake();o.insertNode(e,!1,!1),l(e),v.safeRemove(e)}else o.eachSelection(l)}finally{o.restore()}}beforeDestruct(e){F(e.editor,{lineHeight:null})}}!function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);i>3&&r&&Object.defineProperty(t,n,r)}([ye],bi.prototype,"applyLineHeight",null),b.add("lineHeight",bi),y.prototype.mediaFakeTag="jodit-media",y.prototype.mediaInFakeBlock=!0,y.prototype.mediaBlocks=["video","audio"],b.add("media",function(e){const t="jodit_fake_wrapper",{mediaFakeTag:n,mediaBlocks:o,mediaInFakeBlock:a}=e.options;a&&e.e.on("afterGetValueFromEditor",e=>{const o=new RegExp(`<${n}[^>]+data-${t}[^>]+>([^]+?)</${n}>`,"ig");o.test(e.value)&&(e.value=e.value.replace(o,"$1"))}).on("change afterInit afterSetMode changePlace",e.async.debounce(()=>{e.isDestructed||e.getMode()===W||G(o.join(","),e.editor).forEach(o=>{J(o,t)||(J(o,t,!0),(o=>{if(o.parentNode&&I(o.parentNode,"data-jodit_iframe_wrapper"))o=o.parentNode;else{const a=e.createInside.element(n,{"data-jodit-temp":1,contenteditable:!1,draggable:!0,[`data-${t}`]:1});I(a,"style",I(o,"style")),a.style.display="inline-block"===o.style.display?"inline-block":"block",a.style.width=o.offsetWidth+"px",a.style.height=o.offsetHeight+"px",o.parentNode&&o.parentNode.insertBefore(a,o),a.appendChild(o),o=a}e.e.off(o,"mousedown.select touchstart.select").on(o,"mousedown.select touchstart.select",()=>{e.s.setCursorAfter(o)})})(o))})},e.defaultTimeout))});function wi(e,t,n){if(t.isInDestruct)return;(function(e){return Boolean(e&&"drop"===e.type)})(e)&&t.s.insertCursorAtPoint(e.clientX,e.clientY);const o=t.e.fire("beforePasteInsert",n);!Ie(o)&&(S(o)||K(o)||v.isNode(o))&&(n=o),S(n)&&(n=function(e){const t=(e=e.replace(/<meta[^>]+?>/g,"")).search(/<!--StartFragment-->/i);-1!==t&&(e=e.substring(t+20));const n=e.search(/<!--EndFragment-->/i);return-1!==n&&(e=e.substring(0,n)),e}(n)),t.s.insertHTML(n)}b.add("pasteStorage",class extends E{constructor(){super(...arguments),this.currentIndex=0,this.list=[],this.container=null,this.listBox=null,this.previewBox=null,this.dialog=null,this.paste=()=>{if(this.j.s.focus(),this.j.s.insertHTML(this.list[this.currentIndex]),0!==this.currentIndex){const e=this.list[0];this.list[0]=this.list[this.currentIndex],this.list[this.currentIndex]=e}this.dialog&&this.dialog.close(),this.j.synchronizeValues(),this.j.e.fire("afterPaste")},this.onKeyDown=e=>{let t=this.currentIndex;-1!==[ve,be,we].indexOf(e.key)&&(e.key===ve&&(0===t?t=this.list.length-1:t-=1),e.key===be&&(t===this.list.length-1?t=0:t+=1),e.key!==we?(t!==this.currentIndex&&this.selectIndex(t),e.stopImmediatePropagation(),e.preventDefault()):this.paste())},this.selectIndex=e=>{this.listBox&&Ee(this.listBox.childNodes).forEach((t,n)=>{t.classList.remove("jodit_active"),e===n&&this.previewBox&&(t.classList.add("jodit_active"),this.previewBox.innerHTML=this.list[e],t.focus())}),this.currentIndex=e},this.showDialog=()=>{this.list.length<2||(this.dialog||this.createDialog(),this.listBox&&(this.listBox.innerHTML=""),this.previewBox&&(this.previewBox.innerHTML=""),this.list.forEach((e,t)=>{const n=this.j.c.element("a");n.textContent=t+1+". "+e.replace(Se(),""),this.j.e.on(n,"keydown",this.onKeyDown),I(n,"href","#"),I(n,"data-index",t.toString()),I(n,"tab-index","-1"),this.listBox&&this.listBox.appendChild(n)}),this.dialog&&this.dialog.open(),this.j.async.setTimeout(()=>{this.selectIndex(0)},100))}}createDialog(){this.dialog=this.j.dlg();const e=ue(this.j,"paste","Paste","primary");e.onAction(this.paste);const t=ue(this.j,"","Cancel");t.onAction(this.dialog.close),this.container=this.j.c.div(),this.container.classList.add("jodit-paste-storage"),this.listBox=this.j.c.div(),this.previewBox=this.j.c.div(),this.container.appendChild(this.listBox),this.container.appendChild(this.previewBox),this.dialog.setHeader(this.j.i18n("Choose Content to Paste")),this.dialog.setContent(this.container),this.dialog.setFooter([e,t]),this.j.e.on(this.listBox,"click dblclick",e=>{const t=e.target;return v.isTag(t,"a")&&t.hasAttribute("data-index")&&this.selectIndex(parseInt(I(t,"-index")||"0",10)),"dblclick"===e.type&&this.paste(),!1})}afterInit(){this.j.e.off("afterCopy.paste-storage").on("pasteStorageList.paste-storage",()=>this.list.length).on("afterCopy.paste-storage",e=>{-1!==this.list.indexOf(e)&&this.list.splice(this.list.indexOf(e),1),this.list.unshift(e),this.list.length>5&&(this.list.length=5)}),this.j.registerCommand("showPasteStorage",{exec:this.showDialog,hotkeys:["ctrl+shift+v","cmd+shift+v"]})}beforeDestruct(){this.dialog&&this.dialog.destruct(),this.j.e.off(".paste-storage"),v.safeRemove(this.previewBox),v.safeRemove(this.listBox),v.safeRemove(this.container),this.container=null,this.listBox=null,this.previewBox=null,this.dialog=null,this.list=[]}}),y.prototype.askBeforePasteFromWord=!0,y.prototype.processPasteFromWord=!0,y.prototype.defaultActionOnPasteFromWord=null,y.prototype.pasteFromWordActionList=[{value:z,text:"Keep"},{value:_e,text:"Clean"},{value:ke,text:"Insert only Text"}];class Ei extends E{afterInit(e){}beforeDestruct(e){}processWordHTML(e,t,n){const{j:o}=this,{processPasteFromWord:a,askBeforePasteFromWord:i,defaultActionOnPasteFromWord:r,defaultActionOnPaste:s,pasteFromWordActionList:l}=o.o;return!(!a||!je(t))&&(i?function(e,t,n,o,a){if(!1===e.e.fire("beforeOpenPasteDialog",t,n,o,a))return;const i=e.confirm(`<div style="word-break: normal; white-space: normal">${e.i18n(t)}</div>`,e.i18n(n)),r=a.map(({text:t,value:n})=>ue(e,{text:t,name:t.toLowerCase(),tabIndex:0}).onAction(()=>{i.close(),o(n)}));i.e.one(i,"afterClose",()=>{e.s.isFocused()||e.s.focus()});const s=ue(e,{text:"Cancel",tabIndex:0}).onAction(()=>{i.close()});i.setFooter([...r,s]),r[0].focus(),r[0].state.variant="primary",e.e.fire("afterOpenPasteDialog",i,t,n,o,a)}(o,"The pasted content is coming from a Microsoft Word/Excel document. Do you want to keep the format or clean it up?","Word Paste Detected",o=>{this.insertFromWordByType(e,t,o,n)},l):this.insertFromWordByType(e,t,r||s,n),!0)}insertFromWordByType(e,t,n,o){var a;switch(n){case z:{t=Le(t);const e=null===(a=this.j.events)||void 0===a?void 0:a.fire("beautifyHTML",t);S(e)&&(t=e);break}case _e:t=Ce(t);break;case ke:t=N(Ce(t))}wi(e,this.j,t)}}Ei.requires=["paste"],function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);i>3&&r&&Object.defineProperty(t,n,r)}([x(":processHTML")],Ei.prototype,"processWordHTML",null),b.add("pasteFromWord",Ei),y.prototype.controls.preview={icon:"eye",command:"preview",mode:W+V,tooltip:"Preview"},b.add("preview",function(e){e.registerButton({name:"preview"}),e.registerCommand("preview",(t,n,o)=>{const a=e.dlg();a.setSize(1024,600).open("",e.i18n("Preview")).setModal(!0);const[,i]=Te(e,o,"px",a.getElm("content"));a.e.on(a,"afterClose",i)})});w.set("print",'<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox="0 0 1792 1792"> <path d="M448 1536h896v-256h-896v256zm0-640h896v-384h-160q-40 0-68-28t-28-68v-160h-640v640zm1152 64q0-26-19-45t-45-19-45 19-19 45 19 45 45 19 45-19 19-45zm128 0v416q0 13-9.5 22.5t-22.5 9.5h-224v160q0 40-28 68t-68 28h-960q-40 0-68-28t-28-68v-160h-224q-13 0-22.5-9.5t-9.5-22.5v-416q0-79 56.5-135.5t135.5-56.5h64v-544q0-40 28-68t68-28h672q40 0 88 20t76 48l152 152q28 28 48 76t20 88v256h64q79 0 135.5 56.5t56.5 135.5z"/> </svg> '),y.prototype.controls.print={exec:e=>{const t=e.create.element("iframe");Object.assign(t.style,{position:"fixed",right:0,bottom:0,width:0,height:0,border:0}),xe(e,y).appendChild(t);const n=()=>{e.e.off(e.ow,"mousemove",n),v.safeRemove(t)},o=t.contentWindow;if(o){e.e.on(o,"onbeforeunload onafterprint",n).on(e.ow,"mousemove",n),e.o.iframe?(e.e.fire("generateDocumentStructure.iframe",o.document,e),o.document.body.innerHTML=e.value):(o.document.write('<!doctype html><html lang="'+Be(e.o.language)+'"><head><title></title></head><style>'+function(e){const t=(e,t=e.ownerDocument.styleSheets)=>Ee(t).map(e=>{try{return Ee(e.cssRules)}catch(t){}return[]}).flat().filter(t=>{try{return Boolean(t&&e.matches(t.selectorText))}catch(n){}return!1});class n{constructor(n,o,a){this.css={};const i=a||{},r=t=>{const n=t.selectorText.split(",").map(e=>e.trim()).sort().join(",");!1===Boolean(this.css[n])&&(this.css[n]={});const o=t.style.cssText.split(/;(?![A-Za-z0-9])/);for(let a=0;a<o.length;a++){if(!o[a])continue;const t=o[a].split(":");t[0]=t[0].trim(),t[1]=t[1].trim(),this.css[n][t[0]]=t[1].replace(/var\(([^)]+)\)/g,(t,n)=>{const[o,a]=n.split(",");return(e.ew.getComputedStyle(e.editor).getPropertyValue(o.trim())||a||t).trim()})}};(()=>{const a=n.innerHeight,s=o.createTreeWalker(e.editor,NodeFilter.SHOW_ELEMENT,()=>NodeFilter.FILTER_ACCEPT);for(;s.nextNode();){const e=s.currentNode;if(e.getBoundingClientRect().top<a||i.scanFullPage){const n=t(e);if(n)for(let e=0;e<n.length;e++)r(n[e])}}})()}generateCSS(){let e="";for(const t in this.css)if(!/:not\(/.test(t)){e+=t+" { ";for(const n in this.css[t])e+=n+": "+this.css[t][n]+"; ";e+="}\n"}return e}}try{return new n(e.ew,e.ed,{scanFullPage:!0}).generateCSS()}catch(o){}return""}(e)+"</style><body></body></html>"),o.document.close(),Te(e,void 0,"px",o.document.body));const t=o.document.createElement("style");t.innerHTML="@media print {\n\t\t\t\t\tbody {\n\t\t\t\t\t\t\t-webkit-print-color-adjust: exact;\n\t\t\t\t\t}\n\t\t\t}",o.document.head.appendChild(t),o.focus(),o.print()}},mode:W+V,tooltip:"Print"},b.add("print",function(e){e.registerButton({name:"print"})}),y.prototype.allowResizeTags=new Set(["img","iframe","table","jodit"]),y.prototype.resizer={showSize:!0,hideSizeTimeout:1e3,forImageChangeAttributes:!0,min_width:10,min_height:10,useAspectRatio:new Set(["img"])};var Si=function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};const _i="__jodit-resizer_binded";class ki extends E{constructor(){super(...arguments),this.LOCK_KEY="resizer",this.element=null,this.isResizeMode=!1,this.isShown=!1,this.startX=0,this.startY=0,this.width=0,this.height=0,this.ratio=0,this.rect=this.j.c.fromHTML(`<div title="${this.j.i18n("Press Alt for custom resizing")}" class="jodit-resizer">\n\t\t\t\t<div class="jodit-resizer__top-left"></div>\n\t\t\t\t<div class="jodit-resizer__top-right"></div>\n\t\t\t\t<div class="jodit-resizer__bottom-right"></div>\n\t\t\t\t<div class="jodit-resizer__bottom-left"></div>\n\t\t\t\t<span>100x100</span>\n\t\t\t</div>`),this.sizeViewer=this.rect.getElementsByTagName("span")[0],this.pointerX=0,this.pointerY=0,this.isAltMode=!1,this.onClickElement=e=>{this.isResizeMode||this.element===e&&this.isShown||(this.element=e,this.show(),v.isTag(this.element,"img")&&!this.element.complete&&this.j.e.one(this.element,"load",this.updateSize))},this.updateSize=()=>{if(!this.isInDestruct&&this.isShown&&this.element&&this.rect){const e=this.getWorkplacePosition(),t=Ae(this.element,this.j,this.j.ed),n=parseInt(this.rect.style.left||"0",10),o=parseInt(this.rect.style.top||"0",10),a=this.rect.offsetWidth,i=this.rect.offsetHeight,r=t.top-e.top,s=t.left-e.left;o===r&&n===s&&a===this.element.offsetWidth&&i===this.element.offsetHeight||(F(this.rect,{top:r,left:s,width:this.element.offsetWidth,height:this.element.offsetHeight}),this.j.events&&(this.j.e.fire(this.element,"changesize"),isNaN(n)||this.j.e.fire("resize")))}},this.hideSizeViewer=()=>{this.sizeViewer.style.opacity="0"}}afterInit(e){G("div",this.rect).forEach(t=>{e.e.on(t,"mousedown.resizer touchstart.resizer",this.onStartResizing.bind(this,t))}),Me.on("hideHelpers",this.hide),e.e.on("readonly",e=>{e&&this.hide()}).on("afterInit changePlace",this.addEventListeners.bind(this)).on("afterGetValueFromEditor.resizer",e=>{const t=/<jodit[^>]+data-jodit_iframe_wrapper[^>]+>(.*?<iframe[^>]*>.*?<\/iframe>.*?)<\/jodit>/gi;t.test(e.value)&&(e.value=e.value.replace(t,"$1"))}),this.addEventListeners(),this.__onChangeEditor()}onEditorClick(e){let t=e.target;const{editor:n,options:{allowResizeTags:o}}=this.j;for(;t&&t!==n;){if(v.isTag(t,o))return this.__bind(t),void this.onClickElement(t);t=t.parentNode}}__afterInsertImage(e){if(this.j.o.resizer.forImageChangeAttributes)return;const t=I(e,"width");t&&!F(e,"width",!0)&&(F(e,"width",t),I(e,"width",null))}addEventListeners(){const e=this.j;e.e.off(e.editor,".resizer").off(e.ow,".resizer").on(e.editor,"keydown.resizer",e=>{this.isShown&&e.key===Oe&&this.element&&!v.isTag(this.element,"table")&&this.onDelete(e)}).on(e.ow,"resize.resizer",this.updateSize).on("resize.resizer",this.updateSize).on([e.ow,e.editor],"scroll.resizer",()=>{this.isShown&&!this.isResizeMode&&this.hide()}).on(e.ow,"keydown.resizer",this.onKeyDown).on(e.ow,"keyup.resizer",this.onKeyUp).on(e.ow,"mouseup.resizer touchend.resizer",this.onClickOutside)}onStartResizing(e,t){if(!this.element||!this.element.parentNode)return this.hide(),!1;this.handle=e,t.cancelable&&t.preventDefault(),t.stopImmediatePropagation(),this.width=this.element.offsetWidth,this.height=this.element.offsetHeight,this.ratio=this.width/this.height,this.isResizeMode=!0,this.startX=t.clientX,this.startY=t.clientY,this.pointerX=t.clientX,this.pointerY=t.clientY;const{j:n}=this;n.e.fire("hidePopup"),n.lock(this.LOCK_KEY),n.e.on(n.ow,"mousemove.resizer touchmove.resizer",this.onResize)}onEndResizing(){const{j:e}=this;e.unlock(),this.isResizeMode=!1,this.isAltMode=!1,e.synchronizeValues(),e.e.off(e.ow,"mousemove.resizer touchmove.resizer",this.onResize)}onResize(e){if(this.isResizeMode){if(!this.element)return;let t,n;if(this.pointerX=e.clientX,this.pointerY=e.clientY,this.j.options.iframe){const o=this.getWorkplacePosition();t=e.clientX+o.left-this.startX,n=e.clientY+o.top-this.startY}else t=this.pointerX-this.startX,n=this.pointerY-this.startY;const o=this.handle.className;let a=0,i=0;const r=this.j.o.resizer.useAspectRatio;!this.isAltMode&&(!0===r||r&&v.isTag(this.element,r))?(t?(a=this.width+(o.match(/left/)?-1:1)*t,i=Math.round(a/this.ratio)):(i=this.height+(o.match(/top/)?-1:1)*n,a=Math.round(i*this.ratio)),a>qe(this.j.editor,this.j.ow)&&(a=qe(this.j.editor,this.j.ow),i=Math.round(a/this.ratio))):(a=this.width+(o.match(/left/)?-1:1)*t,i=this.height+(o.match(/top/)?-1:1)*n),a>this.j.o.resizer.min_width&&(a<this.rect.parentNode.offsetWidth?this.applySize(this.element,"width",a):this.applySize(this.element,"width","100%")),i>this.j.o.resizer.min_height&&this.applySize(this.element,"height",i),this.updateSize(),this.showSizeViewer(this.element.offsetWidth,this.element.offsetHeight),e.stopImmediatePropagation()}}onKeyDown(e){this.isAltMode=e.key===De,!this.isAltMode&&this.isResizeMode&&this.onEndResizing()}onKeyUp(){this.isAltMode&&this.isResizeMode&&this.element&&(this.width=this.element.offsetWidth,this.height=this.element.offsetHeight,this.ratio=this.width/this.height,this.startX=this.pointerX,this.startY=this.pointerY),this.isAltMode=!1}onClickOutside(e){if(this.isShown){if(!this.isResizeMode)return this.hide();e.stopImmediatePropagation(),this.onEndResizing()}}getWorkplacePosition(){return Ae(this.rect.parentNode||this.j.od.documentElement,this.j,this.j.od,!0)}applySize(e,t,n){const o=v.isImage(e)&&this.j.o.resizer.forImageChangeAttributes;o&&I(e,t,n),o&&!e.style[t]||F(e,t,n)}onDelete(e){this.element&&("JODIT"!==this.element.tagName?this.j.s.select(this.element):(v.safeRemove(this.element),this.hide(),e.preventDefault()))}__onChangeEditor(){this.isShown&&(this.element&&this.element.parentNode?this.updateSize():this.hide()),G("iframe",this.j.editor).forEach(this.__bind)}__bind(e){if(!v.isHTMLElement(e)||!this.j.o.allowResizeTags.has(e.tagName.toLowerCase())||J(e,_i))return;let t;if(J(e,_i,!0),v.isTag(e,"iframe")){const n=e;v.isHTMLElement(e.parentNode)&&I(e.parentNode,"-jodit_iframe_wrapper")?e=e.parentNode:(t=this.j.createInside.element("jodit",{"data-jodit-temp":1,contenteditable:!1,draggable:!0,"data-jodit_iframe_wrapper":1}),I(t,"style",I(e,"style")),F(t,{display:"inline-block"===e.style.display?"inline-block":"block",width:e.offsetWidth,height:e.offsetHeight}),e.parentNode&&e.parentNode.insertBefore(t,e),t.appendChild(e),this.j.e.on(t,"click",()=>{I(t,"data-jodit-wrapper_active",!0)}),e=t),this.j.e.off(e,"mousedown.select touchstart.select").on(e,"mousedown.select touchstart.select",()=>{this.j.s.select(e)}).off(e,"changesize").on(e,"changesize",()=>{n.setAttribute("width",e.offsetWidth+"px"),n.setAttribute("height",e.offsetHeight+"px")})}this.j.e.on(e,"dragstart",this.hide)}showSizeViewer(e,t){this.j.o.resizer.showSize&&(e<this.sizeViewer.offsetWidth||t<this.sizeViewer.offsetHeight?this.hideSizeViewer():(this.sizeViewer.style.opacity="1",this.sizeViewer.textContent=`${e} x ${t}`,this.j.async.setTimeout(this.hideSizeViewer,{timeout:this.j.o.resizer.hideSizeTimeout,label:"hideSizeViewer"})))}show(){this.j.o.readonly||this.isShown||(this.isShown=!0,this.rect.parentNode||(de(this.j,this.rect),this.j.workplace.appendChild(this.rect)),this.j.isFullSize&&(this.rect.style.zIndex=F(this.j.container,"zIndex").toString()),this.updateSize())}hide(){this.isResizeMode||(this.isResizeMode=!1,this.isShown=!1,this.element=null,v.safeRemove(this.rect),G("[data-jodit-wrapper_active='true']",this.j.editor).forEach(e=>I(e,"data-jodit-wrapper_active",!1)))}beforeDestruct(e){this.hide(),Me.off("hideHelpers",this.hide),e.e.off(this.j.ow,".resizer").off(".resizer")}}Si([x(":click")],ki.prototype,"onEditorClick",null),Si([x(":afterInsertImage")],ki.prototype,"__afterInsertImage",null),Si([ye],ki.prototype,"onStartResizing",null),Si([ye],ki.prototype,"onEndResizing",null),Si([ye],ki.prototype,"onResize",null),Si([ye],ki.prototype,"onKeyDown",null),Si([ye],ki.prototype,"onKeyUp",null),Si([ye],ki.prototype,"onClickOutside",null),Si([x(":change")],ki.prototype,"__onChangeEditor",null),Si([ye],ki.prototype,"__bind",null),Si([ye,x(":hideResizer")],ki.prototype,"hide",null),b.add("resizer",ki);y.prototype.useSearch=!0,y.prototype.search={lazyIdleTimeout:0,useCustomHighlightAPI:Ne&&void 0!==Ne.Highlight},w.set("search",'<svg viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg"> <path clip-rule="evenodd" d="M306.39,154.09c19.628,4.543,35.244,21.259,39.787,39.523 c1.551,8.54,8.998,14.989,17.904,14.989c9.991,0,18.168-8.175,18.168-18.17c0-13.083-10.991-32.98-25.985-47.881 c-14.719-14.537-32.252-24.802-46.695-24.802c-9.991,0-18.172,8.45-18.172,18.446C291.396,145.094,297.847,152.546,306.39,154.09z M56.629,392.312c-14.09,14.08-14.09,36.979,0,51.059c14.08,14.092,36.981,14.092,50.965,0l104.392-104.303 c24.347,15.181,53.062,23.991,83.953,23.991c87.857,0,158.995-71.142,158.995-158.999c0-87.854-71.138-158.995-158.995-158.995 c-87.856,0-158.995,71.141-158.995,158.995c0,30.802,8.819,59.606,23.992,83.953L56.629,392.312z M182.371,204.06 c0-62.687,50.875-113.568,113.568-113.568s113.569,50.881,113.569,113.568c0,62.694-50.876,113.569-113.569,113.569 S182.371,266.754,182.371,204.06z" fill-rule="evenodd"/> </svg> '),y.prototype.controls.find={tooltip:"Find",icon:"search",exec(e,t,{control:n}){switch(n.args&&n.args[0]){case"findPrevious":e.e.fire("searchPrevious");break;case"findNext":e.e.fire("searchNext");break;case"replace":e.execCommand("openReplaceDialog");break;default:e.execCommand("openSearchDialog")}},list:{search:"Find",findNext:"Find Next",findPrevious:"Find Previous",replace:"Replace"},childTemplate:(e,t,n)=>n};const Ii="jd-tmp-selection";function ji(e,t,n,o,a){if(null==t.startContainer.nodeValue||null==t.endContainer.nodeValue)return;if(function(e,t,n){if(e.o.search.useCustomHighlightAPI&&Ne&&void 0!==Ne.Highlight){const o=[t,...n].map(t=>{const n=e.selection.createRange();return n.setStart(t.startContainer,t.startOffset),n.setEnd(t.endContainer,t.endOffset),n}),a=new Highlight(...o);return CSS.highlights.clear(),CSS.highlights.set("jodit-search-result",a),n.length=0,!0}return!1}(e,t,n))return;const i=o.element("span",{[Ii]:!0});v.markTemporary(i),function(e,t,n){const o=e.startContainer.nodeValue;let a=0;if(0!==e.startOffset){const t=n.text(o.substring(0,e.startOffset));e.startContainer.nodeValue=o.substring(e.startOffset),v.before(e.startContainer,t),e.startContainer===e.endContainer&&(a=e.startOffset,e.endOffset-=a),e.startOffset=0}const i=e.endContainer.nodeValue;if(e.endOffset!==i.length){const o=n.text(i.substring(e.endOffset));e.endContainer.nodeValue=i.substring(0,e.endOffset),v.after(e.endContainer,o);for(const n of t){if(n.startContainer!==e.endContainer)break;n.startContainer=o,n.startOffset=n.startOffset-e.endOffset-a,n.endContainer===e.endContainer&&(n.endContainer=o,n.endOffset=n.endOffset-e.endOffset-a)}e.endOffset=e.endContainer.nodeValue.length}}(t,n,o);let r=t.startContainer;do{if(!r)break;if(v.isText(r)&&!Ti(r.parentNode)&&v.wrap(r,i.cloneNode(),o),r===t.endContainer)break;let e=r.firstChild||r.nextSibling;if(!e){for(;r&&!r.nextSibling&&r!==a;)r=r.parentNode;e=null==r?void 0:r.nextSibling}r=e}while(r&&r!==a)}function Ci(e){return G(`[${Ii}]`,e)}function Li(e){Ci(e.editor).forEach(e=>v.unwrap(e)),function(e){e.o.search.useCustomHighlightAPI&&Ne&&void 0!==Ne.Highlight&&CSS.highlights.clear()}(e)}function Ti(e){return v.isElement(e)&&e.hasAttribute(Ii)}class xi{constructor(e=Pe){this.searchIndex=e,this.queue=[],this.value=""}add(e){var t;const n=(null!==(t=e.nodeValue)&&void 0!==t?t:"").toLowerCase();if(!n.length)return;const o=this.value.length;this.queue.push({startIndex:o,endIndex:o+n.length,node:e}),this.value+=n}ranges(e,t=0){const n=[];let o=t,a=0,i=0;do{if([o,a]=this.searchIndex(e,this.value,o),-1!==o){let e,t,r=0,s=0;for(let n=i;n<this.queue.length;n+=1)if(!e&&this.queue[n].endIndex>o&&(e=this.queue[n].node,r=o-this.queue[n].startIndex),e&&this.queue[n].endIndex>=o+a){t=this.queue[n].node,s=o+a-this.queue[n].startIndex,i=n;break}e&&t&&n.push({startContainer:e,startOffset:r,endContainer:t,endOffset:s}),o+=a}}while(-1!==o);return 0===n.length?null:n}}var Bi=function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};let Ai=class extends Q{className(){return"UISearch"}render(){return`<div>\n\t\t\t<div class="&__box">\n\t\t\t\t<div class="&__inputs">\n\t\t\t\t\t<input data-ref="query" tabindex="0" placeholder="~Search for~" type="text"/>\n\t\t\t\t\t<input data-ref="replace" tabindex="0" placeholder="~Replace with~" type="text"/>\n\t\t\t\t</div>\n\t\t\t\t<div class="&__counts">\n\t\t\t\t\t<span data-ref="counter-box">\n\t\t\t\t\t\t<span data-ref="current">0</span><span>/</span><span data-ref="count">0</span>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="&__buttons">\n\t\t\t\t\t<button data-ref="next" tabindex="0" type="button">${w.get("angle-down")}</button>\n\t\t\t\t\t<button data-ref="prev" tabindex="0" type="button">${w.get("angle-up")}</button>\n\t\t\t\t\t<button data-ref="cancel" tabindex="0" type="button">${w.get("cancel")}</button>\n\t\t\t\t\t<button data-ref="replace-btn" tabindex="0" type="button" class="jodit-ui-button">~Replace~</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>`}get currentIndex(){return this._currentIndex}set currentIndex(e){this._currentIndex=e,this.currentBox.innerText=e.toString()}set count(e){this.countBox.innerText=e.toString()}get query(){return this.queryInput.value}get replace(){return this.replaceInput.value}constructor(e){super(e),this.selInfo=null,this._currentIndex=0,this.isOpened=!1;const{query:t,replace:n,cancel:o,next:a,prev:i,replaceBtn:r,current:s,count:l}=ze(this.container);this.queryInput=t,this.replaceInput=n,this.closeButton=o,this.replaceButton=r,this.currentBox=s,this.countBox=l,e.e.on(this.closeButton,"pointerdown",()=>(this.close(),!1)).on(this.queryInput,"input",()=>{this.currentIndex=0}).on(this.queryInput,"pointerdown",()=>{e.s.isFocused()&&(e.s.removeMarkers(),this.selInfo=e.s.save())}).on(this.replaceButton,"pointerdown",()=>(e.e.fire(this,"pressReplaceButton"),!1)).on(a,"pointerdown",()=>(e.e.fire("searchNext"),!1)).on(i,"pointerdown",()=>(e.e.fire("searchPrevious"),!1)).on(this.queryInput,"input",()=>{this.setMod("empty-query",!_(this.queryInput.value).length)}).on(this.queryInput,"keydown",this.j.async.debounce(async t=>{if(t.key===we)t.preventDefault(),t.stopImmediatePropagation(),await e.e.fire("searchNext")&&this.close();else e.e.fire(this,"needUpdateCounters")},this.j.defaultTimeout))}onEditorKeyDown(e){if(!this.isOpened)return;const{j:t}=this;if(t.getRealMode()===V)switch(e.key){case Fe:this.close();break;case Re:this.queryInput.value&&(t.e.fire(e.shiftKey?"searchPrevious":"searchNext"),e.preventDefault())}}open(e,t,n=!1){this.isOpened||(this.j.workplace.appendChild(this.container),this.isOpened=!0),this.calcSticky(this.j.e.fire("getStickyState.sticky")||!1),this.j.e.fire("hidePopup"),this.setMod("replace",n);const o=null!=e?e:(this.j.s.sel||"").toString();o&&(this.queryInput.value=o),t&&(this.replaceInput.value=t),this.setMod("empty-query",!o.length),this.j.e.fire(this,"needUpdateCounters"),o?this.queryInput.select():this.queryInput.focus()}close(){this.isOpened&&(this.j.s.restore(),v.safeRemove(this.container),this.isOpened=!1,this.j.e.fire(this,"afterClose"))}calcSticky(e){if(this.isOpened)if(this.setMod("sticky",e),e){const e=re(this.j.toolbarContainer);F(this.container,{top:e.top+e.height,left:e.left+e.width})}else F(this.container,{top:null,left:null})}};Bi([x([":keydown","queryInput:keydown"])],Ai.prototype,"onEditorKeyDown",null),Bi([ye],Ai.prototype,"open",null),Bi([ye],Ai.prototype,"close",null),Bi([x(":toggleSticky")],Ai.prototype,"calcSticky",null),Ai=Bi([X],Ai);var Mi=function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};class Oi extends E{constructor(){super(...arguments),this.buttons=[{name:"find",group:"search"}],this.previousQuery="",this.drawPromise=null,this.walker=null,this.walkerCount=null,this.cache={},this.wrapFrameRequest=0}get ui(){return new Ai(this.j)}async updateCounters(){this.ui.isOpened&&(this.ui.count=await this.calcCounts(this.ui.query))}onPressReplaceButton(){this.findAndReplace(this.ui.query),this.updateCounters()}tryScrollToElement(e){let t=v.closest(e,v.isElement,this.j.editor);t||(t=v.prev(e,v.isElement,this.j.editor)),t&&t!==this.j.editor&&He(t,this.j.editor,this.j.ed)}async calcCounts(e){return(await this.findQueryBounds(e,"walkerCount")).length}async findQueryBounds(e,t){let n=this[t];return n&&n.break(),n=new A(this.j.async,{timeout:this.j.o.search.lazyIdleTimeout}),this[t]=n,this.find(n,e).catch(e=>[])}async findAndReplace(e){const t=await this.findQueryBounds(e,"walker");if(!t.length)return!1;let n=this.findCurrentIndexInRanges(t,this.j.s.range);-1===n&&(n=0);const o=t[n];if(o){try{const t=this.j.ed.createRange();t.setStart(o.startContainer,o.startOffset),t.setEnd(o.endContainer,o.endOffset),t.deleteContents();const a=this.j.createInside.text(this.ui.replace);v.safeInsertNode(t,a),Li(this.j),this.j.s.setCursorAfter(a),this.tryScrollToElement(a),this.cache={},this.ui.currentIndex=n,await this.findAndSelect(e,!0).catch(e=>(!We&&console.error(e),null))}finally{this.j.synchronizeValues()}return this.j.e.fire("afterFindAndReplace"),!0}return!1}async findAndSelect(e,t){var n;const o=await this.findQueryBounds(e,"walker");if(!o.length)return!1;this.previousQuery===e&&Ci(this.j.editor).length||(null===(n=this.drawPromise)||void 0===n||n.rejectCallback(),this.j.async.cancelAnimationFrame(this.wrapFrameRequest),Li(this.j),this.drawPromise=this.__drawSelectionRanges(o)),this.previousQuery=e;let a=this.ui.currentIndex-1;a=-1===a?0:t?a===o.length-1?0:a+1:0===a?o.length-1:a-1,this.ui.currentIndex=a+1;const i=o[a];if(i){const e=this.j.ed.createRange();try{e.setStart(i.startContainer,i.startOffset),e.setEnd(i.endContainer,i.endOffset),this.j.s.selectRange(e)}catch(r){}return this.tryScrollToElement(i.startContainer),await this.updateCounters(),await this.drawPromise,this.j.e.fire("afterFindAndSelect"),!0}return!1}findCurrentIndexInRanges(e,t){return e.findIndex(e=>e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.startContainer&&e.endOffset===t.endOffset)}async isValidCache(e){return(await e).every(e=>{var t,n,o,a;return e.startContainer.isConnected&&e.startOffset<=(null!==(n=null===(t=e.startContainer.nodeValue)||void 0===t?void 0:t.length)&&void 0!==n?n:0)&&e.endContainer.isConnected&&e.endOffset<=(null!==(a=null===(o=e.endContainer.nodeValue)||void 0===o?void 0:o.length)&&void 0!==a?a:0)})}async find(e,t){if(!t.length)return[];const n=this.cache[t];return n&&await this.isValidCache(n)?n:(this.cache[t]=this.j.async.promise(n=>{const o=new xi(this.j.o.search.fuzzySearch);e.on("break",()=>{n([])}).on("visit",e=>(v.isText(e)&&o.add(e),!1)).on("end",()=>{var e;n(null!==(e=o.ranges(t))&&void 0!==e?e:[])}).setWork(this.j.editor)}),this.cache[t])}__drawSelectionRanges(e){const{async:t,createInside:n,editor:o}=this.j;t.cancelAnimationFrame(this.wrapFrameRequest);const a=[...e];let i,r=0;return t.promise(e=>{const s=()=>{do{i=a.shift(),i&&ji(this.j,i,a,n,o),r+=1}while(i&&r<=5);a.length?this.wrapFrameRequest=t.requestAnimationFrame(s):e()};s()})}onAfterGetValueFromEditor(e){e.value=e.value.replace(RegExp(`<span[^>]+${Ii}[^>]+>(.*?)</span>`,"g"),"$1")}afterInit(e){if(e.o.useSearch){const t=this;e.e.on("beforeSetMode.search",()=>{this.ui.close()}).on(this.ui,"afterClose",()=>{Li(e),this.ui.currentIndex=0,this.ui.count=0,this.cache={},e.focus()}).on("click",()=>{this.ui.currentIndex=0,Li(e)}).on("change.search",()=>{this.cache={}}).on("keydown.search mousedown.search",e.async.debounce(()=>{this.ui.selInfo&&(e.s.removeMarkers(),this.ui.selInfo=null),this.ui.isOpened&&this.updateCounters()},e.defaultTimeout)).on("searchNext.search searchPrevious.search",()=>(this.ui.isOpened||this.ui.open(),t.findAndSelect(t.ui.query,"searchNext"===e.e.current).catch(e=>{}))).on("search.search",(e,n=!0)=>(this.ui.currentIndex=0,t.findAndSelect(e||"",n).catch(e=>{}))),e.registerCommand("search",{exec:(e,n,o=!0)=>(n&&t.findAndSelect(n,o).catch(e=>{}),!1)}).registerCommand("openSearchDialog",{exec:(e,n)=>(t.ui.open(n),!1),hotkeys:["ctrl+f","cmd+f"]}).registerCommand("openReplaceDialog",{exec:(n,o,a)=>(e.o.readonly||t.ui.open(o,a,!0),!1),hotkeys:["ctrl+h","cmd+h"]})}}beforeDestruct(e){var t;null===(t=R(this,"ui"))||void 0===t||t.destruct(),e.e.off(".search")}}Mi([ce],Oi.prototype,"ui",null),Mi([x("ui:needUpdateCounters")],Oi.prototype,"updateCounters",null),Mi([x("ui:pressReplaceButton")],Oi.prototype,"onPressReplaceButton",null),Mi([ye],Oi.prototype,"findQueryBounds",null),Mi([ye],Oi.prototype,"findAndReplace",null),Mi([ye],Oi.prototype,"findAndSelect",null),Mi([ye],Oi.prototype,"find",null),Mi([x(":afterGetValueFromEditor")],Oi.prototype,"onAfterGetValueFromEditor",null),b.add("search",Oi),y.prototype.select={normalizeSelectionBeforeCutAndCopy:!1,normalizeTripleClick:!0};var qi=function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};class Di extends E{constructor(){super(...arguments),this.proxyEventsList=["click","mousedown","touchstart","mouseup","touchend"]}afterInit(e){this.proxyEventsList.forEach(t=>{e.e.on(t+".select",this.onStartSelection)})}beforeDestruct(e){this.proxyEventsList.forEach(t=>{e.e.on(t+".select",this.onStartSelection)})}onStartSelection(e){const{j:t}=this;let n,o=e.target;for(;void 0===n&&o&&o!==t.editor;)n=t.e.fire(Ve(e.type+"_"+o.nodeName.toLowerCase()),o,e),o=o.parentElement;"click"===e.type&&void 0===n&&o===t.editor&&t.e.fire(e.type+"Editor",o,e)}onOutsideClick(e){const t=e.target;if(v.up(t,e=>e===this.j.editor))return;Q.closestElement(t,oe)||this.j.e.fire("outsideClick",e)}beforeCommandCut(){const{s:e}=this.j;if(!e.isCollapsed()){const t=e.current();t&&v.isOrContains(this.j.editor,t)&&this.onCopyNormalizeSelectionBound()}}beforeCommandSelectAll(){const{s:e}=this.j;return e.focus(),e.select(this.j.editor,!0),e.expandSelection(),!1}onTripleClickNormalizeSelection(e){if(3!==e.detail||!this.j.o.select.normalizeTripleClick)return;const{s:t}=this.j,{startContainer:n,startOffset:o}=t.range;0===o&&v.isText(n)&&t.select(v.closest(n,v.isBlock,this.j.editor)||n,!0)}onCopyNormalizeSelectionBound(e){const{s:t,editor:n,o:o}=this.j;o.select.normalizeSelectionBeforeCutAndCopy&&!t.isCollapsed()&&(!e||e.isTrusted&&v.isNode(e.target)&&v.isOrContains(n,e.target))&&this.jodit.s.expandSelection()}}qi([ye],Di.prototype,"onStartSelection",null),qi([x("ow:click")],Di.prototype,"onOutsideClick",null),qi([x([":beforeCommandCut"])],Di.prototype,"beforeCommandCut",null),qi([x([":beforeCommandSelectall"])],Di.prototype,"beforeCommandSelectAll",null),qi([x([":click"])],Di.prototype,"onTripleClickNormalizeSelection",null),qi([x([":copy",":cut"])],Di.prototype,"onCopyNormalizeSelectionBound",null),b.add("select",Di);y.prototype.beautifyHTML=!$e,y.prototype.sourceEditor="ace",y.prototype.sourceEditorNativeOptions={showGutter:!0,theme:"ace/theme/idle_fingers",mode:"ace/mode/html",wrap:!0,highlightActiveLine:!0},y.prototype.sourceEditorCDNUrlsJS=["https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.2/ace.js"],y.prototype.beautifyHTMLCDNUrlsJS=["https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.4/beautify.min.js","https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.4/beautify-html.min.js"],w.set("source",'<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox="0 0 1792 1792"> <path d="M553 1399l-50 50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23 10l50 50q10 10 10 23t-10 23l-393 393 393 393q10 10 10 23t-10 23zm591-1067l-373 1291q-4 13-15.5 19.5t-23.5 2.5l-62-17q-13-4-19.5-15.5t-2.5-24.5l373-1291q4-13 15.5-19.5t23.5-2.5l62 17q13 4 19.5 15.5t2.5 24.5zm657 651l-466 466q-10 10-23 10t-23-10l-50-50q-10-10-10-23t10-23l393-393-393-393q-10-10-10-23t10-23l50-50q10-10 23-10t23 10l466 466q10 10 10 23t-10 23z"/> </svg> '),y.prototype.controls.source={mode:Ye,exec:e=>{e.toggleMode()},isActive:e=>e.getRealMode()===W,tooltip:"Change mode"};class Ni{constructor(e,t,n,o){this.jodit=e,this.container=t,this.toWYSIWYG=n,this.fromWYSIWYG=o,this.className="",this.isReady=!1}get j(){return this.jodit}onReady(){this.replaceUndoManager(),this.isReady=!0,this.j.e.fire(this,"ready")}onReadyAlways(e){var t;this.isReady?e():null===(t=this.j.events)||void 0===t||t.on(this,"ready",e)}}class Pi extends Ni{constructor(){super(...arguments),this.className="jodit_ace_editor",this.proxyOnBlur=e=>{this.j.e.fire("blur",e)},this.proxyOnFocus=e=>{this.j.e.fire("focus",e)},this.proxyOnMouseDown=e=>{this.j.e.fire("mousedown",e)}}aceExists(){return void 0!==this.j.ow.ace}getLastColumnIndex(e){return this.instance.session.getLine(e).length}getLastColumnIndices(){const e=this.instance.session.getLength(),t=[];let n=0;for(let o=0;o<e;o++)n+=this.getLastColumnIndex(o),o>0&&(n+=1),t[o]=n;return t}getRowColumnIndices(e){const t=this.getLastColumnIndices();if(e<=t[0])return{row:0,column:e};let n=1;for(let o=1;o<t.length;o++)e>t[o]&&(n=o+1);return{row:n,column:e-t[n-1]-1}}setSelectionRangeIndices(e,t){const n=this.getRowColumnIndices(e),o=this.getRowColumnIndices(t);this.instance.getSelection().setSelectionRange({start:n,end:o})}getIndexByRowColumn(e,t){return this.getLastColumnIndices()[e]-this.getLastColumnIndex(e)+t}init(e){const t=()=>{if(void 0!==this.instance||!this.aceExists())return;const t=this.j.c.div("jodit-source__mirror-fake");this.container.appendChild(t);const n=e.ow.ace;this.instance=n.edit(t),"rtl"===e.o.direction&&(this.instance.setOption("rtlText",!0),this.instance.setOption("rtl",!0)),this.instance.setTheme(e.o.sourceEditorNativeOptions.theme),this.instance.renderer.setShowGutter(e.o.sourceEditorNativeOptions.showGutter),this.instance.getSession().setMode(e.o.sourceEditorNativeOptions.mode),this.instance.setHighlightActiveLine(e.o.sourceEditorNativeOptions.highlightActiveLine),this.instance.getSession().setUseWrapMode(!0),this.instance.setOption("indentedSoftWrap",!1),this.instance.setOption("wrap",e.o.sourceEditorNativeOptions.wrap),this.instance.getSession().setUseWorker(!1),this.instance.$blockScrolling=1/0,this.instance.on("change",this.toWYSIWYG),this.instance.on("focus",this.proxyOnFocus),this.instance.on("mousedown",this.proxyOnMouseDown),this.instance.on("blur",this.proxyOnBlur),e.getRealMode()!==V&&this.setValue(this.getValue());const o=this.j.async.throttle(()=>{if(e.isInDestruct||e.getMode()===V)return;const t=this.instance.isFocused();"auto"!==e.o.height?this.instance.setOption("maxLines",e.workplace.offsetHeight/this.instance.renderer.lineHeight):this.instance.setOption("maxLines",1/0),this.instance.resize(),t&&this.focus()},2*this.j.defaultTimeout);e.e.on(e,"resize",o).on("afterResize afterSetMode",o),o(),this.onReady()};e.e.on("afterSetMode",()=>{e.getRealMode()!==W&&e.getMode()!==Ye||(this.fromWYSIWYG(),t())}),t(),this.aceExists()||Ue(e,e.o.sourceEditorCDNUrlsJS).then(()=>{e.isInDestruct||t()}).catch(()=>null)}destruct(){var e,t;this.instance.off("change",this.toWYSIWYG),this.instance.off("focus",this.proxyOnFocus),this.instance.off("mousedown",this.proxyOnMouseDown),this.instance.destroy(),null===(t=null===(e=this.j)||void 0===e?void 0:e.events)||void 0===t||t.off("aceInited.source")}setValue(e){if(!this.j.o.editHTMLDocumentMode&&this.j.o.beautifyHTML){const t=this.j.e.fire("beautifyHTML",e);S(t)&&(e=t)}this.instance.setValue(e),this.instance.clearSelection()}getValue(){return this.instance.getValue()}setReadOnly(e){this.instance.setReadOnly(e)}get isFocused(){return this.instance.isFocused()}focus(){this.instance.container.focus(),this.instance.focus()}blur(){this.instance.blur()}getSelectionStart(){const e=this.instance.selection.getRange();return this.getIndexByRowColumn(e.start.row,e.start.column)}getSelectionEnd(){const e=this.instance.selection.getRange();return this.getIndexByRowColumn(e.end.row,e.end.column)}selectAll(){this.instance.selection.selectAll()}insertRaw(e){const t=this.instance.selection.getCursor(),n=this.instance.session.insert(t,e);this.instance.selection.setRange({start:t,end:n},!1)}setSelectionRange(e,t){this.setSelectionRangeIndices(e,t)}setPlaceHolder(e){}replaceUndoManager(){const{history:e}=this.jodit;this.instance.commands.addCommand({name:"Undo",bindKey:{win:"Ctrl-Z",mac:"Command-Z"},exec:()=>{e.undo()}}),this.instance.commands.addCommand({name:"Redo",bindKey:{win:"Ctrl-Shift-Z",mac:"Command-Shift-Z"},exec:()=>{e.redo()}})}}class zi extends Ni{constructor(){super(...arguments),this.autosize=this.j.async.debounce(()=>{this.instance.style.height="auto",this.instance.style.height=this.instance.scrollHeight+"px"},this.j.defaultTimeout)}init(e){this.instance=e.c.element("textarea",{class:"jodit-source__mirror",dir:"rtl"===e.o.direction?"rtl":void 0}),this.container.appendChild(this.instance),e.e.on(this.instance,"mousedown keydown touchstart input",e.async.debounce(this.toWYSIWYG,e.defaultTimeout)).on("setMinHeight.source",e=>{F(this.instance,"minHeight",e)}).on(this.instance,"change keydown mousedown touchstart input",this.autosize).on("afterSetMode.source",this.autosize).on(this.instance,"mousedown focus",t=>{e.e.fire(t.type,t)}),this.autosize(),this.onReady()}destruct(){v.safeRemove(this.instance)}getValue(){return this.instance.value}setValue(e){this.instance.value=e}insertRaw(e){const t=this.getValue();if(this.getSelectionStart()>=0){const n=this.getSelectionStart(),o=this.getSelectionEnd();this.setValue(t.substring(0,n)+e+t.substring(o,t.length))}else this.setValue(t+e)}getSelectionStart(){return this.instance.selectionStart}getSelectionEnd(){return this.instance.selectionEnd}setSelectionRange(e,t=e){this.instance.setSelectionRange(e,t)}get isFocused(){return this.instance===this.j.od.activeElement}focus(){this.instance.focus()}blur(){this.instance.blur()}setPlaceHolder(e){this.instance.setAttribute("placeholder",e)}setReadOnly(e){e?this.instance.setAttribute("readonly","true"):this.instance.removeAttribute("readonly")}selectAll(){this.instance.select()}replaceUndoManager(){const{history:e}=this.jodit;this.j.e.on(this.instance,"keydown",t=>{if((t.ctrlKey||t.metaKey)&&"z"===t.key)return t.shiftKey?e.redo():e.undo(),this.setSelectionRange(this.getValue().length),!1})}}function Ri(e,t,n,o,a){let i;if(Ge(e))i=e(t);else switch(e){case"ace":if(!t.o.shadowRoot){i=new Pi(t,n,o,a);break}default:i=new zi(t,n,o,a)}return i.init(t),i.onReadyAlways(()=>{i.setReadOnly(t.o.readonly)}),i}var Fi=function(e,t,n,o){var a,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(r=(i<3?a(r):i>3?a(t,n,r):a(t,n))||r);return i>3&&r&&Object.defineProperty(t,n,r),r};class Hi extends E{constructor(){super(...arguments),this.buttons=[{name:"source",group:"source"}],this.__lock=!1,this.__oldMirrorValue="",this.tempMarkerStart="{start-jodit-selection}",this.tempMarkerStartReg=/{start-jodit-selection}/g,this.tempMarkerEnd="{end-jodit-selection}",this.tempMarkerEndReg=/{end-jodit-selection}/g,this.getSelectionStart=()=>{var e,t;return null!==(t=null===(e=this.sourceEditor)||void 0===e?void 0:e.getSelectionStart())&&void 0!==t?t:0},this.getSelectionEnd=()=>{var e,t;return null!==(t=null===(e=this.sourceEditor)||void 0===e?void 0:e.getSelectionEnd())&&void 0!==t?t:0}}onInsertHTML(e){var t;if(!this.j.o.readonly&&!this.j.isEditorMode())return null===(t=this.sourceEditor)||void 0===t||t.insertRaw(e),this.toWYSIWYG(),!1}fromWYSIWYG(e=!1){if(!this.__lock||!0===e){this.__lock=!0;const e=this.j.getEditorValue(!1,U);e!==this.getMirrorValue()&&this.setMirrorValue(e),this.__lock=!1}}toWYSIWYG(){if(this.__lock)return;const e=this.getMirrorValue();e!==this.__oldMirrorValue&&(this.__lock=!0,this.j.value=e,this.__lock=!1,this.__oldMirrorValue=e)}getNormalPosition(e,t){for(t=t.replace(/<(script|style|iframe)[^>]*>[^]*?<\/\1>/im,e=>{let t="";for(let n=0;n<e.length;n+=1)t+=Je;return t});e>0&&t[e]===Je;)e--;let n=e;for(;n>0;){if(n--,"<"===t[n]&&void 0!==t[n+1]&&t[n+1].match(/[\w/]+/i))return n;if(">"===t[n])return e}return e}clnInv(e){return e.replace(j(),"")}onSelectAll(e){var t;if("selectall"===e.toLowerCase()&&this.j.getRealMode()===W)return null===(t=this.sourceEditor)||void 0===t||t.selectAll(),!1}getMirrorValue(){var e;return(null===(e=this.sourceEditor)||void 0===e?void 0:e.getValue())||""}setMirrorValue(e){var t;null===(t=this.sourceEditor)||void 0===t||t.setValue(e)}setFocusToMirror(){var e;null===(e=this.sourceEditor)||void 0===e||e.focus()}saveSelection(){if(this.j.getRealMode()===V)this.j.s.save(),this.j.synchronizeValues(),this.fromWYSIWYG(!0);else{if(this.j.o.editHTMLDocumentMode)return;const e=this.getMirrorValue();if(this.getSelectionStart()===this.getSelectionEnd()){const t=this.j.s.marker(!0),n=this.getNormalPosition(this.getSelectionStart(),this.getMirrorValue());this.setMirrorValue(e.substring(0,n)+this.clnInv(t.outerHTML)+e.substring(n))}else{const t=this.j.s.marker(!0),n=this.j.s.marker(!1),o=this.getNormalPosition(this.getSelectionStart(),e),a=this.getNormalPosition(this.getSelectionEnd(),e);this.setMirrorValue(e.slice(0,o)+this.clnInv(t.outerHTML)+e.slice(o,a)+this.clnInv(n.outerHTML)+e.slice(a))}this.toWYSIWYG()}}removeSelection(){if(this.j.getRealMode()===V)return this.__lock=!0,this.j.s.restore(),void(this.__lock=!1);let e=this.getMirrorValue(),t=0,n=0;try{if(e=e.replace(/<span[^>]+data-jodit-selection_marker=(["'])start\1[^>]*>[<>]*?<\/span>/gim,this.tempMarkerStart).replace(/<span[^>]+data-jodit-selection_marker=(["'])end\1[^>]*>[<>]*?<\/span>/gim,this.tempMarkerEnd),!this.j.o.editHTMLDocumentMode&&this.j.o.beautifyHTML){const t=this.j.e.fire("beautifyHTML",e);S(t)&&(e=t)}if(t=e.indexOf(this.tempMarkerStart),n=t,e=e.replace(this.tempMarkerStartReg,""),-1!==t){const t=e.indexOf(this.tempMarkerEnd);-1!==t&&(n=t)}e=e.replace(this.tempMarkerEndReg,"")}finally{e=e.replace(this.tempMarkerEndReg,"").replace(this.tempMarkerStartReg,"")}this.setMirrorValue(e),this.setMirrorSelectionRange(t,n),this.toWYSIWYG(),this.setFocusToMirror()}setMirrorSelectionRange(e,t){var n;null===(n=this.sourceEditor)||void 0===n||n.setSelectionRange(e,t)}onReadonlyReact(){var e;null===(e=this.sourceEditor)||void 0===e||e.setReadOnly(this.j.o.readonly)}afterInit(e){if(this.mirrorContainer=e.c.div("jodit-source"),e.workplace.appendChild(this.mirrorContainer),e.e.on("afterAddPlace changePlace afterInit",()=>{e.workplace.appendChild(this.mirrorContainer)}),this.sourceEditor=Ri("area",e,this.mirrorContainer,this.toWYSIWYG,this.fromWYSIWYG),e.e.on(e.ow,"keydown",e=>{var t;e.key===Fe&&(null===(t=this.sourceEditor)||void 0===t?void 0:t.isFocused)&&this.sourceEditor.blur()}),this.onReadonlyReact(),e.e.on("placeholder.source",e=>{var t;null===(t=this.sourceEditor)||void 0===t||t.setPlaceHolder(e)}).on("change.source",this.syncValueFromWYSIWYG).on("beautifyHTML",e=>e),e.o.beautifyHTML){const t=()=>{var t;if(e.isInDestruct)return!1;const n=e.ow.html_beautify;return!(!n||e.isInDestruct)&&(null===(t=e.events)||void 0===t||t.off("beautifyHTML").on("beautifyHTML",e=>n(e)),!0)};t()||Ue(e,e.o.beautifyHTMLCDNUrlsJS).then(t,()=>null)}this.syncValueFromWYSIWYG(!0),this.initSourceEditor(e)}syncValueFromWYSIWYG(e=!1){const t=this.j;t.getMode()!==Ye&&t.getMode()!==W||this.fromWYSIWYG(e)}initSourceEditor(e){var t;if("area"!==e.o.sourceEditor){const t=Ri(e.o.sourceEditor,e,this.mirrorContainer,this.toWYSIWYG,this.fromWYSIWYG);t.onReadyAlways(()=>{var n,o;null===(n=this.sourceEditor)||void 0===n||n.destruct(),this.sourceEditor=t,this.syncValueFromWYSIWYG(!0),null===(o=e.events)||void 0===o||o.fire("sourceEditorReady",e)})}else null===(t=this.sourceEditor)||void 0===t||t.onReadyAlways(()=>{var t;this.syncValueFromWYSIWYG(!0),null===(t=e.events)||void 0===t||t.fire("sourceEditorReady",e)})}beforeDestruct(){this.sourceEditor&&(this.sourceEditor.destruct(),delete this.sourceEditor),v.safeRemove(this.mirrorContainer)}}Fi([x(":insertHTML.source")],Hi.prototype,"onInsertHTML",null),Fi([ye],Hi.prototype,"fromWYSIWYG",null),Fi([ye],Hi.prototype,"toWYSIWYG",null),Fi([ye],Hi.prototype,"getNormalPosition",null),Fi([x(":beforeCommand.source")],Hi.prototype,"onSelectAll",null),Fi([x(":beforeSetMode.source")],Hi.prototype,"saveSelection",null),Fi([x(":afterSetMode.source")],Hi.prototype,"removeSelection",null),Fi([ye],Hi.prototype,"setMirrorSelectionRange",null),Fi([x(":readonly.source")],Hi.prototype,"onReadonlyReact",null),Fi([ye],Hi.prototype,"syncValueFromWYSIWYG",null),b.add("source",Hi);y.prototype.usePopupForSpecialCharacters=!1,y.prototype.specialCharacters=["!","&quot;","#","$","%","&amp;","'","(",")","*","+","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","&lt;","=","&gt;","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","&euro;","&lsquo;","&rsquo;","&ldquo;","&rdquo;","&ndash;","&mdash;","&iexcl;","&cent;","&pound;","&curren;","&yen;","&brvbar;","&sect;","&uml;","&copy;","&ordf;","&laquo;","&raquo;","&not;","&reg;","&macr;","&deg;","&sup2;","&sup3;","&acute;","&micro;","&para;","&middot;","&cedil;","&sup1;","&ordm;","&frac14;","&frac12;","&frac34;","&iquest;","&Agrave;","&Aacute;","&Acirc;","&Atilde;","&Auml;","&Aring;","&AElig;","&Ccedil;","&Egrave;","&Eacute;","&Ecirc;","&Euml;","&Igrave;","&Iacute;","&Icirc;","&Iuml;","&ETH;","&Ntilde;","&Ograve;","&Oacute;","&Ocirc;","&Otilde;","&Ouml;","&times;","&Oslash;","&Ugrave;","&Uacute;","&Ucirc;","&Uuml;","&Yacute;","&THORN;","&szlig;","&agrave;","&aacute;","&acirc;","&atilde;","&auml;","&aring;","&aelig;","&ccedil;","&egrave;","&eacute;","&ecirc;","&euml;","&igrave;","&iacute;","&icirc;","&iuml;","&eth;","&ntilde;","&ograve;","&oacute;","&ocirc;","&otilde;","&ouml;","&divide;","&oslash;","&ugrave;","&uacute;","&ucirc;","&uuml;","&yacute;","&thorn;","&yuml;","&OElig;","&oelig;","&#372;","&#374","&#373","&#375;","&sbquo;","&#8219;","&bdquo;","&hellip;","&trade;","&#9658;","&bull;","&rarr;","&rArr;","&hArr;","&diams;","&asymp;"],w.set("symbols",'<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox="0 0 270 270"> <path d="m240.443652,220.45085l-47.410809,0l0,-10.342138c13.89973,-8.43655 25.752896,-19.844464 34.686646,-33.469923c11.445525,-17.455846 17.496072,-37.709239 17.496072,-58.570077c0,-59.589197 -49.208516,-108.068714 -109.693558,-108.068714s-109.69263,48.479517 -109.69263,108.069628c0,20.860839 6.050547,41.113316 17.497001,58.570077c8.93375,13.625459 20.787845,25.032458 34.686646,33.469008l0,10.342138l-47.412666,0c-10.256959,0 -18.571354,8.191376 -18.571354,18.296574c0,10.105198 8.314395,18.296574 18.571354,18.296574l65.98402,0c10.256959,0 18.571354,-8.191376 18.571354,-18.296574l0,-39.496814c0,-7.073455 -4.137698,-13.51202 -10.626529,-16.537358c-25.24497,-11.772016 -41.557118,-37.145704 -41.557118,-64.643625c0,-39.411735 32.545369,-71.476481 72.549922,-71.476481c40.004553,0 72.550851,32.064746 72.550851,71.476481c0,27.497006 -16.312149,52.87161 -41.557118,64.643625c-6.487902,3.026253 -10.6256,9.464818 -10.6256,16.537358l0,39.496814c0,10.105198 8.314395,18.296574 18.571354,18.296574l65.982163,0c10.256959,0 18.571354,-8.191376 18.571354,-18.296574c0,-10.105198 -8.314395,-18.296574 -18.571354,-18.296574z"/> </svg> '),y.prototype.controls.symbols={hotkeys:["ctrl+shift+i","cmd+shift+i"],tooltip:"Insert Special Character",popup:(e,t,n)=>{const o=e.e.fire("generateSpecialCharactersTable.symbols");if(o){if(e.o.usePopupForSpecialCharacters){const t=e.c.div();return t.classList.add("jodit-symbols"),t.appendChild(o),e.e.on(o,"close_dialog",n),t}e.alert(o,"Select Special Character",void 0,"jodit-symbols").bindDestruct(e);const t=o.querySelector("a");t&&t.focus()}}};const Wi=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:""}},Symbol.toStringTag,{value:"Module"})),Vi=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:"symbol"}},Symbol.toStringTag,{value:"Module"})),$i=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:"Symbol"}},Symbol.toStringTag,{value:"Module"})),Yi=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:"Smbolo"}},Symbol.toStringTag,{value:"Module"})),Ui=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:""}},Symbol.toStringTag,{value:"Module"})),Gi=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:"Symbolit"}},Symbol.toStringTag,{value:"Module"})),Ji=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:"caractre"}},Symbol.toStringTag,{value:"Module"})),Xi=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:" "}},Symbol.toStringTag,{value:"Module"})),Zi=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:"Szimblum"}},Symbol.toStringTag,{value:"Module"})),Ki=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:"simbol"}},Symbol.toStringTag,{value:"Module"})),Qi=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:"Simbolo"}},Symbol.toStringTag,{value:"Module"})),er=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:"symbol"}},Symbol.toStringTag,{value:"Module"})),tr=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:""}},Symbol.toStringTag,{value:"Module"})),nr=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:""}},Symbol.toStringTag,{value:"Module"})),or=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:"symbool"}},Symbol.toStringTag,{value:"Module"})),ar=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:"symbol"}},Symbol.toStringTag,{value:"Module"})),ir=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:"Smbolo"}},Symbol.toStringTag,{value:"Module"})),rr=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:""}},Symbol.toStringTag,{value:"Module"})),sr=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:"Sembol"}},Symbol.toStringTag,{value:"Module"})),lr=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:""}},Symbol.toStringTag,{value:"Module"})),cr=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:""}},Symbol.toStringTag,{value:"Module"})),dr=Object.freeze(Object.defineProperty({__proto__:null,default:{symbols:""}},Symbol.toStringTag,{value:"Module"})),ur=Object.freeze(Object.defineProperty({__proto__:null,ar:Wi,cs_cz:Vi,de:$i,es:Yi,fa:Ui,fi:Gi,fr:Ji,he:Xi,hu:Zi,id:Ki,it:Qi,ja:er,ko:tr,mn:nr,nl:or,pl:ar,pt_br:ir,ru:rr,tr:sr,ua:lr,zh_cn:cr,zh_tw:dr},Symbol.toStringTag,{value:"Module"}));b.add("symbols",class extends E{constructor(e){super(e),this.buttons=[{name:"symbols",group:"insert"}],this.__countInRow=17,H(ur)}afterInit(e){e.e.on("generateSpecialCharactersTable.symbols",()=>{const t=e.c.fromHTML('<div class="jodit-symbols__container">\n\t\t\t\t\t\t<div class="jodit-symbols__container_table">\n\t\t\t\t\t\t\t<table class="jodit-symbols__table"><tbody></tbody></table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="jodit-symbols__container_preview">\n\t\t\t\t\t\t\t<div class="jodit-symbols__preview"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>'),n=t.querySelector(".jodit-symbols__preview"),o=t.querySelector("table").tBodies[0],a=[];for(let r=0;r<e.o.specialCharacters.length;){const t=e.c.element("tr");for(let n=0;n<this.__countInRow&&r<e.o.specialCharacters.length;n+=1,r+=1){const o=e.c.element("td"),i=e.c.fromHTML(`<a\n\t\t\t\t\t\t\t\t\tdata-index="${r}"\n\t\t\t\t\t\t\t\t\tdata-index-j="${n}"\n\t\t\t\t\t\t\t\t\trole="option"\n\t\t\t\t\t\t\t\t\ttabindex="-1"\n\t\t\t\t\t\t\t>${e.o.specialCharacters[r]}</a>`);a.push(i),o.appendChild(i),t.appendChild(o)}o.appendChild(t)}const i=this;return e.e.on(a,"focus",function(){n.innerHTML=this.innerHTML}).on(a,"mousedown",function(t){v.isTag(this,"a")&&(e.s.focus(),e.s.insertHTML(this.innerHTML),(null==t?void 0:t.shiftKey)||e.e.fire(this,"close_dialog"),t&&t.preventDefault(),t&&t.stopImmediatePropagation())}).on(a,"mouseenter",function(){v.isTag(this,"a")&&this.focus()}).on(a,"keydown",t=>{const n=t.target;if(v.isTag(n,"a")){const o=parseInt(I(n,"-index")||"0",10),r=parseInt(I(n,"data-index-j")||"0",10);let s;switch(t.key){case ve:case be:s=t.key===ve?o-i.__countInRow:o+i.__countInRow,void 0===a[s]&&(s=t.key===ve?Math.floor(a.length/i.__countInRow)*i.__countInRow+r:r,s>a.length-1&&(s-=i.__countInRow)),a[s]&&a[s].focus();break;case Ze:case Xe:s=t.key===Xe?o-1:o+1,void 0===a[s]&&(s=t.key===Xe?a.length-1:0),a[s]&&a[s].focus();break;case we:e.e.fire(n,"mousedown"),t.stopImmediatePropagation(),t.preventDefault()}}}),t})}beforeDestruct(e){e.e.off("generateSpecialCharactersTable.symbols")}});y.prototype.video={parseUrlToVideoEmbed:Ke,defaultWidth:400,defaultHeight:345},w.set("video",'<svg xmlns=\'http://www.w3.org/2000/svg\' viewBox="0 0 1792 1792"> <path d="M1792 352v1088q0 42-39 59-13 5-25 5-27 0-45-19l-403-403v166q0 119-84.5 203.5t-203.5 84.5h-704q-119 0-203.5-84.5t-84.5-203.5v-704q0-119 84.5-203.5t203.5-84.5h704q119 0 203.5 84.5t84.5 203.5v165l403-402q18-19 45-19 12 0 25 5 39 17 39 59z"/> </svg> '),y.prototype.controls.video={popup:(e,t,n)=>{const o=new Qe(e,[new et(e,[new tt(e,{name:"url",required:!0,label:"URL",placeholder:"https://",validators:["url"]})]),new et(e,[ue(e,"","Insert","primary").onAction(()=>o.submit())])]),a=new Qe(e,[new et(e,[new nt(e,{name:"code",required:!0,label:"Embed code"})]),new et(e,[ue(e,"","Insert","primary").onAction(()=>a.submit())])]),i=[],r=t=>{e.s.restore(),e.s.insertHTML(t),n()};return e.s.save(),i.push({icon:"link",name:"Link",content:o.container},{icon:"source",name:"Code",content:a.container}),o.onSubmit(t=>{var n,o,a,i;r(me(null!==(o=null===(n=e.o.video)||void 0===n?void 0:n.parseUrlToVideoEmbed)&&void 0!==o?o:Ke,t.url,{width:null===(a=e.o.video)||void 0===a?void 0:a.defaultWidth,height:null===(i=e.o.video)||void 0===i?void 0:i.defaultHeight}))}),a.onSubmit(e=>{r(e.code)}),ee(e,i)},tags:["iframe"],tooltip:"Insert youtube/vimeo video"},b.add("video",function(e){e.registerButton({name:"video",group:"media"})});ot.modules.Icon.set("phpmyfaq",'\n<svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1500 1500"\n preserveAspectRatio="xMidYMid meet">\n\n<g transform="translate(0.000000,1500) scale(0.100000,-0.100000)"\nfill="#000000" stroke="none">\n<path d="M7410 14534 c-19 -2 -98 -9 -175 -14 -1187 -91 -2412 -550 -3235\n-1214 -290 -234 -841 -728 -1156 -1038 l-141 -138 49 -193 c280 -1104 430\n-1570 632 -1972 102 -201 160 -289 261 -391 129 -130 230 -165 347 -121 101\n39 274 261 536 687 221 360 435 607 707 816 645 494 1413 764 2177 764 514 0\n978 -101 1383 -300 304 -150 501 -305 705 -555 272 -335 452 -802 520 -1355\n32 -259 41 -756 20 -1080 -71 -1102 -278 -1970 -617 -2593 -375 -690 -1018\n-1315 -1868 -1814 -66 -39 -128 -80 -139 -92 -18 -20 -18 -22 4 -83 121 -326\n425 -936 583 -1167 29 -42 31 -43 71 -37 92 14 533 258 871 481 757 500 1512\n1213 2092 1975 406 535 701 1009 1002 1610 454 910 671 1586 746 2330 48 475\n42 1030 -15 1430 -112 771 -449 1569 -924 2180 -124 160 -213 259 -395 444\n-733 744 -1648 1202 -2736 1372 -335 52 -506 65 -900 69 -203 2 -386 1 -405\n-1z"/>\n<path d="M2415 10278 c-15 -46 -48 -169 -75 -275 -224 -880 -299 -1807 -215\n-2649 120 -1204 554 -2193 1323 -3018 711 -761 1665 -1225 2767 -1346 55 -6\n255 -14 444 -17 l344 -6 -6 68 c-9 90 -38 147 -112 220 -68 67 -116 101 -486\n344 -1010 663 -1625 1302 -2033 2111 -228 450 -344 837 -402 1330 -14 121 -15\n204 -10 500 6 369 11 449 47 662 l21 128 -50 62 c-50 65 -535 702 -1097 1443\n-353 465 -400 525 -420 525 -9 0 -24 -32 -40 -82z"/>\n<path d="M10335 3160 c-317 -20 -646 -135 -932 -327 -381 -255 -653 -633 -750\n-1043 -30 -131 -42 -383 -24 -510 58 -392 310 -743 671 -934 112 -58 254 -110\n365 -133 75 -15 137 -18 370 -18 246 1 292 3 377 22 219 48 629 246 813 393\n77 62 231 218 290 295 153 199 273 458 327 709 16 77 22 136 22 251 1 167 -12\n254 -56 395 -156 493 -644 858 -1200 895 -46 3 -101 7 -123 9 -22 1 -89 -1\n-150 -4z"/>\n</g>\n</svg>\n'),ot.plugins.add("phpMyFAQ",e=>{e.registerButton({name:"phpMyFAQ",group:"insert"}),e.registerCommand("phpMyFAQ",()=>{const t=e.dlg({closeOnClickOverlay:!0});t.setMod("theme",e.o.theme).setHeader("phpMyFAQ Plugin").setContent('<form class="row row-cols-lg-auto g-3 align-items-center m-4">\n      <div class="col-12">\n        <label class="visually-hidden" for="pmf-search-internal-links">Search</label>\n        <input type="text" class="form-control" id="pmf-search-internal-links" placeholder="Search">\n      </div>\n    </form>\n    <div class="m-4" id="pmf-search-results"></div>\n    <div class="m-4">\n      <button type="button" class="btn btn-primary" id="select-faq-button">Select FAQ</button>\n    </div>').setSize(Math.min(900,screen.width),Math.min(640,screen.width)),t.open();const n=document.getElementById("pmf-search-internal-links"),o=document.getElementById("pmf-search-results"),a=document.getElementById("pmf-csrf-token").value,i=document.getElementById("select-faq-button");n.addEventListener("keyup",async()=>{const e=n.value;if(e.length>0)try{const t=await st(e,a);o.innerHTML="",t.success.forEach(e=>{o.innerHTML+=`<label class="form-check-label">\n            <input class="form-check-input" type="radio" name="faqURL" value="${e.url}">\n            ${e.question}\n          </label><br>`})}catch(t){console.error("Error:",t.message)}else o.innerHTML=""}),i.addEventListener("click",()=>{const n=document.querySelector("input[name=faqURL]:checked");if(n){const o=`<a href="${n.value}">${n.parentNode?.textContent?.trim()||""}</a>`;e.selection.insertHTML(o),t.close()}else alert("Please select an FAQ.")})})});ot.modules.Icon.set("codeSnippet",'<svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128"\n preserveAspectRatio="xMidYMid meet">\n\n<rect width="100%" height="100%" fill="none" />\n\n<g transform="translate(0,128) scale(0.100000,-0.100000)"\nfill="#000000" stroke="none">\n<path d="M261 1173 c-24 -9 -63 -35 -86 -58 -60 -59 -75 -112 -75 -261 0 -67\n-3 -129 -6 -138 -3 -9 -23 -20 -44 -26 -41 -11 -56 -35 -45 -70 4 -12 21 -24\n45 -30 21 -6 41 -17 44 -26 3 -9 6 -71 6 -138 0 -149 15 -202 75 -261 53 -53\n115 -75 216 -75 82 0 109 12 109 50 0 37 -27 50 -106 50 -95 0 -145 23 -174\n80 -17 33 -20 59 -20 169 0 102 -4 138 -17 166 -16 33 -16 37 0 70 13 28 17\n64 17 166 0 110 3 136 20 169 29 57 79 80 174 80 79 0 106 13 106 50 0 10 -7\n26 -16 34 -21 21 -162 20 -223 -1z"/>\n<path d="M806 1174 c-9 -8 -16 -24 -16 -34 0 -37 27 -50 101 -50 89 0 141 -24\n169 -80 17 -33 20 -59 20 -169 0 -102 4 -138 17 -166 16 -33 16 -37 0 -70 -13\n-28 -17 -64 -17 -166 0 -110 -3 -136 -20 -169 -28 -56 -80 -80 -169 -80 -74 0\n-101 -13 -101 -50 0 -37 27 -50 104 -50 95 0 159 23 211 75 60 59 75 112 75\n261 0 67 3 129 6 138 3 9 23 20 44 26 67 18 67 82 0 100 -21 6 -41 17 -44 26\n-3 9 -6 71 -6 138 0 88 -5 136 -17 171 -21 63 -85 127 -148 148 -64 22 -188\n23 -209 1z"/>\n<path d="M316 974 c-9 -8 -16 -24 -16 -34 0 -36 27 -50 100 -50 73 0 100 14\n100 50 0 36 -27 50 -100 50 -49 0 -73 -4 -84 -16z"/>\n<path d="M616 974 c-9 -8 -16 -24 -16 -34 0 -44 22 -50 190 -50 131 0 161 3\n174 16 20 20 20 48 0 68 -23 24 -325 24 -348 0z"/>\n<path d="M316 774 c-9 -8 -16 -24 -16 -34 0 -44 22 -50 190 -50 131 0 161 3\n174 16 20 20 20 48 0 68 -23 24 -325 24 -348 0z"/>\n<path d="M796 774 c-9 -8 -16 -24 -16 -34 0 -36 27 -50 100 -50 73 0 100 14\n100 50 0 36 -27 50 -100 50 -49 0 -73 -4 -84 -16z"/>\n<path d="M316 574 c-9 -8 -16 -24 -16 -34 0 -36 27 -50 100 -50 73 0 100 14\n100 50 0 36 -27 50 -100 50 -49 0 -73 -4 -84 -16z"/>\n<path d="M616 574 c-9 -8 -16 -24 -16 -34 0 -44 22 -50 190 -50 131 0 161 3\n174 16 20 20 20 48 0 68 -23 24 -325 24 -348 0z"/>\n<path d="M316 374 c-20 -20 -20 -48 0 -68 23 -24 325 -24 348 0 20 20 20 48 0\n68 -23 24 -325 24 -348 0z"/>\n<path d="M796 374 c-9 -8 -16 -24 -16 -34 0 -36 27 -50 100 -50 73 0 100 14\n100 50 0 36 -27 50 -100 50 -49 0 -73 -4 -84 -16z"/>\n</g>\n</svg>'),ot.plugins.add("codeSnippet",e=>{e.registerButton({name:"codeSnippet",group:"insert",options:{tooltip:"Insert Source Code Snippet"}}),e.registerCommand("codeSnippet",()=>{const t=e.dlg({closeOnClickOverlay:!0});t.setMod("theme",e.o.theme).setHeader("Insert Source Code Snippet").setContent('<form class="row m-4">\n      <div class="col-12 mb-2">\n        <label class="visually-hidden" for="programming-language">Programming language</label>\n        <select class="form-select" id="programming-language" name="programming-language">\n          <option value="plaintext">Plain Text</option>\n          <option value="bash">Bash</option>\n          <option value="c">C</option>\n          <option value="cpp">C++</option>\n          <option value="css">CSS</option>\n          <option value="html">HTML</option>\n          <option value="java">Java</option>\n          <option value="javascript">JavaScript</option>\n          <option value="json">JSON</option>\n          <option value="php">PHP</option>\n          <option value="python">Python</option>\n          <option value="ruby">Ruby</option>\n          <option value="sql">SQL</option>\n          <option value="typescript">TypeScript</option>\n          <option value="xml">XML</option>\n        </select>\n      </div>\n      <div class="col-12 mb-2">\n        <label class="visually-hidden" for="code">Source code</label>\n        <textarea class="form-control" id="code" rows="15" placeholder="Paste your source code snippet here"></textarea>\n      </div>\n      <div class="col-12">\n        <button type="button" class="btn btn-primary text-end" id="add-code-snippet-button">\n          Add source code snippet\n        </button>\n      </div>\n    </form>').setSize(Math.min(900,screen.width),Math.min(640,screen.width)),t.open();const n=document.getElementById("add-code-snippet-button"),o=document.getElementById("programming-language"),a=document.getElementById("code");n.addEventListener("click",()=>{const n=o.value,i=a.value,r=`<pre><code class="language-${n}">${s=i,s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}</code></pre>`;var s;e.selection.insertHTML(r),e.events.fire("change"),t.close()})})});const hr=e=>{const t=document.getElementById(`${e}Help`);t.classList.remove("visually-hidden"),t.addEventListener("click",()=>t.style.opacity="0"),t.addEventListener("transitionend",()=>t.remove())},pr=e=>{fetch(`./api/category/permissions/${e}`).then(e=>e.json()).then(e=>{mr(e)})},mr=e=>{const t=e;-1===parseInt(t.user[0])?(document.getElementById("restrictedusers").checked=!1,document.getElementById("allusers").checked=!0):(document.getElementById("allusers").checked=!1,document.getElementById("restrictedusers").checked=!0,t.user.forEach(e=>{document.querySelector(`#selected-user option[value='${e}']`).selected=!0}));const n=document.getElementById("restrictedgroups");if(n){const e=document.querySelectorAll("#restrictedgroups option"),o=document.getElementById("allgroups");e.forEach(e=>{e.removeAttribute("selected")}),-1===parseInt(t.group[0])?(n.checked=!1,n.disabled=!1,o&&(o.checked=!0,o.disabled=!1)):(o&&(o.checked=!1,o.disabled=!0),n.checked=!0,n.disabled=!1,t.group.forEach(e=>{document.querySelector(`#restrictedgroups option[value='${e}']`).setAttribute("selected","selected")}))}},gr=()=>{const e=document.getElementById("question").value,t=document.getElementById("questionHelp"),n=document.getElementById("faqEditorSubmit");e.includes("#")?(t.classList.remove("visually-hidden"),n.setAttribute("disabled","true")):(t.classList.add("visually-hidden"),n.removeAttribute("disabled"))};document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("pmf-faq-overview-search-input");if(e){const t=document.getElementById("pmf-csrf-token").value;i({input:e,minLength:1,onSelect:e=>{window.location.href=e.adminUrl},fetch:async(e,n)=>{const o=e.toLowerCase();n((await st(o,t)).success.filter(e=>-1!==e.question.toLowerCase().indexOf(o)))},render:(e,t)=>{const n=new RegExp(t,"gi");return l("div",{classList:"pmf-faq-list-result border",innerHTML:e.question.replace(n,e=>`<strong>${e}</strong>`)})},emptyMsg:"No users found"})}});const fr=()=>{const e=document.getElementById("faqEditorSubmit");e&&e.addEventListener("click",async e=>{e.preventDefault();const t=document.getElementById("faqEditor"),a=new FormData(t),i=c(a);let r;if(r="0"===i.faqId?await(async e=>{try{const t=await fetch("./api/faq/create",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({data:e})});return await t.json()}catch(t){throw t}})(i):await(async e=>{try{const t=await fetch("./api/faq/update",{method:"PUT",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({data:e})});return await t.json()}catch(t){throw t}})(i),r?.success){const e=r.data?JSON.parse(r.data):{},t=document.getElementById("faqId"),o=document.getElementById("revisionId");t.value=e.id,o.value=e.revisionId,n(r.success)}else r&&r.error&&o(r.error)})},yr=()=>{const e=document.getElementById("faqEditorDelete"),t=document.getElementById("pmf-confirm-delete-faq");e&&t&&t.addEventListener("click",async t=>{t.preventDefault();const a=e.getAttribute("data-faq-id"),i=e.getAttribute("data-faq-language"),r=e.getAttribute("data-pmf-csrf-token");if(a&&i&&r)try{const e=await(async(e,t,n)=>{try{const o=await fetch("./api/faq/delete",{method:"DELETE",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:n,faqId:e,faqLanguage:t})});if(200===o.status)return await o.json();throw new Error("Network response was not ok.")}catch(o){throw o}})(a,i,r);e?.success?(n(e.success),window.setTimeout(()=>{window.location.href="./faqs"},1e3)):o(e?.error?e.error:"Beim Lschen der FAQ ist ein unbekannter Fehler aufgetreten.")}catch(s){console.error(s),o("Beim Lschen der FAQ ist ein Fehler aufgetreten.")}else o("Fehlende Parameter zum Lschen der FAQ.")})},vr=()=>{const e=document.querySelectorAll(".pmf-admin-delete-glossary");e&&e.forEach(e=>{e.addEventListener("click",async t=>{t.preventDefault();const o=e.getAttribute("data-pmf-glossary-id"),a=e.getAttribute("data-pmf-csrf-token"),i=e.getAttribute("data-pmf-glossary-language"),r=await(async(e,t,n)=>{try{const o=await fetch("./api/glossary/delete",{method:"DELETE",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:n,id:e,lang:t})});if(200===o.status)return await o.json();throw new Error("Network response was not ok.")}catch(o){throw o}})(o,i,a);r&&(e.closest("tr").remove(),n(r.success))})})},br=()=>{const e=document.getElementById("pmf-admin-glossary-add"),t=document.getElementById("addGlossaryModal"),o=document.getElementsByClassName("modal-backdrop fade show");e&&e.addEventListener("click",async e=>{e.preventDefault();const a=document.getElementById("language").value,i=document.getElementById("item").value,r=document.getElementById("definition").value,s=document.getElementById("pmf-csrf-token").value,c=await(async(e,t,n,o)=>{try{const a=await fetch("./api/glossary/create",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:o,language:e,item:t,definition:n})});if(200===a.status)return await a.json();throw new Error("Network response was not ok.")}catch(a){throw a}})(a,i,r,s);if(c){t&&(t.style.display="none",t.classList.remove("show")),o[0]&&o[0].parentNode?.removeChild(o[0]);const e=document.querySelector("#pmf-admin-glossary-table tbody"),s=l("tr",{},[l("td",{innerText:i}),l("td",{innerText:r}),l("td",{classList:"text-end"},[l("button",{classList:"btn btn-danger pmf-admin-delete-glossary","data-pmf-glossary-id":i,"data-pmf-csrf-token":"","data-pmf-glossary-language":a,type:"button",innerText:"Delete"},[l("i",{class:"bi bi-trash"})])])]);e.appendChild(s),n(c.success)}})},wr=()=>{const e=document.getElementById("updateGlossaryModal");e&&e.addEventListener("show.bs.modal",async e=>{let t=e.relatedTarget??document.activeElement;t&&!t.hasAttribute("data-pmf-glossary-id")&&(t=t.closest("[data-pmf-glossary-id]"));const o=t?.getAttribute("data-pmf-glossary-id")??null,a=t?.getAttribute("data-pmf-glossary-language")??null;if(o&&a){document.getElementById("update-id").value=o,document.getElementById("update-language").value=a;try{const e=await(async(e,t)=>{try{const n=await fetch(`./api/glossary/${e}/${t}`,{method:"GET",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"}});if(200===n.status)return await n.json();throw new Error("Network response was not ok.")}catch(n){throw n}})(o,a);document.getElementById("update-item").value=e?.item??"",document.getElementById("update-definition").value=e?.definition??""}catch(i){n("Unable to load glossary item. Please try again.")}}})},Er=()=>{const e=document.getElementById("pmf-admin-glossary-update"),t=document.getElementById("updateGlossaryModal"),o=document.getElementsByClassName("modal-backdrop fade show");e&&e.addEventListener("click",async e=>{e.preventDefault();const a=document.getElementById("update-id").value,i=document.getElementById("update-language").value,r=document.getElementById("update-item").value,s=document.getElementById("update-definition").value,l=document.getElementById("update-csrf-token").value,c=await(async(e,t,n,o,a)=>{try{const i=await fetch("./api/glossary/update",{method:"PUT",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:a,id:e,lang:t,item:n,definition:o})});if(200===i.status)return await i.json();throw new Error("Network response was not ok.")}catch(i){throw i}})(a,i,r,s,l);if(c){t&&(t.style.display="none",t.classList.remove("show")),o[0]&&o[0].parentNode?.removeChild(o[0]);const e=document.querySelector(`#pmf-glossary-id-${a} td:nth-child(1) a`),i=document.querySelector(`#pmf-glossary-id-${a} td:nth-child(2)`);e&&(e.innerText=r),i&&(i.innerText=s),n(c.success)}})},Sr=()=>{const e=localStorage.getItem("phpmyfaq.answer.height"),t=document.getElementById("answer-markdown"),a=document.getElementById("markdown-tabs"),i=document.getElementById("pmf-markdown-insert-image"),r=document.getElementById("pmf-markdown-insert-image-button"),s=document.getElementById("pmf-markdown-upload-image"),l=document.getElementById("pmf-markdown-upload-image-input");if(t&&("undefined"!==e&&(t.style.height=e),t.addEventListener("mouseup",()=>{localStorage.setItem("phpmyfaq.answer.height",t.style.height)})),a){const e=document.querySelector('a[data-markdown-tab="preview"]');e&&e.addEventListener("shown.bs.tab",async()=>{const e=document.getElementById("markdown-preview");if(e&&t){e.style.height=t.style.height;try{const n=await(async e=>{try{const t=await fetch("./api/content/markdown",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({text:e})});return await t.json()}catch(t){throw t}})(t.value);e.innerHTML=n.success}catch(n){n instanceof Error?console.error(n):console.error("Unknown error:",n)}}})}if(i){const e=document.getElementById("pmf-markdown-insert-image-modal"),n=new m(e);i.addEventListener("click",async e=>{e.preventDefault(),n.show();const t=await(async()=>{try{const e=await fetch("./api/media-browser",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({action:"files"})});return await e.json()}catch(e){throw e}})();if(t.success){const e=document.getElementById("pmf-markdown-insert-image-list");e.innerHTML="",t.data.sources.forEach(t=>{t.files.forEach(n=>{const o=document.createElement("div");o.classList.add("list-group-item","d-flex","align-items-center"),o.innerHTML=`\n              <div class="form-check me-2">\n                <input type="checkbox" class="form-check-input" id="checkbox-${n.file}" data-image-url="${t.baseurl}/${t.path}/${n.file}">\n                <label class="form-check-label d-none" for="checkbox-${n.file}" aria-hidden="true">Select</label>\n              </div>\n              <img src="${t.baseurl}/${t.path}/${n.file}" class="img-thumbnail" alt="${n.file}" style="height: 100px;">\n            `,e.appendChild(o)})})}}),r.addEventListener("click",()=>{const e=document.querySelectorAll(".form-check-input:checked");let o="";e.forEach(e=>{const t=e.dataset.imageUrl;t&&(o+=`![Image](${t})\n`)});const a=t.selectionStart,i=t.selectionEnd;t.value=t.value.substring(0,a)+o+t.value.substring(i),t.setSelectionRange(a+o.length,a+o.length),t.focus(),n.hide()})}s&&(s.addEventListener("click",e=>{e.preventDefault(),l.click()}),l.addEventListener("change",async e=>{const t=e.target,a=document.getElementById("pmf-markdown-upload-image-csrf-token").value;if(t.files){const e=new FormData;for(const n of t.files)e.append("files[]",n);try{const t=await fetch("./api/content/images?csrf="+a,{method:"POST",body:e});if(!t.ok)throw new Error("Network response was not ok");const i=await t.json();i.success?n("Files uploaded successfully"):o("Upload failed:"+i.messages)}catch(i){o("Error uploading files: "+i)}}}))},_r=()=>{const e=document.getElementById("submitAddNews");e&&e.addEventListener("click",async e=>{e.preventDefault();let t="";document.querySelectorAll("#target").forEach(e=>{e.checked&&(t=e.value)});const a={news:document.getElementById("editor").value,newsHeader:document.getElementById("newsheader").value,authorName:document.getElementById("authorName").value,authorEmail:document.getElementById("authorEmail").value,active:document.getElementById("active").checked,comment:document.getElementById("comment").checked,link:document.getElementById("link").value,linkTitle:document.getElementById("linkTitle").value,langTo:document.getElementById("langTo").value,target:t,csrfToken:document.getElementById("pmf-csrf-token").value},i=await(async(e={})=>{try{const t=await fetch("api/news/create",{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(e)});return await t.json()}catch(t){throw t}})(a);"string"==typeof i.success?(n(i.success),setTimeout(()=>{window.location.href="./news"},3e3)):o(i.error)})},kr=()=>{document.getElementById("deleteNews")&&(document.querySelectorAll("#deleteNews").forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const n=new m(document.getElementById("confirmDeleteNewsModal"));document.getElementById("newsId").value=e.getAttribute("data-pmf-newsid"),n.show()})}),document.getElementById("pmf-delete-news-action").addEventListener("click",async e=>{e.preventDefault();const t=document.getElementById("pmf-csrf-token-delete").value,a=document.getElementById("newsId").value,i=await(async(e,t)=>{try{const n=await fetch("api/news/delete",{method:"DELETE",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({csrfToken:e,id:t})});return await n.json()}catch(n){throw n}})(t,a);"string"==typeof i.success?(n(i.success),setTimeout(()=>{window.location.reload()},3e3)):o(i.error)}),document.querySelectorAll("#activate").forEach(e=>{e.addEventListener("click",async()=>{const t=await(async(e,t,n)=>{try{const o=await fetch("api/news/activate",{method:"POST",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify({id:e,status:t,csrfToken:n})});return await o.json()}catch(o){throw o}})(e.getAttribute("data-pmf-id"),e.checked,e.getAttribute("data-pmf-csrf-token"));"string"==typeof t.success?n(t.success):o(t.error)})}))},Ir=()=>{const e=document.getElementById("submitEditNews");e&&e.addEventListener("click",async e=>{e.preventDefault();let t="";document.querySelectorAll("#target").forEach(e=>{e.checked&&(t=e.value)});const a={id:document.getElementById("id").value,csrfToken:document.getElementById("pmf-csrf-token").value,news:document.getElementById("editor").value,newsHeader:document.getElementById("newsheader").value,authorName:document.getElementById("authorName").value,authorEmail:document.getElementById("authorEmail").value,active:document.getElementById("active").checked,comment:document.getElementById("comment").checked,link:document.getElementById("link").value,linkTitle:document.getElementById("linkTitle").value,langTo:document.getElementById("langTo").value,target:t},i=await(async(e={})=>{try{const t=await fetch("api/news/update",{method:"PUT",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(e)});return await t.json()}catch(t){throw t}})(a);"string"==typeof i.success?(n(i.success),setTimeout(()=>{window.location.href="./news"},3e3)):o(i.error)})},jr=async()=>{const e=document.querySelectorAll(".accordion-collapse");e&&(xr(),e.forEach(e=>{const t=e.getAttribute("data-pmf-categoryId"),n=e.getAttribute("data-pmf-language");e.addEventListener("hidden.bs.collapse",()=>{Tr(t)}),e.addEventListener("shown.bs.collapse",async()=>{const e=Br(),o=Ar(),a=await(async(e,t,n,o)=>{try{let a=window.location.protocol+"//"+window.location.host,i=window.location.pathname;i.endsWith("/faqs")&&(i=i.slice(0,-5)),a+=i;const r=new URL(`${a}/api/faqs/${e}/${t}`);n&&r.searchParams.set("only-inactive",n),o&&r.searchParams.set("only-new",o);const s=await fetch(r.toString(),{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});return await s.json()}catch(a){throw a}})(t,n,e,o);await Lr(t,a.faqs,a.isAllowedToTranslate);const i=document.querySelectorAll(".pmf-admin-sticky-faq"),r=document.querySelectorAll(".pmf-admin-active-faq");document.querySelectorAll("#dropdownAddNewTranslation").forEach(e=>{e.addEventListener("click",async o=>{o.preventDefault();const a=await(async e=>{try{const t=await fetch(`./api/category/translations/${e}`,{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});return await t.json()}catch(t){throw t}})(t),i=e.parentElement.querySelector(".dropdown-menu"),r=e.getAttribute("data-pmf-faq-id"),s=[];i.querySelectorAll("#dropdownTranslation").forEach(e=>{s.push(e.innerText)});for(let[e]of Object.entries(a))if(e!==n){let t;try{const o=zt(e);t=new Intl.DisplayNames([n],{type:"language"}).of(o)}catch(c){t=null}if(t&&!s.includes(` ${t}`)){const n=l("a",{classList:"dropdown-item",id:"dropdownTranslation",href:`./faq/translate/${r}/${e}`,innerText:` ${t}`});i.appendChild(n)}}})}),i.forEach(e=>{e.addEventListener("change",async e=>{e.preventDefault();const t=e.target,n=t.getAttribute("data-pmf-category-id-sticky"),o=t.getAttribute("data-pmf-faq-id"),a=t.getAttribute("data-pmf-csrf");await Cr(n,[o],a,t.checked,"sticky")})}),r.forEach(e=>{e.addEventListener("change",async e=>{e.preventDefault();const t=e.target,n=t.getAttribute("data-pmf-category-id-active"),o=t.getAttribute("data-pmf-faq-id"),a=t.getAttribute("data-pmf-csrf");await Cr(n,[o],a,t.checked,"active")})})})}))},Cr=async(e,t,a,i,r)=>{let s;const l=document.getElementById(`${r}_record_${e}_${t[0]}`).getAttribute("lang");s="active"===r?"./api/faq/activate":"./api/faq/sticky";try{const r=await fetch(s,{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:a,categoryId:e,faqIds:t,faqLanguage:l,checked:i})});if(!r.ok)throw new Error("Network response was not ok: "+await r.text());{const e=await r.json();e.success?n(e.success):o(e.error)}}catch(c){console.error(await c.cause.response.json())}},Lr=async(e,t,n)=>{const o=document.getElementById(`tbody-category-id-${e}`),a=o.getAttribute("data-pmf-csrf");t.forEach(e=>{const t=document.createElement("tr");t.setAttribute("id",`faq_${e.id.toString()}_${e.language}`),t.append(l("td",{classList:"align-middle text-center"},[l("a",{classList:"text-decoration-none",href:`./faq/edit/${e.id.toString()}/${e.language}`,innerText:e.id.toString()})])),t.append(l("td",{classList:"align-middle text-center",innerText:e.language})),t.append(l("td",{classList:"align-middle text-center"},[l("a",{classList:"text-decoration-none",href:`./faq/edit/${e.id.toString()}/${e.language}`,innerText:e.solution_id.toString()})])),t.append(l("td",{},[l("a",{classList:"text-decoration-none",href:`./faq/edit/${e.id.toString()}/${e.language}`,innerText:e.question})])),t.append(l("td",{classList:"small",innerText:e.created})),t.append(l("td",{classList:"align-middle"},[l("input",{classList:"form-check-input pmf-admin-sticky-faq",type:"checkbox","data-pmfCategoryIdSticky":e.category_id.toString(),"data-pmfFaqId":e.id.toString(),"data-pmfCsrf":a,lang:e.language,id:`sticky_record_${e.category_id}_${e.id.toString()}`,checked:"yes"===e.sticky})])),t.append(l("td",{classList:"align-middle"},[l("input",{classList:"form-check-input pmf-admin-active-faq",type:"checkbox","data-pmfCategoryIdActive":e.category_id.toString(),"data-pmfFaqId":e.id.toString(),"data-pmfCsrf":a,lang:e.language,id:`active_record_${e.category_id.toString()}_${e.id.toString()}`,checked:"yes"===e.active})])),t.append(l("td",{classList:"align-middle text-center"},[l("a",{classList:"btn btn-primary",href:`./faq/edit/${e.id.toString()}/${e.language}`},[l("i",{classList:"bi bi-pencil","aria-hidden":"true"})])])),t.append(l("td",{classList:"align-middle text-center"},[l("a",{classList:"btn btn-info",href:`./faq/copy/${e.id.toString()}/${e.language}`},[l("i",{classList:"bi bi-copy","aria-hidden":"true"})])])),n&&t.append(l("td",{classList:"align-middle text-center"},[l("div",{classList:"checkbox"},[l("a",{classList:"btn btn-secondary dropdown-toggle",href:"#",role:"button",id:"dropdownAddNewTranslation","data-bsToggle":"dropdown","aria-haspopup":"true","aria-expanded":"false","data-pmfFaqId":e.id.toString()},[l("i",{classList:"bi bi-globe","aria-hidden":"true"})]),l("div",{classList:"dropdown-menu","aria-labelledby":"dropdownAddNewTranslation"},[l("a",{classList:"dropdown-item",id:"dropdownTranslation",innerText:""})])])])),t.append(l("td",{classList:"text-center"},[l("button",{classList:"btn btn-danger pmf-button-delete-faq",type:"button","data-pmfId":e.id.toString(),"data-pmfLanguage":e.language,"data-pmfToken":a},[l("i",{classList:"bi bi-trash","aria-hidden":"true","data-pmfId":e.id.toString(),"data-pmfLanguage":e.language,"data-pmfToken":a})])])),o.appendChild(t)})},Tr=e=>{document.getElementById(`tbody-category-id-${e}`).innerHTML=""},xr=()=>{const e=document.getElementById("pmf-checkbox-filter-inactive"),t=document.getElementById("pmf-checkbox-filter-new"),n=localStorage.getItem("pmfCheckboxFilterInactive"),o=localStorage.getItem("pmfCheckboxFilterNew");e&&null!==n&&(e.checked=JSON.parse(n)),t&&null!==o&&(t.checked=JSON.parse(o)),e&&e.addEventListener("change",()=>{localStorage.setItem("pmfCheckboxFilterInactive",JSON.stringify(e.checked))}),t&&t.addEventListener("change",()=>{localStorage.setItem("pmfCheckboxFilterNew",JSON.stringify(t.checked))})},Br=()=>{const e=localStorage.getItem("pmfCheckboxFilterInactive");return null!==e&&JSON.parse(e)},Ar=()=>{const e=localStorage.getItem("pmfCheckboxFilterNew");return null!==e&&JSON.parse(e)},Mr=()=>{const e=document.querySelectorAll(".pmf-toggle-visibility");e&&e.forEach(e=>{e.addEventListener("click",async t=>{t.preventDefault();const n=e.getAttribute("data-pmf-question-id"),a=e.getAttribute("data-pmf-visibility"),i=e.getAttribute("data-pmf-csrf"),r=await(async(e,t,n)=>{try{const o=await fetch("./api/question/visibility/toggle",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({questionId:e,visibility:t,csrfToken:n})});return await o.json()}catch(o){throw o}})(n,a,i);r.success?e.innerText=r.success:o(r.error),console.log(n,a,i)})})},Or=()=>{const e=document.querySelectorAll(".btn-edit"),t=document.querySelectorAll(".btn-delete"),o=document.getElementById("tag-form"),a=document.querySelector(".pmf-tags-autocomplete");e&&e.forEach(e=>{e.addEventListener("click",e=>{const t=e.target.getAttribute("data-btn-id"),n=document.querySelector(`span[id="tag-id-${t}"]`);if(n)n.replaceWith(l("input",{type:"text",name:"tag",value:n.innerText,classList:"form-control",id:`tag-id-${t}`}));else{const e=document.querySelector(`input[id="tag-id-${t}"]`);e.replaceWith(l("span",{innerHTML:e.value.replace(/\//g,"&#x2F;"),id:`tag-id-${t}`}))}})}),t&&t.forEach(e=>{e.addEventListener("click",async e=>{const t=e.target.getAttribute("data-pmf-id"),o=await(async e=>{try{const t=await fetch(`./api/content/tags/${e}`,{method:"DELETE",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});await t.json()}catch(t){throw t}})(t);if(!o.success)throw new Error("Network response was not ok: "+JSON.stringify(o.error));n(o.success);document.getElementById(`pmf-row-tag-id-${t}`).remove()})}),o&&o.addEventListener("submit",e=>{e.preventDefault();const t=document.querySelector("input:focus"),n=t.getAttribute("id").replace("tag-id-",""),o=t.value,a=document.querySelector("input[name=pmf-csrf-token]").value;fetch("./api/content/tag",{method:"PUT",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:a,id:n,tag:o})}).then(async e=>{if(e.ok)return e.json();throw new Error("Network response was not ok: ",{cause:{response:e}})}).then(()=>{t.replaceWith(l("span",{innerHTML:t.value.replace(/\//g,"&#x2F;"),id:`tag-id-${n}`},[l("span",{classList:"ms-1 badge rounded-pill bg-success",innerHTML:""})]))}).catch(async e=>{const t=await e.cause.response.json();document.querySelector(".table").insertAdjacentElement("beforebegin",l("div",{classList:"alert alert-danger",innerText:t}))})}),a&&i({input:a,minLength:1,onSelect:async(e,t)=>{let n=t.value,o=n.split(",");0===n.length?n=e.tagName:(o[o.length-1]=e.tagName,n=o.join(",")),t.value=n},fetch:async(e,t)=>{let n=e.toLowerCase();t((await(async e=>{try{const t=await fetch(`./api/content/tags?search=${e}`,{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});return await t.json()}catch(t){throw t}})(n)).filter(e=>{const t=n.lastIndexOf(",");return n=n.substring(t+1),-1!==e.tagName.toLowerCase().indexOf(n)}))},render:(e,t)=>l("div",{classList:"pmf-tag-list-result border",innerHTML:e.tagName}),emptyMsg:"No tags found."})},qr=async e=>{const t=document.getElementById("stickyFAQs"),a=document.getElementById("successAlert"),i=t.getAttribute("data-csrf");a&&a.remove();try{const t=await fetch("./api/faqs/sticky/order",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({faqIds:e,csrf:i})});if(!t.ok){const e=await t.json();throw new Error("Network response was not ok: "+JSON.stringify(e))}{const e=await t.json();n(e.success)}}catch(r){r instanceof Error?o(r.message):console.error("Unknown error:",r)}},Dr=async e=>{await Nr(e),await Pr(e)},Nr=async e=>{const t=await(async e=>{try{const t=await fetch(`./api/user/data/${e}`,{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});return await t.json()}catch(t){throw t}})(e);if(Rr("current_user_id",t.userId),Rr("pmf-user-list-autocomplete",t.login),Rr("last_modified",t.lastModified),Rr("update_user_id",t.userId),Rr("modal_user_id",t.userId),Rr("auth_source",d(t.authSource)),Rr("user_status",t.status),Rr("display_name",t.displayName),Rr("email",t.email),Rr("overwrite_twofactor",t.twoFactorEnabled),t.isSuperadmin){document.getElementById("is_superadmin").setAttribute("checked","checked"),document.querySelectorAll(".permission").forEach(e=>{e.removeAttribute("disabled")}),document.querySelectorAll("#pmf-user-rights-save").forEach(e=>{e.removeAttribute("disabled")}),document.getElementById("checkAll").removeAttribute("disabled"),document.getElementById("uncheckAll").setAttribute("disabled","")}else{document.getElementById("is_superadmin").removeAttribute("checked")}if(t.twoFactorEnabled){const e=document.getElementById("overwrite_twofactor");e.setAttribute("checked","checked"),e.removeAttribute("disabled")}if("protected"!==t.status){document.getElementById("pmf-delete-user").classList.remove("disabled")}document.getElementById("pmf-user-save").classList.remove("disabled"),window.history.pushState({},"",`./user/edit/${e}`)},Pr=async e=>{zr();const t=await(async e=>{try{const t=await fetch(`./api/user/permissions/${e}`,{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});return await t.json()}catch(t){throw t}})(e);t.forEach(e=>{document.getElementById(`user_right_${e}`).setAttribute("checked","checked")}),document.getElementById("rights_user_id").value=e},zr=()=>{document.querySelectorAll(".permission").forEach(e=>{e.checked&&e.removeAttribute("checked")})},Rr=(e,t)=>{const n=document.getElementById(e);n&&(n.value=t,n.removeAttribute("disabled"))},Fr=async()=>{const e=document.getElementById("current_user_id");e?.value&&await Dr(e.value);const t=document.getElementById("checkAll"),a=document.getElementById("uncheckAll"),i=document.getElementById("addUserModal"),r=document.getElementsByClassName("modal-backdrop fade show"),s=document.getElementById("pmf-add-user-action"),l=document.getElementById("pmf-add-user-form"),c=document.getElementById("add_user_automatic_password"),d=document.getElementById("add_user_show_password_inputs"),u=document.getElementById("is_superadmin");u&&u.addEventListener("click",()=>{u.checked?(document.querySelectorAll(".permission").forEach(e=>{e.removeAttribute("disabled")}),document.querySelectorAll("#pmf-user-rights-save").forEach(e=>{e.removeAttribute("disabled")}),document.getElementById("checkAll").setAttribute("disabled",""),document.getElementById("uncheckAll").setAttribute("disabled","")):(document.querySelectorAll(".permission").forEach(e=>{e.removeAttribute("disabled")}),document.querySelectorAll("#pmf-user-rights-save").forEach(e=>{e.removeAttribute("disabled")}),document.getElementById("checkAll").removeAttribute("disabled"),document.getElementById("uncheckAll").removeAttribute("disabled"))}),c&&c.addEventListener("click",()=>{d.classList.toggle("d-none")}),t&&a&&(t.addEventListener("click",()=>{document.querySelectorAll(".permission").forEach(e=>{e.checked=!0})}),a.addEventListener("click",()=>{document.querySelectorAll(".permission").forEach(e=>{e.checked=!1})})),s&&s.addEventListener("click",async e=>{e.preventDefault();const t=document.getElementById("add_user_csrf").value,a=document.getElementById("add_user_name").value,s=document.getElementById("add_user_realname").value,c=document.getElementById("add_user_automatic_password")?.checked,d=document.getElementById("add_user_email").value,u=document.getElementById("add_user_password").value,h=document.getElementById("add_user_password_confirm").value,p=document.querySelector("#add_user_is_superadmin");let m=!1;p&&(m=p.checked),l.classList.add("was-validated");const g={csrf:t,userName:a,realName:s,email:d,automaticPassword:c,password:u,passwordConfirm:h,isSuperAdmin:m};try{const e=await lt("./api/user/add",g);"string"==typeof e.success?(i.style.display="none",i.classList.remove("show"),r[0].parentNode?.removeChild(r[0]),n(e.success),setTimeout(()=>{location.reload()},1500)):o(e.error)}catch(f){throw console.error("Error adding user: ",f),f}});const h=document.getElementById("pmf-button-export-users");h&&h.addEventListener("click",e=>{e.preventDefault(),window.location.href="./api/user/users/csv"});const p=document.getElementById("pmf-user-password-overwrite-action"),g=document.getElementById("pmf-modal-user-password-overwrite");if(p){const e=new m(g);p.addEventListener("click",async t=>{t.preventDefault();const a=document.getElementById("modal_csrf").value,i=document.getElementById("modal_user_id").value,r=document.getElementById("npass").value,s=document.getElementById("bpass").value,l=await(async(e,t,n,o)=>{try{const a=await fetch("./api/user/overwrite-password",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:e,userId:t,newPassword:n,passwordRepeat:o})});return await a.json()}catch(a){throw a}})(a,i,r,s);l.success&&(n(l.success),e.hide()),l.error&&o(l.error)})}const f=document.getElementById("pmf-delete-user"),y=document.getElementById("pmf-delete-user-yes");f&&(f.addEventListener("click",e=>{e.preventDefault();new m(document.getElementById("pmf-modal-user-confirm-delete")).show();const t=document.getElementById("pmf-username-delete"),n=document.getElementById("pmf-user-id-delete");t.innerText=document.getElementById("display_name").value,n.value=document.getElementById("current_user_id").value,document.getElementById("source_page").value="users"}),y.addEventListener("click",async e=>{e.preventDefault();if("users"===document.getElementById("source_page").value){const e=document.getElementById("pmf-user-id-delete").value,t=document.getElementById("csrf-token-delete-user").value,a=await ct(e,t);a.success&&(n(a.success),await(async()=>{Rr("current_user_id",""),Rr("pmf-user-list-autocomplete",""),Rr("last_modified",""),Rr("update_user_id",""),Rr("modal_user_id",""),Rr("auth_source",""),Rr("user_status",""),Rr("display_name",""),Rr("email",""),Rr("overwrite_twofactor",""),zr(),document.getElementById("pmf-user-save").classList.add("disabled"),document.getElementById("pmf-delete-user").classList.add("disabled")})()),a.error&&o(a.error)}}));const v=document.getElementById("pmf-user-save");v&&v.addEventListener("click",async e=>{e.preventDefault();const t=document.getElementById("update_user_id").value;let a={csrfToken:document.getElementById("pmf-csrf-token").value,display_name:document.getElementById("display_name").value,email:document.getElementById("email").value,last_modified:document.getElementById("last_modified").value,user_status:document.getElementById("user_status").value,is_superadmin:document.getElementById("is_superadmin").checked,overwrite_twofactor:document.getElementById("overwrite_twofactor").checked,userId:t};const i=await lt("./api/user/edit",a);i.success&&n(i.success),i.error&&o(i.error),await Dr(t)}),document.querySelectorAll("#pmf-user-rights-save").forEach(e=>{e.addEventListener("click",async e=>{e.preventDefault();let t=[];document.querySelectorAll(".permission").forEach(async e=>{e.checked&&t.push(e.value)});const a=document.getElementById("rights_user_id").value;let i={csrfToken:document.getElementById("pmf-csrf-token-rights").value,userId:a,userRights:t};const r=await lt("./api/user/update-rights",i);r.success&&n(r.success),r.error&&o(r.error),await Dr(a)})})};document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("pmf-user-list-autocomplete");e&&i({input:e,minLength:1,onSelect:async(e,t)=>{t.value=e.label,await Dr(e.value)},fetch:async(e,t,n,o)=>{const a=e.toLowerCase();t((await(async e=>{try{const t=await fetch(`./api/user/users?filter=${e}`,{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});return await t.json()}catch(t){throw t}})(a)??[]).filter(e=>e.label.toLowerCase().includes(a)))},render:(e,t)=>{const n=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),o=new RegExp(n,"gi");return l("div",{classList:"pmf-user-list-result border",innerHTML:e.label.replace(o,e=>`<strong>${e}</strong>`)})},emptyMsg:"No users found"})});const Hr=()=>{const e=document.querySelectorAll(".btn-activate-user"),t=document.querySelectorAll(".btn-delete-user");if(e&&e.forEach(e=>{e.addEventListener("click",async e=>{e.preventDefault();const t=e.target,n=t.getAttribute("data-csrf-token"),o=t.getAttribute("data-user-id"),a=await(async(e,t)=>{try{const n=await fetch("./api/user/activate",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrfToken:t,userId:e})});return await n.json()}catch(n){throw n}})(o,n);if("string"==typeof a.success){const e=document.querySelector(`.icon_user_id_${o}`);e.classList.remove("bi-ban"),e.classList.add("bi-check-circle-o");document.getElementById(`btn_activate_user_id_${o}`).remove()}else{document.getElementById("pmf-user-message").insertAdjacentElement("afterend",l("div",{classList:"alert alert-danger",innerText:a.error}))}})}),t){t.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const n=document.getElementById("pmf-modal-user-confirm-delete");if(!n)return void o("Fehler: Lschdialog nicht gefunden.");m.getOrCreateInstance(n).show();document.getElementById("pmf-username-delete").innerText=e.getAttribute("data-username");document.getElementById("pmf-user-id-delete").value=e.getAttribute("data-user-id");document.getElementById("source_page").value="user-list"})});const e=document.getElementById("pmf-delete-user-yes");e&&e.addEventListener("click",async e=>{e.preventDefault();if("user-list"===document.getElementById("source_page").value){const e=document.getElementById("pmf-user-id-delete").value,t=document.getElementById("csrf-token-delete-user").value,a=await ct(e,t);if(a.success){n(a.success);document.getElementById("row_user_id_"+e).remove()}a.error&&o(a.error)}})}},Wr=async()=>{Yr();const e=document.querySelector("#group_list_select");if(!e)return;const t=document.querySelector(".pmf-add-member"),n=document.querySelector(".pmf-remove-member"),o=document.getElementById("select_all_group_user_list"),a=document.getElementById("unselect_all_group_user_list"),i=document.getElementById("select_all_members"),r=document.getElementById("unselect_all_members");(await(async()=>{try{const e=await fetch("./api/group/groups",{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});if(200===e.status)return await e.json();throw new Error("Network response was not ok.")}catch(e){throw e}})()).forEach(t=>{const n=document.createElement("option");n.value=t.group_id,n.textContent=t.name,e.appendChild(n)}),await Ur(),e.addEventListener("change",e=>{Vr(e)}),o.addEventListener("click",()=>{Dt("group_user_list")}),a.addEventListener("click",()=>{Nt("group_user_list")}),t.addEventListener("click",()=>{ts(),Dt("group_member_list")}),n.addEventListener("click",()=>{ns(),Dt("group_member_list")}),i.addEventListener("click",()=>{Dt("group_member_list")}),r.addEventListener("click",()=>{Nt("group_member_list")})},Vr=async e=>{const t=e.target?.value;if(t){Gr(),await $r(t),Jr(),await Xr(t),Zr(),await Kr(),Qr(),await es(t);const e=document.getElementById("saveGroupDetails"),n=document.getElementById("saveMembersList"),o=document.getElementById("saveGroupRights"),a=document.getElementById("deleteGroup"),i=document.getElementById("groupAddMember"),r=document.getElementById("groupRemoveMember");e.disabled=!1,n.disabled=!1,o.disabled=!1,a.disabled=!1,i.disabled=!1,r.disabled=!1,document.querySelectorAll(".permission").forEach(e=>{e.disabled=!1})}},$r=async e=>{const t=await(async e=>{try{const t=await fetch(`./api/group/data/${e}`,{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});if(200===t.status)return await t.json();throw new Error("Network response was not ok.")}catch(t){throw t}})(e);document.getElementById("update_group_id").value=t.group_id,document.getElementById("update_group_name").value=t.name,document.getElementById("update_group_description").value=t.description||"";document.getElementById("update_group_auto_join").checked=1===parseInt(t.auto_join||"0")},Yr=()=>{const e=document.getElementById("group_list_select");e&&(e.textContent="")},Ur=async()=>{Gr(),Jr(),Zr(),await Kr(),Qr()},Gr=()=>{const e=document.getElementById("update_group_auto_join"),t=document.getElementById("update_group_id");t&&(t.value="");const n=document.getElementById("update_group_name");n&&(n.value="");const o=document.getElementById("update_group_description");o&&(o.value=""),e.checked&&(e.checked=!1)},Jr=()=>{const e=document.querySelectorAll("#groupRights input[type=checkbox]");e&&e.forEach(e=>{e.checked=!1})},Xr=async e=>{const t=await(async e=>{try{const t=await fetch(`./api/group/permissions/${e}`,{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});if(200===t.status)return await t.json();throw new Error("Network response was not ok.")}catch(t){throw t}})(e);t&&(document.getElementById("rights_group_id").value=e,t.forEach(e=>{document.getElementById(`group_right_${e}`).checked=!0}))},Zr=()=>{const e=document.querySelectorAll("#group_user_list option");e&&e.forEach(e=>{e.value=""})},Kr=async()=>{const e=document.querySelector("#group_user_list"),t=await(async()=>{try{const e=await fetch("./api/group/users",{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});if(200===e.status)return await e.json();throw new Error("Network response was not ok.")}catch(e){throw e}})();e.textContent="",t.forEach(t=>{const n=document.createElement("option");n.value=t.user_id,n.textContent=t.login,e.appendChild(n)})},Qr=()=>{document.querySelector("#group_member_list").textContent=""},es=async e=>{const t=document.querySelector("#group_member_list"),n=await(async e=>{try{const t=await fetch(`./api/group/members/${e}`,{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});if(200===t.status)return await t.json();throw new Error("Network response was not ok.")}catch(t){throw t}})(e);t.textContent="",n.forEach(e=>{const n=document.createElement("option");n.value=e.user_id,n.textContent=e.login,n.selected=!0,t.appendChild(n)}),document.getElementById("update_member_group_id").value=e},ts=()=>{if(null===document.querySelector("#group_list_select option:checked"))return void alert("Please choose a group.");const e=[...document.getElementById("group_user_list").options].filter(e=>e.selected).map(e=>({value:e.value,login:e.innerText})),t=[...document.getElementById("group_member_list").options].map(e=>({value:e.value,login:e.innerText}));e&&e.forEach(e=>{let n=!1;if(t.forEach(t=>{n=e.value===t.value}),!1===n){const t=document.getElementById("group_member_list"),n=document.createElement("option");n.value=e.value,n.textContent=e.login,n.selected=!0,t.appendChild(n)}})},ns=()=>{const e=[...document.getElementById("group_member_list").options].filter(e=>e.selected).map(e=>e.value);if(0!==e.length)for(const t of[...document.querySelectorAll("#group_member_list option")])e.includes(t.value)&&t.remove();else alert("Please choose a member.")};document.addEventListener("DOMContentLoaded",async()=>{(()=>{const e=top?.document.getElementById("pmf-show-session-warning"),t={attributes:!0};e&&(new MutationObserver(Mt).observe(e,t),qt())})(),u(),h(),(()=>{const e=document.body.querySelector("#sidebarToggle");e&&e.addEventListener("click",e=>{e.preventDefault(),document.body.classList.toggle("pmf-admin-sidenav-toggled"),localStorage.setItem("pmf-admin|sidebar-toggle",document.body.classList.contains("pmf-admin-sidenav-toggled").toString())})})(),await(async()=>{const e=document.getElementById("pmf-chart-visits");if(e){r.register(...s);const t=pt(),n=new r(e,{type:"line",data:{labels:[],datasets:[{data:[],borderWidth:2,borderColor:t.primary,backgroundColor:t.primary,label:" Visitors",pointStyle:"circle",pointRadius:4,pointHoverRadius:8,pointBackgroundColor:t.primary,pointBorderColor:t.primary,fill:!1,cubicInterpolationMode:"monotone",tension:.4}]},options:{responsive:!0,interaction:{intersect:!1},maintainAspectRatio:!1,plugins:{legend:{display:!1,labels:{color:t.bodyColor}},tooltip:{backgroundColor:t.tooltipBg,titleColor:t.bodyColor,bodyColor:t.bodyColor,borderColor:t.gridColor,borderWidth:1}},scales:{x:{display:!0,title:{display:!1,color:t.bodyColor},ticks:{color:t.bodyColor},grid:{color:t.gridColor}},y:{display:!0,title:{display:!0,text:"Visitors",color:t.bodyColor},ticks:{color:t.bodyColor},grid:{color:t.gridColor}}}}}),o=()=>{const e=pt(),t=n.data.datasets[0];t.borderColor=e.primary,t.pointBackgroundColor=e.primary,t.pointBorderColor=e.primary,n.options.plugins=n.options.plugins||{},n.options.plugins.legend={display:!1,labels:{color:e.bodyColor}},n.options.plugins.tooltip={backgroundColor:e.tooltipBg,titleColor:e.bodyColor,bodyColor:e.bodyColor,borderColor:e.gridColor,borderWidth:1},n.options.scales=n.options.scales||{},n.options.scales.x={display:!0,title:{display:!1,color:e.bodyColor},ticks:{color:e.bodyColor},grid:{color:e.gridColor}},n.options.scales.y={display:!0,title:{display:!0,text:"Visitors",color:e.bodyColor},ticks:{color:e.bodyColor},grid:{color:e.gridColor}},n.update("none")};new MutationObserver(e=>{for(const t of e)"attributes"===t.type&&"data-bs-theme"===t.attributeName&&o()}).observe(document.documentElement,{attributes:!0,attributeFilter:["data-bs-theme"]});const a=async()=>{try{const e=await fetch("./api/dashboard/visits",{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});200===e.status&&((await e.json()).forEach(e=>{n.data.labels.push(e.date),n.data.datasets[0].data.push(e.number)}),n.update())}catch(e){console.error("Request failure: ",e)}};await a()}})(),await(async()=>{const e=document.getElementById("pmf-chart-topten");if(e){r.register(...s);const t=pt();let n=[];const o=new r(e,{type:"bar",data:{labels:[],datasets:[{data:[],borderWidth:1,borderColor:"white",backgroundColor:n,label:" Visitors"}]},options:{responsive:!0,interaction:{intersect:!1},plugins:{legend:{display:!1,labels:{color:t.bodyColor}}},maintainAspectRatio:!1,scales:{x:{display:!0,title:{display:!1,color:t.bodyColor},ticks:{display:!1,color:t.bodyColor},grid:{color:t.gridColor}},y:{display:!0,title:{display:!1,color:t.bodyColor},ticks:{color:t.bodyColor},grid:{color:t.gridColor}}}}}),a=()=>{const e=pt();o.options.plugins||(o.options.plugins={}),o.options.plugins.legend={display:!1,labels:{color:e.bodyColor}},o.options.scales.x={display:!0,title:{display:!1,color:e.bodyColor},ticks:{display:!1,color:e.bodyColor},grid:{color:e.gridColor}},o.options.scales.y={display:!0,title:{display:!1,color:e.bodyColor},ticks:{color:e.bodyColor},grid:{color:e.gridColor}},o.update("none")};new MutationObserver(e=>{for(const t of e)"attributes"===t.type&&"data-bs-theme"===t.attributeName&&a()}).observe(document.documentElement,{attributes:!0,attributeFilter:["data-bs-theme"]});const i=()=>"rgb("+Math.floor(255*Math.random())+","+Math.floor(255*Math.random())+","+Math.floor(255*Math.random())+")",l=async()=>{try{const e=await fetch("./api/dashboard/topten",{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});200===e.status&&((await e.json()).forEach(e=>{o.data.labels.push(e.question),o.data.datasets[0].data.push(e.visits),n.push(i())}),o.update())}catch(e){console.error("Request failure: ",e)}};await l()}})(),await(async()=>{const e=document.getElementById("version-loader"),t=document.getElementById("phpmyfaq-latest-version");if(e&&t){e.classList.remove("d-none");try{const n=await fetch("./api/dashboard/versions",{method:"GET",cache:"no-cache",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer"});if(!n.ok)throw new Error("Network response was not ok");{const o=await n.json();e.classList.add("d-none"),o.success&&t.insertAdjacentElement("afterend",l("div",{classList:"alert alert-success",innerText:o.success})),o.warning&&t.insertAdjacentElement("afterend",l("div",{classList:"alert alert-danger",innerText:o.warning})),o.error&&t.insertAdjacentElement("afterend",l("div",{classList:"alert alert-danger",innerText:o.error}))}}catch(n){const o=n.message||"Unknown error";e.classList.add("d-none"),t.insertAdjacentElement("afterend",l("div",{classList:"alert alert-danger",innerText:o}))}}})(),await mt(),await Fr(),Hr(),await Wr(),(()=>{const e=document.getElementById("pmf-category-tree"),t=document.querySelectorAll(ga);for(let i=0;i<t.length;i++)new Go(t[i],{group:"Categories",animation:150,fallbackOnBody:!0,swapThreshold:.65,dataIdAttr:fa,emptyInsertThreshold:10,onStart:()=>{document.querySelectorAll(`${ga}:empty`).forEach(e=>{e.classList.add("sortable-drag-active")})},onEnd:async t=>{document.querySelectorAll(ga).forEach(e=>{e.classList.remove("sortable-drag-active")});const i=t.item.getAttribute("data-pmf-catid"),r=document.querySelector("input[name=pmf-csrf-token]").value,s=a(e),l=await it(s,i,r);l.success?n(l.success):o(l.error)}});const a=e=>Array.from(e.children).map(e=>{const t=e.querySelector(ga);return{id:e.dataset[fa],children:t?a(t):[]}})})(),(()=>{const e=document.getElementById("button-reset-category-image");if(e){const t=document.getElementById("pmf-category-existing-image"),n=document.getElementById("pmf-category-image-upload"),o=document.getElementById("pmf-category-image-label");e.addEventListener("click",()=>{n.value="",t.value="",o.innerHTML=""})}})(),await ya(),(()=>{const e=document.getElementById("editor");if(!e)return;const t=window.matchMedia("(prefers-color-scheme: dark)"),n=ot.make(e,{zIndex:0,readonly:!1,beautifyHTML:!1,sourceEditor:"area",activeButtonsInReadOnly:["source","fullsize","print","about","dots"],toolbarButtonSize:"middle",theme:t.matches?"dark":"default",saveModeInStorage:!1,spellcheck:!0,editorClassName:!1,triggerChangeEvent:!0,width:"auto",height:"auto",minHeight:400,direction:"",language:"auto",debugLanguage:!1,tabIndex:-1,toolbar:!0,enter:"p",defaultMode:ot.MODE_WYSIWYG,useSplitMode:!1,askBeforePasteFromWord:!0,processPasteFromWord:!0,defaultActionOnPasteFromWord:"insert_clear_html",colors:{greyscale:["#000000","#434343","#666666","#999999","#B7B7B7","#CCCCCC","#D9D9D9","#EFEFEF","#F3F3F3","#FFFFFF"],palette:["#980000","#FF0000","#FF9900","#FFFF00","#00F0F0","#00FFFF","#4A86E8","#0000FF","#9900FF","#FF00FF"],full:["#E6B8AF","#F4CCCC","#FCE5CD","#FFF2CC","#D9EAD3","#D0E0E3","#C9DAF8","#CFE2F3","#D9D2E9","#EAD1DC","#DD7E6B","#EA9999","#F9CB9C","#FFE599","#B6D7A8","#A2C4C9","#A4C2F4","#9FC5E8","#B4A7D6","#D5A6BD","#CC4125","#E06666","#F6B26B","#FFD966","#93C47D","#76A5AF","#6D9EEB","#6FA8DC","#8E7CC3","#C27BA0","#A61C00","#CC0000","#E69138","#F1C232","#6AA84F","#45818E","#3C78D8","#3D85C6","#674EA7","#A64D79","#85200C","#990000","#B45F06","#BF9000","#38761D","#134F5C","#1155CC","#0B5394","#351C75","#733554","#5B0F00","#660000","#783F04","#7F6000","#274E13","#0C343D","#1C4587","#073763","#20124D","#4C1130"]},colorPickerDefaultTab:"background",imageDefaultWidth:300,imageProcessor:{replaceDataURIToBlobIdInView:!1},removeButtons:[],disablePlugins:[],extraPlugins:["phpMyFAQ","codeSnippet"],extraButtons:[],buttons:["source","|","bold","strikethrough","underline","italic","|","ul","ol","superscript","subscript","|","outdent","indent","|","font","fontsize","lineHeight","brush","paragraph","left","center","right","justify","|","copy","cut","paste","selectall","|","image","video","table","link","|","undo","redo","|","classSpan","hr","eraser","copyformat","|","symbols","fullsize","preview","print","|","phpMyFAQ","codeSnippet"],events:{},textIcons:!1,uploader:{url:"/admin/api/content/images?csrf="+document.getElementById("pmf-csrf-token").value,format:"json",isSuccess:e=>!e.error,getMessage:e=>e.msg},filebrowser:{ajax:{url:"/admin/api/media-browser",contentType:"application/json; charset=UTF-8"},createNewFolder:!1,deleteFolder:!1,moveFolder:!1,showFoldersPanel:!1,showFileSize:!0,showFileName:!0}}),o=e=>{n.options.theme=e;const t=n.container;t.classList.remove("jodit_theme_default","jodit_theme_dark"),t.classList.add("dark"===e?"jodit_theme_dark":"jodit_theme_default")},i=()=>{o(t.matches?"dark":"default")};"function"==typeof t.addEventListener?t.addEventListener("change",i):"function"==typeof t.addListener&&t.addListener(i);const r=()=>{const e=document.documentElement.getAttribute("data-bs-theme");o("dark"===e?"dark":"default")};new MutationObserver(e=>{for(const t of e)"attributes"===t.type&&"data-bs-theme"===t.attributeName&&r()}).observe(document.documentElement,{attributes:!0,attributeFilter:["data-bs-theme"]}),window.addEventListener("storage",e=>{"pmf-theme"===e.key&&r()}),r(),n.events.on("afterSetValue",()=>{n.container.querySelectorAll("pre code").forEach(e=>{a.highlightElement(e)})}),n.events.on("change",()=>{n.container.querySelectorAll("pre code").forEach(e=>{a.highlightElement(e)})})})(),(()=>{const e=document.querySelectorAll(".pmf-delete-attachment-button"),t=document.getElementById("tags"),o=document.getElementById("keywords");t&&t.addEventListener("focus",()=>hr("tags")),o&&o.addEventListener("focus",()=>hr("keywords")),e&&e.forEach(e=>{e.addEventListener("click",async e=>{e.preventDefault();const t=e.target,o=t.getAttribute("data-pmf-attachment-id"),a=t.getAttribute("data-pmf-csrf-token"),i=await at(o,a);if(i.success){const e=document.getElementById(`attachment-id-${o}`);e.addEventListener("click",()=>e.style.opacity="0"),e.addEventListener("transitionend",()=>e.remove()),n(i.success)}i.error&&n(i.error)})});const a=document.querySelector("#phpmyfaq-categories");a&&(Array.from(a.selectedOptions).map(({value:e})=>e),a.addEventListener("click",e=>{e.preventDefault();const t=Array.from(a.selectedOptions).map(({value:e})=>e);pr(t)}));const i=document.getElementById("question");i&&i.addEventListener("input",gr)})(),Sr(),cn(),(()=>{const e=document.getElementById("filter"),t=document.querySelectorAll("div.mce-file");e&&e.addEventListener("keyup",e=>{const n=e.target.value;t.forEach(e=>{e.textContent&&e.textContent.search(new RegExp(n,"i"))<0?e.style.display="none":e.style.display="block"})}),document.addEventListener("click",e=>{const t=e.target;if(t.matches("div.mce-file")){const e=t.getAttribute("data-src");e&&window.parent.postMessage({mceAction:"phpMyFAQMediaBrowserAction",url:e},"*")}})})(),fr(),(()=>{const e=document.getElementById("question");e&&e.addEventListener("input",()=>{document.getElementById("pmf-admin-question-output").innerText=`: ${e.value}`})})(),yr(),(()=>{const e=document.querySelector('button[type="reset"]');e&&e.addEventListener("click",e=>{e.preventDefault(),document.getElementById("faqEditor").reset();const t=document.getElementById("selectedRevisionId");if(t&&t.options.length>0){const e=t.options[t.options.length-1];t.value=e.value,t.dispatchEvent(new Event("change"))}})})(),await jr(),(()=>{const e=document.getElementById("pmf-button-delete-faq-comments"),t=document.getElementById("pmf-button-delete-news-comments");e&&e.addEventListener("click",()=>{va("faq")}),t&&t.addEventListener("click",()=>{va("news")})})(),(()=>{const e=document.getElementById("pmf-delete-questions");e&&e.addEventListener("click",e=>{e.preventDefault();const t=document.getElementById("returnMessage"),n=document.querySelector("#phpmyfaq-open-questions"),o=new FormData(n);t.innerHTML="",fetch("./api/question/delete",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({data:c(o)})}).then(async e=>{if(e.ok)return e.json();throw new Error("Network response was not ok: ",{cause:{response:e}})}).then(e=>{e.success?(t.append(l("div",{classList:"alert alert-success",innerText:e.success})),document.querySelectorAll("tr td input:checked").forEach(e=>{e.parentNode?.parentNode?.parentNode?.remove()})):t.append(l("div",{classList:"alert alert-danger",innerText:e.error}))}).catch(async e=>{const n=await e.cause.response.json();t.append(l("div",{classList:"alert alert-danger",innerText:n}))})})})(),Mr(),(()=>{const e=document.querySelectorAll(".btn-delete-attachment");e.length>0&&e.forEach(e=>{const t=e.cloneNode(!0);e.replaceWith(t),t.addEventListener("click",async e=>{e.preventDefault();const a=t.getAttribute("data-attachment-id"),i=t.getAttribute("data-csrf");if(a&&i){const e=await at(a,i);if(e.success){n(e.success);const t=document.getElementById(`attachment_${a}`);t.style.opacity="0",t.addEventListener("transitionend",()=>t.remove())}e.error&&o(e.error)}})})})(),dn(),vr(),br(),wr(),Er(),Or(),(()=>{const e=document.getElementById("stickyFAQs");e&&Go.create(e,{animation:100,draggable:".list-group-item",handle:".list-group-item",sort:!0,filter:".sortable-disabled",dataIdAttr:"data-pmf-faqid",onEnd:async e=>{const t=Array.from(e.from.children).map(e=>e.getAttribute("data-pmf-faqid"));await qr(t)}})})(),gt(),(()=>{const e=document.querySelectorAll(".pmf-delete-search-term");e&&e.forEach(e=>{e.addEventListener("click",async e=>{e.preventDefault();const t=e.target,n=t.getAttribute("data-delete-search-term-id"),o=t.getAttribute("data-csrf-token");if(confirm("Are you sure?"))try{const e=await fetch("./api/search/term",{method:"DELETE",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:o,searchTermId:n})});if(!e.ok){const t=await e.json();throw new Error(`Network response was not ok: ${t.error}`)}{const t=await e.json(),n=document.getElementById(`row-search-id-${t.deleted}`);n.addEventListener("click",()=>n.style.opacity="0"),n.addEventListener("transitionend",()=>n.remove())}}catch(a){console.error(a.message)}})})})(),yt(),vt(),ft(),bt(),wt(),(()=>{const e=document.getElementById("pmf-admin-session-day");e&&e.addEventListener("click",async e=>{e.preventDefault();const t=document.getElementById("pmf-admin-form-session"),n=document.getElementById("day").value,o=new Date(1e3*Number(n)).toISOString().split("T")[0];t.action=`./statistics/sessions/${o}`,t.submit()})})(),await(async()=>{const e=[].slice.call(document.querySelectorAll("#configuration-list a")),t=document.getElementById("pmf-configuration-result");if(e.length){let n=!1;e.forEach(e=>{const o=new p(e);e.addEventListener("shown.bs.tab",async e=>{e.preventDefault();const a=e.target.getAttribute("href");switch(await At(a),a){case"#main":await _t();break;case"#layout":await kt();break;case"#records":await It(),await jt(),await Ct();break;case"#search":await xt();break;case"#security":await Lt();break;case"#seo":await Bt();break;case"#upgrade":await Tt();break;case"#mail":await St()}n=!0,o instanceof Element&&o.show(),t.innerHTML=""})}),n||(await At("#main"),await _t())}})(),await Et(),Wt(),(()=>{const e=document.getElementById("pmf-stop-words-language-selector"),t=document.getElementById("pmf-stop-words-add-input");e&&(e.addEventListener("change",async e=>{const n=e.target.value;"none"!==n&&(Ut(),await $t(n),t.removeAttribute("disabled"),Gt())}),t.addEventListener("click",()=>{const t=e.value;Yt([{id:-1,lang:t,stopword:""}])}))})(),an(),await Rt(),await Vt(),await(async()=>{const e=document.getElementById("submitButton");e&&e.addEventListener("click",async e=>{e.preventDefault();const t=document.getElementById("fileInputCSVUpload"),a=document.getElementById("uploadCSVFileForm").getAttribute("data-pmf-csrf"),i=t.files?.[0];if(!i)return void o("No file selected.");const r=new FormData;r.append("file",i),r.append("csrf",a);try{const e=await fetch("./api/faq/import",{method:"POST",body:r});if(e.ok){const o=await e.json();n(o.success),t.value=""}else{if(400!==e.status){const t=await e.json();throw new Error("Network response was not ok: "+JSON.stringify(t))}{const n=await e.json();o(n.error),t.value=""}}}catch(s){!1===s.storedAll?s.messages.forEach(e=>{o(e)}):console.error("An error occurred:",s)}})})(),(()=>{const e=document.getElementById("firstHour"),t=document.getElementById("lastHour"),n=document.getElementById("exportSessions"),a=document.getElementById("csrf");e&&t&&(e.addEventListener("change",()=>{n&&(n.disabled=!(""!==e.value&&""!==t.value))}),t.addEventListener("change",()=>{n&&(n.disabled=!(""!==t.value&&""!==e.value))})),n&&(n.disabled=!0,n.addEventListener("click",async n=>{n.preventDefault();try{const n=await fetch("./api/session/export",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({csrf:a?.value,firstHour:e?.value,lastHour:t?.value})});if(n.ok){const o=await n.blob(),a=URL.createObjectURL(o),i=document.createElement("a");i.href=a,i.download=`sessions_${e?.value}--${t?.value}.csv`,document.body.appendChild(i),i.click(),URL.revokeObjectURL(a)}else{const e=await n.json();o(e.error)}}catch(i){console.error(i.message)}}))})(),Ft(),Ht(),_r(),kr(),Ir(),Array.from(document.querySelectorAll('[data-bs-toggle="tooltip"]')).forEach(e=>{new g(e)})});
//# sourceMappingURL=backend.js.map
