{"version":3,"file":"password-DLlehxvG.js","sources":["../../src/utils/helper.ts","../../src/utils/password.ts"],"sourcesContent":["/**\n * phpMyFAQ utility functions\n *\n * This Source Code Form is subject to the terms of the Mozilla Public License,\n * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n * obtain one at https://mozilla.org/MPL/2.0/.\n *\n * @package   phpMyFAQ\n * @author    Thorsten Rinne <thorsten@phpmyfaq.de>\n * @copyright 2020-2025 phpMyFAQ Team\n * @license   http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n * @link      https://www.phpmyfaq.de\n * @since     2020-12-13\n */\n\n/**\n * Adds a new node after the given reference node.\n * @param referenceNode\n * @param newNode\n */\nexport const insertAfter = (referenceNode: Node, newNode: Node): void => {\n  if (referenceNode.parentNode) {\n    referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n  }\n};\n\n/**\n * Creates a new element with the given tag name.\n * @param HTMLElement\n * @param properties\n * @param children\n * @returns {*}\n */\nexport const addElement = (\n  HTMLElement: string,\n  properties: Record<string, any> = {},\n  children: Node[] = []\n): HTMLElement => {\n  const element = Object.assign(document.createElement(HTMLElement), properties);\n\n  Object.keys(properties).forEach((key: string): void => {\n    if (key.startsWith('data-')) {\n      const dataKey: string = key.replace('data-', '');\n      element.dataset[dataKey] = properties[key];\n    }\n  });\n\n  children.forEach((child: Node): Node => element.appendChild(child));\n  return element;\n};\n\n/**\n * Escapes a given string.\n * @param text\n * @returns {Text}\n */\nexport const escape = (text: string): string => {\n  const map: Record<string, string> = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#039;',\n  };\n\n  return text.replace(/[&<>\"']/g, (mapped: string): string => {\n    return map[mapped as keyof typeof map];\n  });\n};\n\n/**\n * Sort an array containing numbers\n * @param arr\n * @returns {*}\n */\nexport const sort = (arr: number[]): number[] => arr.sort((a, b) => a - b);\n\n/**\n * Converts a FormData object into a plain object\n * @returns {{}}\n * @param formData\n */\nexport function serialize(formData: FormData): Record<string, any> {\n  const obj: Record<string, any> = {};\n  formData.forEach((value, key) => {\n    if (obj[key]) {\n      if (Array.isArray(obj[key])) {\n        obj[key].push(value);\n      } else {\n        obj[key] = [obj[key], value];\n      }\n    } else {\n      obj[key] = value;\n    }\n  });\n  return obj;\n}\n\nexport const capitalize = (string: string): string => {\n  return string.charAt(0).toUpperCase() + string.slice(1);\n};\n","/**\n * Simple Toggle Password Visibility\n *\n * This Source Code Form is subject to the terms of the Mozilla Public License,\n * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n * obtain one at https://mozilla.org/MPL/2.0/.\n *\n * @package   phpMyFAQ\n * @author    Thorsten Rinne <thorsten@phpmyfaq.de>\n * @copyright 2023-2025 phpMyFAQ Team\n * @license   https://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n * @link      https://www.phpmyfaq.de\n * @since     2023-01-26\n */\n\nexport const handlePasswordToggle = (): void => {\n  const passwordInputs: NodeListOf<HTMLInputElement> = document.querySelectorAll('input[type=\"password\"]');\n  passwordInputs.forEach((field: HTMLInputElement) => {\n    const toggleId: string | null = field.getAttribute('data-pmf-toggle');\n    if (toggleId) {\n      const toggle: HTMLElement | null = document.getElementById(toggleId);\n      if (toggle) {\n        toggle.addEventListener('click', () => {\n          const type: string = field.getAttribute('type') === 'password' ? 'text' : 'password';\n          field.setAttribute('type', type);\n          const icon: HTMLElement | null = document.getElementById(toggleId + '_icon');\n          if (icon) {\n            icon.classList.toggle('bi-eye');\n            icon.classList.toggle('bi-eye-slash');\n          }\n        });\n      }\n    }\n  });\n};\n\nexport const handlePasswordStrength = (): void => {\n  const password: HTMLInputElement | null = document.querySelector('#faqpassword');\n  const strength: HTMLElement | null = document.getElementById('strength');\n\n  if (password && strength) {\n    password.addEventListener('keyup', () => {\n      const strengthValue: number = passwordStrength(password.value) * 25;\n      strength.style.width = `${strengthValue}%`;\n      strength.classList.remove('bg-danger', 'bg-warning', 'bg-success');\n\n      if (strengthValue < 75) {\n        strength.classList.add('bg-danger');\n      } else if (strengthValue < 90) {\n        strength.classList.add('bg-warning');\n      } else {\n        strength.classList.add('bg-success');\n      }\n    });\n  }\n};\n\n/**\n * Rules for the password strength calculation:\n * - at least eight characters\n * - bonus if longer\n * - a lower letter\n * - an upper letter\n * - a digit\n * - a special character\n *\n * @param password\n * @returns {number}\n */\nexport const passwordStrength = (password: string): number => {\n  return (\n    +/.{8,}/.test(password) * // at least 8 characters\n    (+/.{12,}/.test(password) + // bonus if longer\n      +/[a-z]/.test(password) + // a lower letter\n      +/[A-Z]/.test(password) + // an upper letter\n      +/\\d/.test(password) + // a digit\n      +/[^A-Za-z0-9]/.test(password)) // a special character\n  );\n};\n"],"names":["insertAfter","referenceNode","newNode","parentNode","insertBefore","nextSibling","addElement","HTMLElement","properties","children","element","Object","assign","document","createElement","keys","forEach","key","startsWith","dataKey","replace","dataset","child","appendChild","serialize","formData","obj","value","Array","isArray","push","capitalize","string","charAt","toUpperCase","slice","handlePasswordToggle","querySelectorAll","field","toggleId","getAttribute","toggle","getElementById","addEventListener","type","setAttribute","icon","classList","handlePasswordStrength","password","querySelector","strength","strengthValue","passwordStrength","style","width","remove","add","test"],"mappings":"AAoBO,MAAMA,EAAc,CAACC,EAAqBC,KAC3CD,EAAcE,YAChBF,EAAcE,WAAWC,aAAaF,EAASD,EAAcI,cAWpDC,EAAa,CACxBC,EACAC,EAAkC,CAAA,EAClCC,EAAmB,MAEnB,MAAMC,EAAUC,OAAOC,OAAOC,SAASC,cAAcP,GAAcC,GAUnE,OARAG,OAAOI,KAAKP,GAAYQ,QAASC,IAC/B,GAAIA,EAAIC,WAAW,SAAU,CAC3B,MAAMC,EAAkBF,EAAIG,QAAQ,QAAS,IAC7CV,EAAQW,QAAQF,GAAWX,EAAWS,EACxC,IAGFR,EAASO,QAASM,GAAsBZ,EAAQa,YAAYD,IACrDZ,GAkCF,SAASc,EAAUC,GACxB,MAAMC,EAA2B,CAAA,EAYjC,OAXAD,EAAST,QAAQ,CAACW,EAAOV,KACnBS,EAAIT,GACFW,MAAMC,QAAQH,EAAIT,IACpBS,EAAIT,GAAKa,KAAKH,GAEdD,EAAIT,GAAO,CAACS,EAAIT,GAAMU,GAGxBD,EAAIT,GAAOU,IAGRD,CACT,CAEO,MAAMK,EAAcC,GAClBA,EAAOC,OAAO,GAAGC,cAAgBF,EAAOG,MAAM,GCpF1CC,EAAuB,KACmBvB,SAASwB,iBAAiB,0BAChErB,QAASsB,IACtB,MAAMC,EAA0BD,EAAME,aAAa,mBACnD,GAAID,EAAU,CACZ,MAAME,EAA6B5B,SAAS6B,eAAeH,GACvDE,GACFA,EAAOE,iBAAiB,QAAS,KAC/B,MAAMC,EAA8C,aAA/BN,EAAME,aAAa,QAAyB,OAAS,WAC1EF,EAAMO,aAAa,OAAQD,GAC3B,MAAME,EAA2BjC,SAAS6B,eAAeH,EAAW,SAChEO,IACFA,EAAKC,UAAUN,OAAO,UACtBK,EAAKC,UAAUN,OAAO,kBAI9B,KAISO,EAAyB,KACpC,MAAMC,EAAoCpC,SAASqC,cAAc,gBAC3DC,EAA+BtC,SAAS6B,eAAe,YAEzDO,GAAYE,GACdF,EAASN,iBAAiB,QAAS,KACjC,MAAMS,EAA2D,GAAnCC,EAAiBJ,EAAStB,OACxDwB,EAASG,MAAMC,MAAQ,GAAGH,KAC1BD,EAASJ,UAAUS,OAAO,YAAa,aAAc,cAEjDJ,EAAgB,GAClBD,EAASJ,UAAUU,IAAI,aACdL,EAAgB,GACzBD,EAASJ,UAAUU,IAAI,cAEvBN,EAASJ,UAAUU,IAAI,iBAkBlBJ,EAAoBJ,IAE5B,QAAQS,KAAKT,KACZ,SAASS,KAAKT,KACb,QAAQS,KAAKT,KACb,QAAQS,KAAKT,KACb,KAAKS,KAAKT,KACV,eAAeS,KAAKT"}